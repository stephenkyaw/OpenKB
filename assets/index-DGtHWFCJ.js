(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function K0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Y0={exports:{}},fu={},X0={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ul=Symbol.for("react.element"),aC=Symbol.for("react.portal"),uC=Symbol.for("react.fragment"),cC=Symbol.for("react.strict_mode"),dC=Symbol.for("react.profiler"),fC=Symbol.for("react.provider"),pC=Symbol.for("react.context"),hC=Symbol.for("react.forward_ref"),mC=Symbol.for("react.suspense"),gC=Symbol.for("react.memo"),yC=Symbol.for("react.lazy"),Ah=Symbol.iterator;function vC(t){return t===null||typeof t!="object"?null:(t=Ah&&t[Ah]||t["@@iterator"],typeof t=="function"?t:null)}var Q0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Z0=Object.assign,ev={};function Ho(t,e,n){this.props=t,this.context=e,this.refs=ev,this.updater=n||Q0}Ho.prototype.isReactComponent={};Ho.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ho.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function tv(){}tv.prototype=Ho.prototype;function Rf(t,e,n){this.props=t,this.context=e,this.refs=ev,this.updater=n||Q0}var Df=Rf.prototype=new tv;Df.constructor=Rf;Z0(Df,Ho.prototype);Df.isPureReactComponent=!0;var Ih=Array.isArray,nv=Object.prototype.hasOwnProperty,Pf={current:null},rv={key:!0,ref:!0,__self:!0,__source:!0};function iv(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)nv.call(e,r)&&!rv.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:ul,type:t,key:o,ref:s,props:i,_owner:Pf.current}}function xC(t,e){return{$$typeof:ul,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Lf(t){return typeof t=="object"&&t!==null&&t.$$typeof===ul}function wC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Mh=/\/+/g;function ec(t,e){return typeof t=="object"&&t!==null&&t.key!=null?wC(""+t.key):e.toString(36)}function ta(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case ul:case aC:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+ec(s,0):r,Ih(i)?(n="",t!=null&&(n=t.replace(Mh,"$&/")+"/"),ta(i,e,n,"",function(u){return u})):i!=null&&(Lf(i)&&(i=xC(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Mh,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Ih(t))for(var l=0;l<t.length;l++){o=t[l];var a=r+ec(o,l);s+=ta(o,e,n,a,i)}else if(a=vC(t),typeof a=="function")for(t=a.call(t),l=0;!(o=t.next()).done;)o=o.value,a=r+ec(o,l++),s+=ta(o,e,n,a,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Tl(t,e,n){if(t==null)return t;var r=[],i=0;return ta(t,r,"","",function(o){return e.call(n,o,i++)}),r}function SC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ct={current:null},na={transition:null},CC={ReactCurrentDispatcher:Ct,ReactCurrentBatchConfig:na,ReactCurrentOwner:Pf};function ov(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:Tl,forEach:function(t,e,n){Tl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Tl(t,function(){e++}),e},toArray:function(t){return Tl(t,function(e){return e})||[]},only:function(t){if(!Lf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};de.Component=Ho;de.Fragment=uC;de.Profiler=dC;de.PureComponent=Rf;de.StrictMode=cC;de.Suspense=mC;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CC;de.act=ov;de.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Z0({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=Pf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)nv.call(e,a)&&!rv.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:ul,type:t.type,key:i,ref:o,props:r,_owner:s}};de.createContext=function(t){return t={$$typeof:pC,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:fC,_context:t},t.Consumer=t};de.createElement=iv;de.createFactory=function(t){var e=iv.bind(null,t);return e.type=t,e};de.createRef=function(){return{current:null}};de.forwardRef=function(t){return{$$typeof:hC,render:t}};de.isValidElement=Lf;de.lazy=function(t){return{$$typeof:yC,_payload:{_status:-1,_result:t},_init:SC}};de.memo=function(t,e){return{$$typeof:gC,type:t,compare:e===void 0?null:e}};de.startTransition=function(t){var e=na.transition;na.transition={};try{t()}finally{na.transition=e}};de.unstable_act=ov;de.useCallback=function(t,e){return Ct.current.useCallback(t,e)};de.useContext=function(t){return Ct.current.useContext(t)};de.useDebugValue=function(){};de.useDeferredValue=function(t){return Ct.current.useDeferredValue(t)};de.useEffect=function(t,e){return Ct.current.useEffect(t,e)};de.useId=function(){return Ct.current.useId()};de.useImperativeHandle=function(t,e,n){return Ct.current.useImperativeHandle(t,e,n)};de.useInsertionEffect=function(t,e){return Ct.current.useInsertionEffect(t,e)};de.useLayoutEffect=function(t,e){return Ct.current.useLayoutEffect(t,e)};de.useMemo=function(t,e){return Ct.current.useMemo(t,e)};de.useReducer=function(t,e,n){return Ct.current.useReducer(t,e,n)};de.useRef=function(t){return Ct.current.useRef(t)};de.useState=function(t){return Ct.current.useState(t)};de.useSyncExternalStore=function(t,e,n){return Ct.current.useSyncExternalStore(t,e,n)};de.useTransition=function(){return Ct.current.useTransition()};de.version="18.3.1";X0.exports=de;var _=X0.exports;const Se=K0(_);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EC=_,TC=Symbol.for("react.element"),NC=Symbol.for("react.fragment"),kC=Object.prototype.hasOwnProperty,AC=EC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,IC={key:!0,ref:!0,__self:!0,__source:!0};function sv(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)kC.call(e,r)&&!IC.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:TC,type:t,key:o,ref:s,props:i,_owner:AC.current}}fu.Fragment=NC;fu.jsx=sv;fu.jsxs=sv;Y0.exports=fu;var h=Y0.exports,rd={},lv={exports:{}},$t={},av={exports:{}},uv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,X){var Z=L.length;L.push(X);e:for(;0<Z;){var oe=Z-1>>>1,te=L[oe];if(0<i(te,X))L[oe]=X,L[Z]=te,Z=oe;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var X=L[0],Z=L.pop();if(Z!==X){L[0]=Z;e:for(var oe=0,te=L.length,he=te>>>1;oe<he;){var ce=2*(oe+1)-1,be=L[ce],Le=ce+1,ot=L[Le];if(0>i(be,Z))Le<te&&0>i(ot,be)?(L[oe]=ot,L[Le]=Z,oe=Le):(L[oe]=be,L[ce]=Z,oe=ce);else if(Le<te&&0>i(ot,Z))L[oe]=ot,L[Le]=Z,oe=Le;else break e}}return X}function i(L,X){var Z=L.sortIndex-X.sortIndex;return Z!==0?Z:L.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var a=[],u=[],c=1,p=null,m=3,g=!1,y=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(L){for(var X=n(u);X!==null;){if(X.callback===null)r(u);else if(X.startTime<=L)r(u),X.sortIndex=X.expirationTime,e(a,X);else break;X=n(u)}}function S(L){if(v=!1,C(L),!y)if(n(a)!==null)y=!0,Y(N);else{var X=n(u);X!==null&&se(S,X.startTime-L)}}function N(L,X){y=!1,v&&(v=!1,x(I),I=-1),g=!0;var Z=m;try{for(C(X),p=n(a);p!==null&&(!(p.expirationTime>X)||L&&!q());){var oe=p.callback;if(typeof oe=="function"){p.callback=null,m=p.priorityLevel;var te=oe(p.expirationTime<=X);X=t.unstable_now(),typeof te=="function"?p.callback=te:p===n(a)&&r(a),C(X)}else r(a);p=n(a)}if(p!==null)var he=!0;else{var ce=n(u);ce!==null&&se(S,ce.startTime-X),he=!1}return he}finally{p=null,m=Z,g=!1}}var T=!1,k=null,I=-1,R=5,M=-1;function q(){return!(t.unstable_now()-M<R)}function $(){if(k!==null){var L=t.unstable_now();M=L;var X=!0;try{X=k(!0,L)}finally{X?F():(T=!1,k=null)}}else T=!1}var F;if(typeof E=="function")F=function(){E($)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,ie=z.port2;z.port1.onmessage=$,F=function(){ie.postMessage(null)}}else F=function(){w($,0)};function Y(L){k=L,T||(T=!0,F())}function se(L,X){I=w(function(){L(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,Y(N))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(L){switch(m){case 1:case 2:case 3:var X=3;break;default:X=m}var Z=m;m=X;try{return L()}finally{m=Z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,X){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var Z=m;m=L;try{return X()}finally{m=Z}},t.unstable_scheduleCallback=function(L,X,Z){var oe=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?oe+Z:oe):Z=oe,L){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=Z+te,L={id:c++,callback:X,priorityLevel:L,startTime:Z,expirationTime:te,sortIndex:-1},Z>oe?(L.sortIndex=Z,e(u,L),n(a)===null&&L===n(u)&&(v?(x(I),I=-1):v=!0,se(S,Z-oe))):(L.sortIndex=te,e(a,L),y||g||(y=!0,Y(N))),L},t.unstable_shouldYield=q,t.unstable_wrapCallback=function(L){var X=m;return function(){var Z=m;m=X;try{return L.apply(this,arguments)}finally{m=Z}}}})(uv);av.exports=uv;var MC=av.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bC=_,zt=MC;function O(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cv=new Set,Ds={};function Ri(t,e){No(t,e),No(t+"Capture",e)}function No(t,e){for(Ds[t]=e,t=0;t<e.length;t++)cv.add(e[t])}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),id=Object.prototype.hasOwnProperty,_C=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bh={},_h={};function RC(t){return id.call(_h,t)?!0:id.call(bh,t)?!1:_C.test(t)?_h[t]=!0:(bh[t]=!0,!1)}function DC(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function PC(t,e,n,r){if(e===null||typeof e>"u"||DC(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Et(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var it={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){it[t]=new Et(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];it[e]=new Et(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){it[t]=new Et(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){it[t]=new Et(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){it[t]=new Et(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){it[t]=new Et(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){it[t]=new Et(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){it[t]=new Et(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){it[t]=new Et(t,5,!1,t.toLowerCase(),null,!1,!1)});var Of=/[\-:]([a-z])/g;function Ff(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Of,Ff);it[e]=new Et(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Of,Ff);it[e]=new Et(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Of,Ff);it[e]=new Et(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){it[t]=new Et(t,1,!1,t.toLowerCase(),null,!1,!1)});it.xlinkHref=new Et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){it[t]=new Et(t,1,!1,t.toLowerCase(),null,!0,!0)});function Vf(t,e,n,r){var i=it.hasOwnProperty(e)?it[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(PC(e,n,i,r)&&(n=null),r||i===null?RC(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var sr=bC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nl=Symbol.for("react.element"),Yi=Symbol.for("react.portal"),Xi=Symbol.for("react.fragment"),Bf=Symbol.for("react.strict_mode"),od=Symbol.for("react.profiler"),dv=Symbol.for("react.provider"),fv=Symbol.for("react.context"),Uf=Symbol.for("react.forward_ref"),sd=Symbol.for("react.suspense"),ld=Symbol.for("react.suspense_list"),zf=Symbol.for("react.memo"),hr=Symbol.for("react.lazy"),pv=Symbol.for("react.offscreen"),Rh=Symbol.iterator;function Ko(t){return t===null||typeof t!="object"?null:(t=Rh&&t[Rh]||t["@@iterator"],typeof t=="function"?t:null)}var Pe=Object.assign,tc;function as(t){if(tc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);tc=e&&e[1]||""}return`
`+tc+t}var nc=!1;function rc(t,e){if(!t||nc)return"";nc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,l=o.length-1;1<=s&&0<=l&&i[s]!==o[l];)l--;for(;1<=s&&0<=l;s--,l--)if(i[s]!==o[l]){if(s!==1||l!==1)do if(s--,l--,0>l||i[s]!==o[l]){var a=`
`+i[s].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=s&&0<=l);break}}}finally{nc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?as(t):""}function LC(t){switch(t.tag){case 5:return as(t.type);case 16:return as("Lazy");case 13:return as("Suspense");case 19:return as("SuspenseList");case 0:case 2:case 15:return t=rc(t.type,!1),t;case 11:return t=rc(t.type.render,!1),t;case 1:return t=rc(t.type,!0),t;default:return""}}function ad(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xi:return"Fragment";case Yi:return"Portal";case od:return"Profiler";case Bf:return"StrictMode";case sd:return"Suspense";case ld:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case fv:return(t.displayName||"Context")+".Consumer";case dv:return(t._context.displayName||"Context")+".Provider";case Uf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case zf:return e=t.displayName||null,e!==null?e:ad(t.type)||"Memo";case hr:e=t._payload,t=t._init;try{return ad(t(e))}catch{}}return null}function OC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ad(e);case 8:return e===Bf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ur(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function hv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function FC(t){var e=hv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function kl(t){t._valueTracker||(t._valueTracker=FC(t))}function mv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=hv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function wa(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ud(t,e){var n=e.checked;return Pe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Dh(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ur(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function gv(t,e){e=e.checked,e!=null&&Vf(t,"checked",e,!1)}function cd(t,e){gv(t,e);var n=Ur(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?dd(t,e.type,n):e.hasOwnProperty("defaultValue")&&dd(t,e.type,Ur(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ph(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function dd(t,e,n){(e!=="number"||wa(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var us=Array.isArray;function fo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ur(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function fd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(O(91));return Pe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Lh(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(O(92));if(us(n)){if(1<n.length)throw Error(O(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ur(n)}}function yv(t,e){var n=Ur(e.value),r=Ur(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Oh(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function vv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?vv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Al,xv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Al=Al||document.createElement("div"),Al.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Al.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ps(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ms={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},VC=["Webkit","ms","Moz","O"];Object.keys(ms).forEach(function(t){VC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ms[e]=ms[t]})});function wv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ms.hasOwnProperty(t)&&ms[t]?(""+e).trim():e+"px"}function Sv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=wv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var BC=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hd(t,e){if(e){if(BC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(O(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(O(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(O(61))}if(e.style!=null&&typeof e.style!="object")throw Error(O(62))}}function md(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gd=null;function Hf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var yd=null,po=null,ho=null;function Fh(t){if(t=fl(t)){if(typeof yd!="function")throw Error(O(280));var e=t.stateNode;e&&(e=yu(e),yd(t.stateNode,t.type,e))}}function Cv(t){po?ho?ho.push(t):ho=[t]:po=t}function Ev(){if(po){var t=po,e=ho;if(ho=po=null,Fh(t),e)for(t=0;t<e.length;t++)Fh(e[t])}}function Tv(t,e){return t(e)}function Nv(){}var ic=!1;function kv(t,e,n){if(ic)return t(e,n);ic=!0;try{return Tv(t,e,n)}finally{ic=!1,(po!==null||ho!==null)&&(Nv(),Ev())}}function Ls(t,e){var n=t.stateNode;if(n===null)return null;var r=yu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(O(231,e,typeof n));return n}var vd=!1;if(Xn)try{var Yo={};Object.defineProperty(Yo,"passive",{get:function(){vd=!0}}),window.addEventListener("test",Yo,Yo),window.removeEventListener("test",Yo,Yo)}catch{vd=!1}function UC(t,e,n,r,i,o,s,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var gs=!1,Sa=null,Ca=!1,xd=null,zC={onError:function(t){gs=!0,Sa=t}};function HC(t,e,n,r,i,o,s,l,a){gs=!1,Sa=null,UC.apply(zC,arguments)}function $C(t,e,n,r,i,o,s,l,a){if(HC.apply(this,arguments),gs){if(gs){var u=Sa;gs=!1,Sa=null}else throw Error(O(198));Ca||(Ca=!0,xd=u)}}function Di(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Av(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Vh(t){if(Di(t)!==t)throw Error(O(188))}function GC(t){var e=t.alternate;if(!e){if(e=Di(t),e===null)throw Error(O(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Vh(i),t;if(o===r)return Vh(i),e;o=o.sibling}throw Error(O(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(O(189))}}if(n.alternate!==r)throw Error(O(190))}if(n.tag!==3)throw Error(O(188));return n.stateNode.current===n?t:e}function Iv(t){return t=GC(t),t!==null?Mv(t):null}function Mv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Mv(t);if(e!==null)return e;t=t.sibling}return null}var bv=zt.unstable_scheduleCallback,Bh=zt.unstable_cancelCallback,qC=zt.unstable_shouldYield,WC=zt.unstable_requestPaint,Be=zt.unstable_now,jC=zt.unstable_getCurrentPriorityLevel,$f=zt.unstable_ImmediatePriority,_v=zt.unstable_UserBlockingPriority,Ea=zt.unstable_NormalPriority,JC=zt.unstable_LowPriority,Rv=zt.unstable_IdlePriority,pu=null,Dn=null;function KC(t){if(Dn&&typeof Dn.onCommitFiberRoot=="function")try{Dn.onCommitFiberRoot(pu,t,void 0,(t.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:QC,YC=Math.log,XC=Math.LN2;function QC(t){return t>>>=0,t===0?32:31-(YC(t)/XC|0)|0}var Il=64,Ml=4194304;function cs(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ta(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var l=s&~i;l!==0?r=cs(l):(o&=s,o!==0&&(r=cs(o)))}else s=n&~i,s!==0?r=cs(s):o!==0&&(r=cs(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-wn(e),i=1<<n,r|=t[n],e&=~i;return r}function ZC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eE(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-wn(o),l=1<<s,a=i[s];a===-1?(!(l&n)||l&r)&&(i[s]=ZC(l,e)):a<=e&&(t.expiredLanes|=l),o&=~l}}function wd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dv(){var t=Il;return Il<<=1,!(Il&4194240)&&(Il=64),t}function oc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function cl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-wn(e),t[e]=n}function tE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-wn(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function Gf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-wn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ee=0;function Pv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Lv,qf,Ov,Fv,Vv,Sd=!1,bl=[],Ar=null,Ir=null,Mr=null,Os=new Map,Fs=new Map,vr=[],nE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uh(t,e){switch(t){case"focusin":case"focusout":Ar=null;break;case"dragenter":case"dragleave":Ir=null;break;case"mouseover":case"mouseout":Mr=null;break;case"pointerover":case"pointerout":Os.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fs.delete(e.pointerId)}}function Xo(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=fl(e),e!==null&&qf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function rE(t,e,n,r,i){switch(e){case"focusin":return Ar=Xo(Ar,t,e,n,r,i),!0;case"dragenter":return Ir=Xo(Ir,t,e,n,r,i),!0;case"mouseover":return Mr=Xo(Mr,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Os.set(o,Xo(Os.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Fs.set(o,Xo(Fs.get(o)||null,t,e,n,r,i)),!0}return!1}function Bv(t){var e=li(t.target);if(e!==null){var n=Di(e);if(n!==null){if(e=n.tag,e===13){if(e=Av(n),e!==null){t.blockedOn=e,Vv(t.priority,function(){Ov(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ra(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Cd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);gd=r,n.target.dispatchEvent(r),gd=null}else return e=fl(n),e!==null&&qf(e),t.blockedOn=n,!1;e.shift()}return!0}function zh(t,e,n){ra(t)&&n.delete(e)}function iE(){Sd=!1,Ar!==null&&ra(Ar)&&(Ar=null),Ir!==null&&ra(Ir)&&(Ir=null),Mr!==null&&ra(Mr)&&(Mr=null),Os.forEach(zh),Fs.forEach(zh)}function Qo(t,e){t.blockedOn===e&&(t.blockedOn=null,Sd||(Sd=!0,zt.unstable_scheduleCallback(zt.unstable_NormalPriority,iE)))}function Vs(t){function e(i){return Qo(i,t)}if(0<bl.length){Qo(bl[0],t);for(var n=1;n<bl.length;n++){var r=bl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ar!==null&&Qo(Ar,t),Ir!==null&&Qo(Ir,t),Mr!==null&&Qo(Mr,t),Os.forEach(e),Fs.forEach(e),n=0;n<vr.length;n++)r=vr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<vr.length&&(n=vr[0],n.blockedOn===null);)Bv(n),n.blockedOn===null&&vr.shift()}var mo=sr.ReactCurrentBatchConfig,Na=!0;function oE(t,e,n,r){var i=Ee,o=mo.transition;mo.transition=null;try{Ee=1,Wf(t,e,n,r)}finally{Ee=i,mo.transition=o}}function sE(t,e,n,r){var i=Ee,o=mo.transition;mo.transition=null;try{Ee=4,Wf(t,e,n,r)}finally{Ee=i,mo.transition=o}}function Wf(t,e,n,r){if(Na){var i=Cd(t,e,n,r);if(i===null)mc(t,e,r,ka,n),Uh(t,r);else if(rE(i,t,e,n,r))r.stopPropagation();else if(Uh(t,r),e&4&&-1<nE.indexOf(t)){for(;i!==null;){var o=fl(i);if(o!==null&&Lv(o),o=Cd(t,e,n,r),o===null&&mc(t,e,r,ka,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else mc(t,e,r,null,n)}}var ka=null;function Cd(t,e,n,r){if(ka=null,t=Hf(r),t=li(t),t!==null)if(e=Di(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Av(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ka=t,null}function Uv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jC()){case $f:return 1;case _v:return 4;case Ea:case JC:return 16;case Rv:return 536870912;default:return 16}default:return 16}}var Sr=null,jf=null,ia=null;function zv(){if(ia)return ia;var t,e=jf,n=e.length,r,i="value"in Sr?Sr.value:Sr.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return ia=i.slice(t,1<r?1-r:void 0)}function oa(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function _l(){return!0}function Hh(){return!1}function Gt(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?_l:Hh,this.isPropagationStopped=Hh,this}return Pe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_l)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_l)},persist:function(){},isPersistent:_l}),e}var $o={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jf=Gt($o),dl=Pe({},$o,{view:0,detail:0}),lE=Gt(dl),sc,lc,Zo,hu=Pe({},dl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Zo&&(Zo&&t.type==="mousemove"?(sc=t.screenX-Zo.screenX,lc=t.screenY-Zo.screenY):lc=sc=0,Zo=t),sc)},movementY:function(t){return"movementY"in t?t.movementY:lc}}),$h=Gt(hu),aE=Pe({},hu,{dataTransfer:0}),uE=Gt(aE),cE=Pe({},dl,{relatedTarget:0}),ac=Gt(cE),dE=Pe({},$o,{animationName:0,elapsedTime:0,pseudoElement:0}),fE=Gt(dE),pE=Pe({},$o,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),hE=Gt(pE),mE=Pe({},$o,{data:0}),Gh=Gt(mE),gE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=vE[t])?!!e[t]:!1}function Kf(){return xE}var wE=Pe({},dl,{key:function(t){if(t.key){var e=gE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=oa(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?yE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kf,charCode:function(t){return t.type==="keypress"?oa(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?oa(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),SE=Gt(wE),CE=Pe({},hu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qh=Gt(CE),EE=Pe({},dl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kf}),TE=Gt(EE),NE=Pe({},$o,{propertyName:0,elapsedTime:0,pseudoElement:0}),kE=Gt(NE),AE=Pe({},hu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),IE=Gt(AE),ME=[9,13,27,32],Yf=Xn&&"CompositionEvent"in window,ys=null;Xn&&"documentMode"in document&&(ys=document.documentMode);var bE=Xn&&"TextEvent"in window&&!ys,Hv=Xn&&(!Yf||ys&&8<ys&&11>=ys),Wh=" ",jh=!1;function $v(t,e){switch(t){case"keyup":return ME.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qi=!1;function _E(t,e){switch(t){case"compositionend":return Gv(e);case"keypress":return e.which!==32?null:(jh=!0,Wh);case"textInput":return t=e.data,t===Wh&&jh?null:t;default:return null}}function RE(t,e){if(Qi)return t==="compositionend"||!Yf&&$v(t,e)?(t=zv(),ia=jf=Sr=null,Qi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Hv&&e.locale!=="ko"?null:e.data;default:return null}}var DE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!DE[t.type]:e==="textarea"}function qv(t,e,n,r){Cv(r),e=Aa(e,"onChange"),0<e.length&&(n=new Jf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var vs=null,Bs=null;function PE(t){nx(t,0)}function mu(t){var e=to(t);if(mv(e))return t}function LE(t,e){if(t==="change")return e}var Wv=!1;if(Xn){var uc;if(Xn){var cc="oninput"in document;if(!cc){var Kh=document.createElement("div");Kh.setAttribute("oninput","return;"),cc=typeof Kh.oninput=="function"}uc=cc}else uc=!1;Wv=uc&&(!document.documentMode||9<document.documentMode)}function Yh(){vs&&(vs.detachEvent("onpropertychange",jv),Bs=vs=null)}function jv(t){if(t.propertyName==="value"&&mu(Bs)){var e=[];qv(e,Bs,t,Hf(t)),kv(PE,e)}}function OE(t,e,n){t==="focusin"?(Yh(),vs=e,Bs=n,vs.attachEvent("onpropertychange",jv)):t==="focusout"&&Yh()}function FE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mu(Bs)}function VE(t,e){if(t==="click")return mu(e)}function BE(t,e){if(t==="input"||t==="change")return mu(e)}function UE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var En=typeof Object.is=="function"?Object.is:UE;function Us(t,e){if(En(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!id.call(e,i)||!En(t[i],e[i]))return!1}return!0}function Xh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Qh(t,e){var n=Xh(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Xh(n)}}function Jv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Jv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Kv(){for(var t=window,e=wa();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=wa(t.document)}return e}function Xf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function zE(t){var e=Kv(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Jv(n.ownerDocument.documentElement,n)){if(r!==null&&Xf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=Qh(n,o);var s=Qh(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var HE=Xn&&"documentMode"in document&&11>=document.documentMode,Zi=null,Ed=null,xs=null,Td=!1;function Zh(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Td||Zi==null||Zi!==wa(r)||(r=Zi,"selectionStart"in r&&Xf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),xs&&Us(xs,r)||(xs=r,r=Aa(Ed,"onSelect"),0<r.length&&(e=new Jf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Zi)))}function Rl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var eo={animationend:Rl("Animation","AnimationEnd"),animationiteration:Rl("Animation","AnimationIteration"),animationstart:Rl("Animation","AnimationStart"),transitionend:Rl("Transition","TransitionEnd")},dc={},Yv={};Xn&&(Yv=document.createElement("div").style,"AnimationEvent"in window||(delete eo.animationend.animation,delete eo.animationiteration.animation,delete eo.animationstart.animation),"TransitionEvent"in window||delete eo.transitionend.transition);function gu(t){if(dc[t])return dc[t];if(!eo[t])return t;var e=eo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Yv)return dc[t]=e[n];return t}var Xv=gu("animationend"),Qv=gu("animationiteration"),Zv=gu("animationstart"),ex=gu("transitionend"),tx=new Map,em="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gr(t,e){tx.set(t,e),Ri(e,[t])}for(var fc=0;fc<em.length;fc++){var pc=em[fc],$E=pc.toLowerCase(),GE=pc[0].toUpperCase()+pc.slice(1);Gr($E,"on"+GE)}Gr(Xv,"onAnimationEnd");Gr(Qv,"onAnimationIteration");Gr(Zv,"onAnimationStart");Gr("dblclick","onDoubleClick");Gr("focusin","onFocus");Gr("focusout","onBlur");Gr(ex,"onTransitionEnd");No("onMouseEnter",["mouseout","mouseover"]);No("onMouseLeave",["mouseout","mouseover"]);No("onPointerEnter",["pointerout","pointerover"]);No("onPointerLeave",["pointerout","pointerover"]);Ri("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ri("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ri("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ri("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ri("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ri("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ds="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qE=new Set("cancel close invalid load scroll toggle".split(" ").concat(ds));function tm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,$C(r,e,void 0,t),t.currentTarget=null}function nx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var l=r[s],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==o&&i.isPropagationStopped())break e;tm(i,l,u),o=a}else for(s=0;s<r.length;s++){if(l=r[s],a=l.instance,u=l.currentTarget,l=l.listener,a!==o&&i.isPropagationStopped())break e;tm(i,l,u),o=a}}}if(Ca)throw t=xd,Ca=!1,xd=null,t}function Ae(t,e){var n=e[Md];n===void 0&&(n=e[Md]=new Set);var r=t+"__bubble";n.has(r)||(rx(e,t,2,!1),n.add(r))}function hc(t,e,n){var r=0;e&&(r|=4),rx(n,t,r,e)}var Dl="_reactListening"+Math.random().toString(36).slice(2);function zs(t){if(!t[Dl]){t[Dl]=!0,cv.forEach(function(n){n!=="selectionchange"&&(qE.has(n)||hc(n,!1,t),hc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Dl]||(e[Dl]=!0,hc("selectionchange",!1,e))}}function rx(t,e,n,r){switch(Uv(e)){case 1:var i=oE;break;case 4:i=sE;break;default:i=Wf}n=i.bind(null,e,n,t),i=void 0,!vd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function mc(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var a=s.tag;if((a===3||a===4)&&(a=s.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;s=s.return}for(;l!==null;){if(s=li(l),s===null)return;if(a=s.tag,a===5||a===6){r=o=s;continue e}l=l.parentNode}}r=r.return}kv(function(){var u=o,c=Hf(n),p=[];e:{var m=tx.get(t);if(m!==void 0){var g=Jf,y=t;switch(t){case"keypress":if(oa(n)===0)break e;case"keydown":case"keyup":g=SE;break;case"focusin":y="focus",g=ac;break;case"focusout":y="blur",g=ac;break;case"beforeblur":case"afterblur":g=ac;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=$h;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=uE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=TE;break;case Xv:case Qv:case Zv:g=fE;break;case ex:g=kE;break;case"scroll":g=lE;break;case"wheel":g=IE;break;case"copy":case"cut":case"paste":g=hE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=qh}var v=(e&4)!==0,w=!v&&t==="scroll",x=v?m!==null?m+"Capture":null:m;v=[];for(var E=u,C;E!==null;){C=E;var S=C.stateNode;if(C.tag===5&&S!==null&&(C=S,x!==null&&(S=Ls(E,x),S!=null&&v.push(Hs(E,S,C)))),w)break;E=E.return}0<v.length&&(m=new g(m,y,null,n,c),p.push({event:m,listeners:v}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",m&&n!==gd&&(y=n.relatedTarget||n.fromElement)&&(li(y)||y[Qn]))break e;if((g||m)&&(m=c.window===c?c:(m=c.ownerDocument)?m.defaultView||m.parentWindow:window,g?(y=n.relatedTarget||n.toElement,g=u,y=y?li(y):null,y!==null&&(w=Di(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=u),g!==y)){if(v=$h,S="onMouseLeave",x="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(v=qh,S="onPointerLeave",x="onPointerEnter",E="pointer"),w=g==null?m:to(g),C=y==null?m:to(y),m=new v(S,E+"leave",g,n,c),m.target=w,m.relatedTarget=C,S=null,li(c)===u&&(v=new v(x,E+"enter",y,n,c),v.target=C,v.relatedTarget=w,S=v),w=S,g&&y)t:{for(v=g,x=y,E=0,C=v;C;C=Gi(C))E++;for(C=0,S=x;S;S=Gi(S))C++;for(;0<E-C;)v=Gi(v),E--;for(;0<C-E;)x=Gi(x),C--;for(;E--;){if(v===x||x!==null&&v===x.alternate)break t;v=Gi(v),x=Gi(x)}v=null}else v=null;g!==null&&nm(p,m,g,v,!1),y!==null&&w!==null&&nm(p,w,y,v,!0)}}e:{if(m=u?to(u):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var N=LE;else if(Jh(m))if(Wv)N=BE;else{N=FE;var T=OE}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(N=VE);if(N&&(N=N(t,u))){qv(p,N,n,c);break e}T&&T(t,m,u),t==="focusout"&&(T=m._wrapperState)&&T.controlled&&m.type==="number"&&dd(m,"number",m.value)}switch(T=u?to(u):window,t){case"focusin":(Jh(T)||T.contentEditable==="true")&&(Zi=T,Ed=u,xs=null);break;case"focusout":xs=Ed=Zi=null;break;case"mousedown":Td=!0;break;case"contextmenu":case"mouseup":case"dragend":Td=!1,Zh(p,n,c);break;case"selectionchange":if(HE)break;case"keydown":case"keyup":Zh(p,n,c)}var k;if(Yf)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Qi?$v(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(Hv&&n.locale!=="ko"&&(Qi||I!=="onCompositionStart"?I==="onCompositionEnd"&&Qi&&(k=zv()):(Sr=c,jf="value"in Sr?Sr.value:Sr.textContent,Qi=!0)),T=Aa(u,I),0<T.length&&(I=new Gh(I,t,null,n,c),p.push({event:I,listeners:T}),k?I.data=k:(k=Gv(n),k!==null&&(I.data=k)))),(k=bE?_E(t,n):RE(t,n))&&(u=Aa(u,"onBeforeInput"),0<u.length&&(c=new Gh("onBeforeInput","beforeinput",null,n,c),p.push({event:c,listeners:u}),c.data=k))}nx(p,e)})}function Hs(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Aa(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Ls(t,n),o!=null&&r.unshift(Hs(t,o,i)),o=Ls(t,e),o!=null&&r.push(Hs(t,o,i))),t=t.return}return r}function Gi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function nm(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var l=n,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=Ls(n,o),a!=null&&s.unshift(Hs(n,a,l))):i||(a=Ls(n,o),a!=null&&s.push(Hs(n,a,l)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var WE=/\r\n?/g,jE=/\u0000|\uFFFD/g;function rm(t){return(typeof t=="string"?t:""+t).replace(WE,`
`).replace(jE,"")}function Pl(t,e,n){if(e=rm(e),rm(t)!==e&&n)throw Error(O(425))}function Ia(){}var Nd=null,kd=null;function Ad(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Id=typeof setTimeout=="function"?setTimeout:void 0,JE=typeof clearTimeout=="function"?clearTimeout:void 0,im=typeof Promise=="function"?Promise:void 0,KE=typeof queueMicrotask=="function"?queueMicrotask:typeof im<"u"?function(t){return im.resolve(null).then(t).catch(YE)}:Id;function YE(t){setTimeout(function(){throw t})}function gc(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Vs(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Vs(e)}function br(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function om(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Go=Math.random().toString(36).slice(2),_n="__reactFiber$"+Go,$s="__reactProps$"+Go,Qn="__reactContainer$"+Go,Md="__reactEvents$"+Go,XE="__reactListeners$"+Go,QE="__reactHandles$"+Go;function li(t){var e=t[_n];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qn]||n[_n]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=om(t);t!==null;){if(n=t[_n])return n;t=om(t)}return e}t=n,n=t.parentNode}return null}function fl(t){return t=t[_n]||t[Qn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function to(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(O(33))}function yu(t){return t[$s]||null}var bd=[],no=-1;function qr(t){return{current:t}}function Me(t){0>no||(t.current=bd[no],bd[no]=null,no--)}function ke(t,e){no++,bd[no]=t.current,t.current=e}var zr={},ft=qr(zr),It=qr(!1),wi=zr;function ko(t,e){var n=t.type.contextTypes;if(!n)return zr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Mt(t){return t=t.childContextTypes,t!=null}function Ma(){Me(It),Me(ft)}function sm(t,e,n){if(ft.current!==zr)throw Error(O(168));ke(ft,e),ke(It,n)}function ix(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(O(108,OC(t)||"Unknown",i));return Pe({},n,r)}function ba(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||zr,wi=ft.current,ke(ft,t),ke(It,It.current),!0}function lm(t,e,n){var r=t.stateNode;if(!r)throw Error(O(169));n?(t=ix(t,e,wi),r.__reactInternalMemoizedMergedChildContext=t,Me(It),Me(ft),ke(ft,t)):Me(It),ke(It,n)}var $n=null,vu=!1,yc=!1;function ox(t){$n===null?$n=[t]:$n.push(t)}function ZE(t){vu=!0,ox(t)}function Wr(){if(!yc&&$n!==null){yc=!0;var t=0,e=Ee;try{var n=$n;for(Ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}$n=null,vu=!1}catch(i){throw $n!==null&&($n=$n.slice(t+1)),bv($f,Wr),i}finally{Ee=e,yc=!1}}return null}var ro=[],io=0,_a=null,Ra=0,Yt=[],Xt=0,Si=null,Gn=1,qn="";function ni(t,e){ro[io++]=Ra,ro[io++]=_a,_a=t,Ra=e}function sx(t,e,n){Yt[Xt++]=Gn,Yt[Xt++]=qn,Yt[Xt++]=Si,Si=t;var r=Gn;t=qn;var i=32-wn(r)-1;r&=~(1<<i),n+=1;var o=32-wn(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Gn=1<<32-wn(e)+i|n<<i|r,qn=o+t}else Gn=1<<o|n<<i|r,qn=t}function Qf(t){t.return!==null&&(ni(t,1),sx(t,1,0))}function Zf(t){for(;t===_a;)_a=ro[--io],ro[io]=null,Ra=ro[--io],ro[io]=null;for(;t===Si;)Si=Yt[--Xt],Yt[Xt]=null,qn=Yt[--Xt],Yt[Xt]=null,Gn=Yt[--Xt],Yt[Xt]=null}var Bt=null,Vt=null,_e=!1,yn=null;function lx(t,e){var n=en(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function am(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Bt=t,Vt=br(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Bt=t,Vt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Si!==null?{id:Gn,overflow:qn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=en(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Bt=t,Vt=null,!0):!1;default:return!1}}function _d(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Rd(t){if(_e){var e=Vt;if(e){var n=e;if(!am(t,e)){if(_d(t))throw Error(O(418));e=br(n.nextSibling);var r=Bt;e&&am(t,e)?lx(r,n):(t.flags=t.flags&-4097|2,_e=!1,Bt=t)}}else{if(_d(t))throw Error(O(418));t.flags=t.flags&-4097|2,_e=!1,Bt=t}}}function um(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Bt=t}function Ll(t){if(t!==Bt)return!1;if(!_e)return um(t),_e=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ad(t.type,t.memoizedProps)),e&&(e=Vt)){if(_d(t))throw ax(),Error(O(418));for(;e;)lx(t,e),e=br(e.nextSibling)}if(um(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(O(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Vt=br(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Vt=null}}else Vt=Bt?br(t.stateNode.nextSibling):null;return!0}function ax(){for(var t=Vt;t;)t=br(t.nextSibling)}function Ao(){Vt=Bt=null,_e=!1}function ep(t){yn===null?yn=[t]:yn.push(t)}var eT=sr.ReactCurrentBatchConfig;function es(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(O(309));var r=n.stateNode}if(!r)throw Error(O(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var l=i.refs;s===null?delete l[o]:l[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(O(284));if(!n._owner)throw Error(O(290,t))}return t}function Ol(t,e){throw t=Object.prototype.toString.call(e),Error(O(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function cm(t){var e=t._init;return e(t._payload)}function ux(t){function e(x,E){if(t){var C=x.deletions;C===null?(x.deletions=[E],x.flags|=16):C.push(E)}}function n(x,E){if(!t)return null;for(;E!==null;)e(x,E),E=E.sibling;return null}function r(x,E){for(x=new Map;E!==null;)E.key!==null?x.set(E.key,E):x.set(E.index,E),E=E.sibling;return x}function i(x,E){return x=Pr(x,E),x.index=0,x.sibling=null,x}function o(x,E,C){return x.index=C,t?(C=x.alternate,C!==null?(C=C.index,C<E?(x.flags|=2,E):C):(x.flags|=2,E)):(x.flags|=1048576,E)}function s(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,E,C,S){return E===null||E.tag!==6?(E=Tc(C,x.mode,S),E.return=x,E):(E=i(E,C),E.return=x,E)}function a(x,E,C,S){var N=C.type;return N===Xi?c(x,E,C.props.children,S,C.key):E!==null&&(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===hr&&cm(N)===E.type)?(S=i(E,C.props),S.ref=es(x,E,C),S.return=x,S):(S=fa(C.type,C.key,C.props,null,x.mode,S),S.ref=es(x,E,C),S.return=x,S)}function u(x,E,C,S){return E===null||E.tag!==4||E.stateNode.containerInfo!==C.containerInfo||E.stateNode.implementation!==C.implementation?(E=Nc(C,x.mode,S),E.return=x,E):(E=i(E,C.children||[]),E.return=x,E)}function c(x,E,C,S,N){return E===null||E.tag!==7?(E=pi(C,x.mode,S,N),E.return=x,E):(E=i(E,C),E.return=x,E)}function p(x,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Tc(""+E,x.mode,C),E.return=x,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Nl:return C=fa(E.type,E.key,E.props,null,x.mode,C),C.ref=es(x,null,E),C.return=x,C;case Yi:return E=Nc(E,x.mode,C),E.return=x,E;case hr:var S=E._init;return p(x,S(E._payload),C)}if(us(E)||Ko(E))return E=pi(E,x.mode,C,null),E.return=x,E;Ol(x,E)}return null}function m(x,E,C,S){var N=E!==null?E.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return N!==null?null:l(x,E,""+C,S);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Nl:return C.key===N?a(x,E,C,S):null;case Yi:return C.key===N?u(x,E,C,S):null;case hr:return N=C._init,m(x,E,N(C._payload),S)}if(us(C)||Ko(C))return N!==null?null:c(x,E,C,S,null);Ol(x,C)}return null}function g(x,E,C,S,N){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(C)||null,l(E,x,""+S,N);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Nl:return x=x.get(S.key===null?C:S.key)||null,a(E,x,S,N);case Yi:return x=x.get(S.key===null?C:S.key)||null,u(E,x,S,N);case hr:var T=S._init;return g(x,E,C,T(S._payload),N)}if(us(S)||Ko(S))return x=x.get(C)||null,c(E,x,S,N,null);Ol(E,S)}return null}function y(x,E,C,S){for(var N=null,T=null,k=E,I=E=0,R=null;k!==null&&I<C.length;I++){k.index>I?(R=k,k=null):R=k.sibling;var M=m(x,k,C[I],S);if(M===null){k===null&&(k=R);break}t&&k&&M.alternate===null&&e(x,k),E=o(M,E,I),T===null?N=M:T.sibling=M,T=M,k=R}if(I===C.length)return n(x,k),_e&&ni(x,I),N;if(k===null){for(;I<C.length;I++)k=p(x,C[I],S),k!==null&&(E=o(k,E,I),T===null?N=k:T.sibling=k,T=k);return _e&&ni(x,I),N}for(k=r(x,k);I<C.length;I++)R=g(k,x,I,C[I],S),R!==null&&(t&&R.alternate!==null&&k.delete(R.key===null?I:R.key),E=o(R,E,I),T===null?N=R:T.sibling=R,T=R);return t&&k.forEach(function(q){return e(x,q)}),_e&&ni(x,I),N}function v(x,E,C,S){var N=Ko(C);if(typeof N!="function")throw Error(O(150));if(C=N.call(C),C==null)throw Error(O(151));for(var T=N=null,k=E,I=E=0,R=null,M=C.next();k!==null&&!M.done;I++,M=C.next()){k.index>I?(R=k,k=null):R=k.sibling;var q=m(x,k,M.value,S);if(q===null){k===null&&(k=R);break}t&&k&&q.alternate===null&&e(x,k),E=o(q,E,I),T===null?N=q:T.sibling=q,T=q,k=R}if(M.done)return n(x,k),_e&&ni(x,I),N;if(k===null){for(;!M.done;I++,M=C.next())M=p(x,M.value,S),M!==null&&(E=o(M,E,I),T===null?N=M:T.sibling=M,T=M);return _e&&ni(x,I),N}for(k=r(x,k);!M.done;I++,M=C.next())M=g(k,x,I,M.value,S),M!==null&&(t&&M.alternate!==null&&k.delete(M.key===null?I:M.key),E=o(M,E,I),T===null?N=M:T.sibling=M,T=M);return t&&k.forEach(function($){return e(x,$)}),_e&&ni(x,I),N}function w(x,E,C,S){if(typeof C=="object"&&C!==null&&C.type===Xi&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case Nl:e:{for(var N=C.key,T=E;T!==null;){if(T.key===N){if(N=C.type,N===Xi){if(T.tag===7){n(x,T.sibling),E=i(T,C.props.children),E.return=x,x=E;break e}}else if(T.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===hr&&cm(N)===T.type){n(x,T.sibling),E=i(T,C.props),E.ref=es(x,T,C),E.return=x,x=E;break e}n(x,T);break}else e(x,T);T=T.sibling}C.type===Xi?(E=pi(C.props.children,x.mode,S,C.key),E.return=x,x=E):(S=fa(C.type,C.key,C.props,null,x.mode,S),S.ref=es(x,E,C),S.return=x,x=S)}return s(x);case Yi:e:{for(T=C.key;E!==null;){if(E.key===T)if(E.tag===4&&E.stateNode.containerInfo===C.containerInfo&&E.stateNode.implementation===C.implementation){n(x,E.sibling),E=i(E,C.children||[]),E.return=x,x=E;break e}else{n(x,E);break}else e(x,E);E=E.sibling}E=Nc(C,x.mode,S),E.return=x,x=E}return s(x);case hr:return T=C._init,w(x,E,T(C._payload),S)}if(us(C))return y(x,E,C,S);if(Ko(C))return v(x,E,C,S);Ol(x,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,E!==null&&E.tag===6?(n(x,E.sibling),E=i(E,C),E.return=x,x=E):(n(x,E),E=Tc(C,x.mode,S),E.return=x,x=E),s(x)):n(x,E)}return w}var Io=ux(!0),cx=ux(!1),Da=qr(null),Pa=null,oo=null,tp=null;function np(){tp=oo=Pa=null}function rp(t){var e=Da.current;Me(Da),t._currentValue=e}function Dd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function go(t,e){Pa=t,tp=oo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(kt=!0),t.firstContext=null)}function ln(t){var e=t._currentValue;if(tp!==t)if(t={context:t,memoizedValue:e,next:null},oo===null){if(Pa===null)throw Error(O(308));oo=t,Pa.dependencies={lanes:0,firstContext:t}}else oo=oo.next=t;return e}var ai=null;function ip(t){ai===null?ai=[t]:ai.push(t)}function dx(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,ip(e)):(n.next=i.next,i.next=n),e.interleaved=n,Zn(t,r)}function Zn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var mr=!1;function op(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Jn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _r(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,xe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Zn(t,n)}return i=r.interleaved,i===null?(e.next=e,ip(r)):(e.next=i.next,i.next=e),r.interleaved=e,Zn(t,n)}function sa(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Gf(t,n)}}function dm(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function La(t,e,n,r){var i=t.updateQueue;mr=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,s===null?o=u:s.next=u,s=a;var c=t.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==s&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(o!==null){var p=i.baseState;s=0,c=u=a=null,l=o;do{var m=l.lane,g=l.eventTime;if((r&m)===m){c!==null&&(c=c.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=t,v=l;switch(m=e,g=n,v.tag){case 1:if(y=v.payload,typeof y=="function"){p=y.call(g,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,m=typeof y=="function"?y.call(g,p,m):y,m==null)break e;p=Pe({},p,m);break e;case 2:mr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[l]:m.push(l))}else g={eventTime:g,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=g,a=p):c=c.next=g,s|=m;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;m=l,l=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(c===null&&(a=p),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Ei|=s,t.lanes=s,t.memoizedState=p}}function fm(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(O(191,i));i.call(r)}}}var pl={},Pn=qr(pl),Gs=qr(pl),qs=qr(pl);function ui(t){if(t===pl)throw Error(O(174));return t}function sp(t,e){switch(ke(qs,e),ke(Gs,t),ke(Pn,pl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pd(e,t)}Me(Pn),ke(Pn,e)}function Mo(){Me(Pn),Me(Gs),Me(qs)}function px(t){ui(qs.current);var e=ui(Pn.current),n=pd(e,t.type);e!==n&&(ke(Gs,t),ke(Pn,n))}function lp(t){Gs.current===t&&(Me(Pn),Me(Gs))}var Re=qr(0);function Oa(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var vc=[];function ap(){for(var t=0;t<vc.length;t++)vc[t]._workInProgressVersionPrimary=null;vc.length=0}var la=sr.ReactCurrentDispatcher,xc=sr.ReactCurrentBatchConfig,Ci=0,De=null,He=null,qe=null,Fa=!1,ws=!1,Ws=0,tT=0;function st(){throw Error(O(321))}function up(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!En(t[n],e[n]))return!1;return!0}function cp(t,e,n,r,i,o){if(Ci=o,De=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,la.current=t===null||t.memoizedState===null?oT:sT,t=n(r,i),ws){o=0;do{if(ws=!1,Ws=0,25<=o)throw Error(O(301));o+=1,qe=He=null,e.updateQueue=null,la.current=lT,t=n(r,i)}while(ws)}if(la.current=Va,e=He!==null&&He.next!==null,Ci=0,qe=He=De=null,Fa=!1,e)throw Error(O(300));return t}function dp(){var t=Ws!==0;return Ws=0,t}function In(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qe===null?De.memoizedState=qe=t:qe=qe.next=t,qe}function an(){if(He===null){var t=De.alternate;t=t!==null?t.memoizedState:null}else t=He.next;var e=qe===null?De.memoizedState:qe.next;if(e!==null)qe=e,He=t;else{if(t===null)throw Error(O(310));He=t,t={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},qe===null?De.memoizedState=qe=t:qe=qe.next=t}return qe}function js(t,e){return typeof e=="function"?e(t):e}function wc(t){var e=an(),n=e.queue;if(n===null)throw Error(O(311));n.lastRenderedReducer=t;var r=He,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var l=s=null,a=null,u=o;do{var c=u.lane;if((Ci&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var p={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=p,s=r):a=a.next=p,De.lanes|=c,Ei|=c}u=u.next}while(u!==null&&u!==o);a===null?s=r:a.next=l,En(r,e.memoizedState)||(kt=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,De.lanes|=o,Ei|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Sc(t){var e=an(),n=e.queue;if(n===null)throw Error(O(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);En(o,e.memoizedState)||(kt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function hx(){}function mx(t,e){var n=De,r=an(),i=e(),o=!En(r.memoizedState,i);if(o&&(r.memoizedState=i,kt=!0),r=r.queue,fp(vx.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||qe!==null&&qe.memoizedState.tag&1){if(n.flags|=2048,Js(9,yx.bind(null,n,r,i,e),void 0,null),Je===null)throw Error(O(349));Ci&30||gx(n,e,i)}return i}function gx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function yx(t,e,n,r){e.value=n,e.getSnapshot=r,xx(e)&&wx(t)}function vx(t,e,n){return n(function(){xx(e)&&wx(t)})}function xx(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!En(t,n)}catch{return!0}}function wx(t){var e=Zn(t,1);e!==null&&Sn(e,t,1,-1)}function pm(t){var e=In();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:js,lastRenderedState:t},e.queue=t,t=t.dispatch=iT.bind(null,De,t),[e.memoizedState,t]}function Js(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Sx(){return an().memoizedState}function aa(t,e,n,r){var i=In();De.flags|=t,i.memoizedState=Js(1|e,n,void 0,r===void 0?null:r)}function xu(t,e,n,r){var i=an();r=r===void 0?null:r;var o=void 0;if(He!==null){var s=He.memoizedState;if(o=s.destroy,r!==null&&up(r,s.deps)){i.memoizedState=Js(e,n,o,r);return}}De.flags|=t,i.memoizedState=Js(1|e,n,o,r)}function hm(t,e){return aa(8390656,8,t,e)}function fp(t,e){return xu(2048,8,t,e)}function Cx(t,e){return xu(4,2,t,e)}function Ex(t,e){return xu(4,4,t,e)}function Tx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Nx(t,e,n){return n=n!=null?n.concat([t]):null,xu(4,4,Tx.bind(null,e,t),n)}function pp(){}function kx(t,e){var n=an();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&up(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ax(t,e){var n=an();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&up(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ix(t,e,n){return Ci&21?(En(n,e)||(n=Dv(),De.lanes|=n,Ei|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,kt=!0),t.memoizedState=n)}function nT(t,e){var n=Ee;Ee=n!==0&&4>n?n:4,t(!0);var r=xc.transition;xc.transition={};try{t(!1),e()}finally{Ee=n,xc.transition=r}}function Mx(){return an().memoizedState}function rT(t,e,n){var r=Dr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},bx(t))_x(e,n);else if(n=dx(t,e,n,r),n!==null){var i=vt();Sn(n,t,r,i),Rx(n,e,r)}}function iT(t,e,n){var r=Dr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(bx(t))_x(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,l=o(s,n);if(i.hasEagerState=!0,i.eagerState=l,En(l,s)){var a=e.interleaved;a===null?(i.next=i,ip(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}n=dx(t,e,i,r),n!==null&&(i=vt(),Sn(n,t,r,i),Rx(n,e,r))}}function bx(t){var e=t.alternate;return t===De||e!==null&&e===De}function _x(t,e){ws=Fa=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Rx(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Gf(t,n)}}var Va={readContext:ln,useCallback:st,useContext:st,useEffect:st,useImperativeHandle:st,useInsertionEffect:st,useLayoutEffect:st,useMemo:st,useReducer:st,useRef:st,useState:st,useDebugValue:st,useDeferredValue:st,useTransition:st,useMutableSource:st,useSyncExternalStore:st,useId:st,unstable_isNewReconciler:!1},oT={readContext:ln,useCallback:function(t,e){return In().memoizedState=[t,e===void 0?null:e],t},useContext:ln,useEffect:hm,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,aa(4194308,4,Tx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return aa(4194308,4,t,e)},useInsertionEffect:function(t,e){return aa(4,2,t,e)},useMemo:function(t,e){var n=In();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=In();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=rT.bind(null,De,t),[r.memoizedState,t]},useRef:function(t){var e=In();return t={current:t},e.memoizedState=t},useState:pm,useDebugValue:pp,useDeferredValue:function(t){return In().memoizedState=t},useTransition:function(){var t=pm(!1),e=t[0];return t=nT.bind(null,t[1]),In().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=De,i=In();if(_e){if(n===void 0)throw Error(O(407));n=n()}else{if(n=e(),Je===null)throw Error(O(349));Ci&30||gx(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,hm(vx.bind(null,r,o,t),[t]),r.flags|=2048,Js(9,yx.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=In(),e=Je.identifierPrefix;if(_e){var n=qn,r=Gn;n=(r&~(1<<32-wn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ws++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=tT++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},sT={readContext:ln,useCallback:kx,useContext:ln,useEffect:fp,useImperativeHandle:Nx,useInsertionEffect:Cx,useLayoutEffect:Ex,useMemo:Ax,useReducer:wc,useRef:Sx,useState:function(){return wc(js)},useDebugValue:pp,useDeferredValue:function(t){var e=an();return Ix(e,He.memoizedState,t)},useTransition:function(){var t=wc(js)[0],e=an().memoizedState;return[t,e]},useMutableSource:hx,useSyncExternalStore:mx,useId:Mx,unstable_isNewReconciler:!1},lT={readContext:ln,useCallback:kx,useContext:ln,useEffect:fp,useImperativeHandle:Nx,useInsertionEffect:Cx,useLayoutEffect:Ex,useMemo:Ax,useReducer:Sc,useRef:Sx,useState:function(){return Sc(js)},useDebugValue:pp,useDeferredValue:function(t){var e=an();return He===null?e.memoizedState=t:Ix(e,He.memoizedState,t)},useTransition:function(){var t=Sc(js)[0],e=an().memoizedState;return[t,e]},useMutableSource:hx,useSyncExternalStore:mx,useId:Mx,unstable_isNewReconciler:!1};function mn(t,e){if(t&&t.defaultProps){e=Pe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Pd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Pe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var wu={isMounted:function(t){return(t=t._reactInternals)?Di(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=vt(),i=Dr(t),o=Jn(r,i);o.payload=e,n!=null&&(o.callback=n),e=_r(t,o,i),e!==null&&(Sn(e,t,i,r),sa(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=vt(),i=Dr(t),o=Jn(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=_r(t,o,i),e!==null&&(Sn(e,t,i,r),sa(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=vt(),r=Dr(t),i=Jn(n,r);i.tag=2,e!=null&&(i.callback=e),e=_r(t,i,r),e!==null&&(Sn(e,t,r,n),sa(e,t,r))}};function mm(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Us(n,r)||!Us(i,o):!0}function Dx(t,e,n){var r=!1,i=zr,o=e.contextType;return typeof o=="object"&&o!==null?o=ln(o):(i=Mt(e)?wi:ft.current,r=e.contextTypes,o=(r=r!=null)?ko(t,i):zr),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=wu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function gm(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&wu.enqueueReplaceState(e,e.state,null)}function Ld(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},op(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=ln(o):(o=Mt(e)?wi:ft.current,i.context=ko(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Pd(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&wu.enqueueReplaceState(i,i.state,null),La(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function bo(t,e){try{var n="",r=e;do n+=LC(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Cc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Od(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var aT=typeof WeakMap=="function"?WeakMap:Map;function Px(t,e,n){n=Jn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ua||(Ua=!0,Wd=r),Od(t,e)},n}function Lx(t,e,n){n=Jn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Od(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Od(t,e),typeof r!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function ym(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new aT;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=CT.bind(null,t,e,n),e.then(t,t))}function vm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function xm(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Jn(-1,1),e.tag=2,_r(n,e,1))),n.lanes|=1),t)}var uT=sr.ReactCurrentOwner,kt=!1;function yt(t,e,n,r){e.child=t===null?cx(e,null,n,r):Io(e,t.child,n,r)}function wm(t,e,n,r,i){n=n.render;var o=e.ref;return go(e,i),r=cp(t,e,n,r,o,i),n=dp(),t!==null&&!kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,er(t,e,i)):(_e&&n&&Qf(e),e.flags|=1,yt(t,e,r,i),e.child)}function Sm(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!Sp(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,Ox(t,e,o,r,i)):(t=fa(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Us,n(s,r)&&t.ref===e.ref)return er(t,e,i)}return e.flags|=1,t=Pr(o,r),t.ref=e.ref,t.return=e,e.child=t}function Ox(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Us(o,r)&&t.ref===e.ref)if(kt=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(kt=!0);else return e.lanes=t.lanes,er(t,e,i)}return Fd(t,e,n,r,i)}function Fx(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ke(lo,Ot),Ot|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ke(lo,Ot),Ot|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ke(lo,Ot),Ot|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ke(lo,Ot),Ot|=r;return yt(t,e,i,n),e.child}function Vx(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Fd(t,e,n,r,i){var o=Mt(n)?wi:ft.current;return o=ko(e,o),go(e,i),n=cp(t,e,n,r,o,i),r=dp(),t!==null&&!kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,er(t,e,i)):(_e&&r&&Qf(e),e.flags|=1,yt(t,e,n,i),e.child)}function Cm(t,e,n,r,i){if(Mt(n)){var o=!0;ba(e)}else o=!1;if(go(e,i),e.stateNode===null)ua(t,e),Dx(e,n,r),Ld(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,l=e.memoizedProps;s.props=l;var a=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=ln(u):(u=Mt(n)?wi:ft.current,u=ko(e,u));var c=n.getDerivedStateFromProps,p=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";p||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==r||a!==u)&&gm(e,s,r,u),mr=!1;var m=e.memoizedState;s.state=m,La(e,r,s,i),a=e.memoizedState,l!==r||m!==a||It.current||mr?(typeof c=="function"&&(Pd(e,n,c,r),a=e.memoizedState),(l=mr||mm(e,n,l,r,m,a,u))?(p||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),s.props=r,s.state=a,s.context=u,r=l):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,fx(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:mn(e.type,l),s.props=u,p=e.pendingProps,m=s.context,a=n.contextType,typeof a=="object"&&a!==null?a=ln(a):(a=Mt(n)?wi:ft.current,a=ko(e,a));var g=n.getDerivedStateFromProps;(c=typeof g=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==p||m!==a)&&gm(e,s,r,a),mr=!1,m=e.memoizedState,s.state=m,La(e,r,s,i);var y=e.memoizedState;l!==p||m!==y||It.current||mr?(typeof g=="function"&&(Pd(e,n,g,r),y=e.memoizedState),(u=mr||mm(e,n,u,r,m,y,a)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,y,a),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,y,a)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),s.props=r,s.state=y,s.context=a,r=u):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Vd(t,e,n,r,o,i)}function Vd(t,e,n,r,i,o){Vx(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&lm(e,n,!1),er(t,e,o);r=e.stateNode,uT.current=e;var l=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Io(e,t.child,null,o),e.child=Io(e,null,l,o)):yt(t,e,l,o),e.memoizedState=r.state,i&&lm(e,n,!0),e.child}function Bx(t){var e=t.stateNode;e.pendingContext?sm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&sm(t,e.context,!1),sp(t,e.containerInfo)}function Em(t,e,n,r,i){return Ao(),ep(i),e.flags|=256,yt(t,e,n,r),e.child}var Bd={dehydrated:null,treeContext:null,retryLane:0};function Ud(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ux(t,e,n){var r=e.pendingProps,i=Re.current,o=!1,s=(e.flags&128)!==0,l;if((l=s)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ke(Re,i&1),t===null)return Rd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Eu(s,r,0,null),t=pi(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Ud(n),e.memoizedState=Bd,t):hp(e,s));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return cT(t,e,s,r,l,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=Pr(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?o=Pr(l,o):(o=pi(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?Ud(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Bd,r}return o=t.child,t=o.sibling,r=Pr(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function hp(t,e){return e=Eu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fl(t,e,n,r){return r!==null&&ep(r),Io(e,t.child,null,n),t=hp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function cT(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=Cc(Error(O(422))),Fl(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Eu({mode:"visible",children:r.children},i,0,null),o=pi(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Io(e,t.child,null,s),e.child.memoizedState=Ud(s),e.memoizedState=Bd,o);if(!(e.mode&1))return Fl(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(O(419)),r=Cc(o,r,void 0),Fl(t,e,s,r)}if(l=(s&t.childLanes)!==0,kt||l){if(r=Je,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Zn(t,i),Sn(r,t,i,-1))}return wp(),r=Cc(Error(O(421))),Fl(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=ET.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Vt=br(i.nextSibling),Bt=e,_e=!0,yn=null,t!==null&&(Yt[Xt++]=Gn,Yt[Xt++]=qn,Yt[Xt++]=Si,Gn=t.id,qn=t.overflow,Si=e),e=hp(e,r.children),e.flags|=4096,e)}function Tm(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Dd(t.return,e,n)}function Ec(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function zx(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(yt(t,e,r.children,n),r=Re.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Tm(t,n,e);else if(t.tag===19)Tm(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ke(Re,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Oa(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Ec(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Oa(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Ec(e,!0,n,null,o);break;case"together":Ec(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ua(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function er(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ei|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(O(153));if(e.child!==null){for(t=e.child,n=Pr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Pr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function dT(t,e,n){switch(e.tag){case 3:Bx(e),Ao();break;case 5:px(e);break;case 1:Mt(e.type)&&ba(e);break;case 4:sp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ke(Da,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ke(Re,Re.current&1),e.flags|=128,null):n&e.child.childLanes?Ux(t,e,n):(ke(Re,Re.current&1),t=er(t,e,n),t!==null?t.sibling:null);ke(Re,Re.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return zx(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ke(Re,Re.current),r)break;return null;case 22:case 23:return e.lanes=0,Fx(t,e,n)}return er(t,e,n)}var Hx,zd,$x,Gx;Hx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zd=function(){};$x=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ui(Pn.current);var o=null;switch(n){case"input":i=ud(t,i),r=ud(t,r),o=[];break;case"select":i=Pe({},i,{value:void 0}),r=Pe({},r,{value:void 0}),o=[];break;case"textarea":i=fd(t,i),r=fd(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ia)}hd(n,r);var s;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ds.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(s in l)!l.hasOwnProperty(s)||a&&a.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in a)a.hasOwnProperty(s)&&l[s]!==a[s]&&(n||(n={}),n[s]=a[s])}else n||(o||(o=[]),o.push(u,n)),n=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(o=o||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(o=o||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ds.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&Ae("scroll",t),o||l===a||(o=[])):(o=o||[]).push(u,a))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};Gx=function(t,e,n,r){n!==r&&(e.flags|=4)};function ts(t,e){if(!_e)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function lt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function fT(t,e,n){var r=e.pendingProps;switch(Zf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(e),null;case 1:return Mt(e.type)&&Ma(),lt(e),null;case 3:return r=e.stateNode,Mo(),Me(It),Me(ft),ap(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ll(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,yn!==null&&(Kd(yn),yn=null))),zd(t,e),lt(e),null;case 5:lp(e);var i=ui(qs.current);if(n=e.type,t!==null&&e.stateNode!=null)$x(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(O(166));return lt(e),null}if(t=ui(Pn.current),Ll(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[_n]=e,r[$s]=o,t=(e.mode&1)!==0,n){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(i=0;i<ds.length;i++)Ae(ds[i],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":Dh(r,o),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ae("invalid",r);break;case"textarea":Lh(r,o),Ae("invalid",r)}hd(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&Pl(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Pl(r.textContent,l,t),i=["children",""+l]):Ds.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&Ae("scroll",r)}switch(n){case"input":kl(r),Ph(r,o,!0);break;case"textarea":kl(r),Oh(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ia)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=vv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[_n]=e,t[$s]=r,Hx(t,e,!1,!1),e.stateNode=t;e:{switch(s=md(n,r),n){case"dialog":Ae("cancel",t),Ae("close",t),i=r;break;case"iframe":case"object":case"embed":Ae("load",t),i=r;break;case"video":case"audio":for(i=0;i<ds.length;i++)Ae(ds[i],t);i=r;break;case"source":Ae("error",t),i=r;break;case"img":case"image":case"link":Ae("error",t),Ae("load",t),i=r;break;case"details":Ae("toggle",t),i=r;break;case"input":Dh(t,r),i=ud(t,r),Ae("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Pe({},r,{value:void 0}),Ae("invalid",t);break;case"textarea":Lh(t,r),i=fd(t,r),Ae("invalid",t);break;default:i=r}hd(n,i),l=i;for(o in l)if(l.hasOwnProperty(o)){var a=l[o];o==="style"?Sv(t,a):o==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&xv(t,a)):o==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&Ps(t,a):typeof a=="number"&&Ps(t,""+a):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Ds.hasOwnProperty(o)?a!=null&&o==="onScroll"&&Ae("scroll",t):a!=null&&Vf(t,o,a,s))}switch(n){case"input":kl(t),Ph(t,r,!1);break;case"textarea":kl(t),Oh(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ur(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?fo(t,!!r.multiple,o,!1):r.defaultValue!=null&&fo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ia)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return lt(e),null;case 6:if(t&&e.stateNode!=null)Gx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(O(166));if(n=ui(qs.current),ui(Pn.current),Ll(e)){if(r=e.stateNode,n=e.memoizedProps,r[_n]=e,(o=r.nodeValue!==n)&&(t=Bt,t!==null))switch(t.tag){case 3:Pl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Pl(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[_n]=e,e.stateNode=r}return lt(e),null;case 13:if(Me(Re),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(_e&&Vt!==null&&e.mode&1&&!(e.flags&128))ax(),Ao(),e.flags|=98560,o=!1;else if(o=Ll(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(O(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(O(317));o[_n]=e}else Ao(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;lt(e),o=!1}else yn!==null&&(Kd(yn),yn=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Re.current&1?$e===0&&($e=3):wp())),e.updateQueue!==null&&(e.flags|=4),lt(e),null);case 4:return Mo(),zd(t,e),t===null&&zs(e.stateNode.containerInfo),lt(e),null;case 10:return rp(e.type._context),lt(e),null;case 17:return Mt(e.type)&&Ma(),lt(e),null;case 19:if(Me(Re),o=e.memoizedState,o===null)return lt(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)ts(o,!1);else{if($e!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Oa(t),s!==null){for(e.flags|=128,ts(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ke(Re,Re.current&1|2),e.child}t=t.sibling}o.tail!==null&&Be()>_o&&(e.flags|=128,r=!0,ts(o,!1),e.lanes=4194304)}else{if(!r)if(t=Oa(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ts(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!_e)return lt(e),null}else 2*Be()-o.renderingStartTime>_o&&n!==1073741824&&(e.flags|=128,r=!0,ts(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Be(),e.sibling=null,n=Re.current,ke(Re,r?n&1|2:n&1),e):(lt(e),null);case 22:case 23:return xp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ot&1073741824&&(lt(e),e.subtreeFlags&6&&(e.flags|=8192)):lt(e),null;case 24:return null;case 25:return null}throw Error(O(156,e.tag))}function pT(t,e){switch(Zf(e),e.tag){case 1:return Mt(e.type)&&Ma(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Mo(),Me(It),Me(ft),ap(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return lp(e),null;case 13:if(Me(Re),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(O(340));Ao()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Me(Re),null;case 4:return Mo(),null;case 10:return rp(e.type._context),null;case 22:case 23:return xp(),null;case 24:return null;default:return null}}var Vl=!1,ct=!1,hT=typeof WeakSet=="function"?WeakSet:Set,K=null;function so(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Oe(t,e,r)}else n.current=null}function Hd(t,e,n){try{n()}catch(r){Oe(t,e,r)}}var Nm=!1;function mT(t,e){if(Nd=Na,t=Kv(),Xf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,l=-1,a=-1,u=0,c=0,p=t,m=null;t:for(;;){for(var g;p!==n||i!==0&&p.nodeType!==3||(l=s+i),p!==o||r!==0&&p.nodeType!==3||(a=s+r),p.nodeType===3&&(s+=p.nodeValue.length),(g=p.firstChild)!==null;)m=p,p=g;for(;;){if(p===t)break t;if(m===n&&++u===i&&(l=s),m===o&&++c===r&&(a=s),(g=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=g}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(kd={focusedElem:t,selectionRange:n},Na=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,w=y.memoizedState,x=e.stateNode,E=x.getSnapshotBeforeUpdate(e.elementType===e.type?v:mn(e.type,v),w);x.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(O(163))}}catch(S){Oe(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return y=Nm,Nm=!1,y}function Ss(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Hd(e,n,o)}i=i.next}while(i!==r)}}function Su(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function $d(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function qx(t){var e=t.alternate;e!==null&&(t.alternate=null,qx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[_n],delete e[$s],delete e[Md],delete e[XE],delete e[QE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Wx(t){return t.tag===5||t.tag===3||t.tag===4}function km(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Wx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Gd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ia));else if(r!==4&&(t=t.child,t!==null))for(Gd(t,e,n),t=t.sibling;t!==null;)Gd(t,e,n),t=t.sibling}function qd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(qd(t,e,n),t=t.sibling;t!==null;)qd(t,e,n),t=t.sibling}var Ze=null,gn=!1;function dr(t,e,n){for(n=n.child;n!==null;)jx(t,e,n),n=n.sibling}function jx(t,e,n){if(Dn&&typeof Dn.onCommitFiberUnmount=="function")try{Dn.onCommitFiberUnmount(pu,n)}catch{}switch(n.tag){case 5:ct||so(n,e);case 6:var r=Ze,i=gn;Ze=null,dr(t,e,n),Ze=r,gn=i,Ze!==null&&(gn?(t=Ze,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ze.removeChild(n.stateNode));break;case 18:Ze!==null&&(gn?(t=Ze,n=n.stateNode,t.nodeType===8?gc(t.parentNode,n):t.nodeType===1&&gc(t,n),Vs(t)):gc(Ze,n.stateNode));break;case 4:r=Ze,i=gn,Ze=n.stateNode.containerInfo,gn=!0,dr(t,e,n),Ze=r,gn=i;break;case 0:case 11:case 14:case 15:if(!ct&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Hd(n,e,s),i=i.next}while(i!==r)}dr(t,e,n);break;case 1:if(!ct&&(so(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Oe(n,e,l)}dr(t,e,n);break;case 21:dr(t,e,n);break;case 22:n.mode&1?(ct=(r=ct)||n.memoizedState!==null,dr(t,e,n),ct=r):dr(t,e,n);break;default:dr(t,e,n)}}function Am(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new hT),e.forEach(function(r){var i=TT.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function hn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,l=s;e:for(;l!==null;){switch(l.tag){case 5:Ze=l.stateNode,gn=!1;break e;case 3:Ze=l.stateNode.containerInfo,gn=!0;break e;case 4:Ze=l.stateNode.containerInfo,gn=!0;break e}l=l.return}if(Ze===null)throw Error(O(160));jx(o,s,i),Ze=null,gn=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){Oe(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Jx(e,t),e=e.sibling}function Jx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(hn(e,t),An(t),r&4){try{Ss(3,t,t.return),Su(3,t)}catch(v){Oe(t,t.return,v)}try{Ss(5,t,t.return)}catch(v){Oe(t,t.return,v)}}break;case 1:hn(e,t),An(t),r&512&&n!==null&&so(n,n.return);break;case 5:if(hn(e,t),An(t),r&512&&n!==null&&so(n,n.return),t.flags&32){var i=t.stateNode;try{Ps(i,"")}catch(v){Oe(t,t.return,v)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&gv(i,o),md(l,s);var u=md(l,o);for(s=0;s<a.length;s+=2){var c=a[s],p=a[s+1];c==="style"?Sv(i,p):c==="dangerouslySetInnerHTML"?xv(i,p):c==="children"?Ps(i,p):Vf(i,c,p,u)}switch(l){case"input":cd(i,o);break;case"textarea":yv(i,o);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?fo(i,!!o.multiple,g,!1):m!==!!o.multiple&&(o.defaultValue!=null?fo(i,!!o.multiple,o.defaultValue,!0):fo(i,!!o.multiple,o.multiple?[]:"",!1))}i[$s]=o}catch(v){Oe(t,t.return,v)}}break;case 6:if(hn(e,t),An(t),r&4){if(t.stateNode===null)throw Error(O(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(v){Oe(t,t.return,v)}}break;case 3:if(hn(e,t),An(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Vs(e.containerInfo)}catch(v){Oe(t,t.return,v)}break;case 4:hn(e,t),An(t);break;case 13:hn(e,t),An(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(yp=Be())),r&4&&Am(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(ct=(u=ct)||c,hn(e,t),ct=u):hn(e,t),An(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(K=t,c=t.child;c!==null;){for(p=K=c;K!==null;){switch(m=K,g=m.child,m.tag){case 0:case 11:case 14:case 15:Ss(4,m,m.return);break;case 1:so(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(v){Oe(r,n,v)}}break;case 5:so(m,m.return);break;case 22:if(m.memoizedState!==null){Mm(p);continue}}g!==null?(g.return=m,K=g):Mm(p)}c=c.sibling}e:for(c=null,p=t;;){if(p.tag===5){if(c===null){c=p;try{i=p.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=p.stateNode,a=p.memoizedProps.style,s=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=wv("display",s))}catch(v){Oe(t,t.return,v)}}}else if(p.tag===6){if(c===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(v){Oe(t,t.return,v)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;c===p&&(c=null),p=p.return}c===p&&(c=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:hn(e,t),An(t),r&4&&Am(t);break;case 21:break;default:hn(e,t),An(t)}}function An(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Wx(n)){var r=n;break e}n=n.return}throw Error(O(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ps(i,""),r.flags&=-33);var o=km(t);qd(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,l=km(t);Gd(t,l,s);break;default:throw Error(O(161))}}catch(a){Oe(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gT(t,e,n){K=t,Kx(t)}function Kx(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var i=K,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Vl;if(!s){var l=i.alternate,a=l!==null&&l.memoizedState!==null||ct;l=Vl;var u=ct;if(Vl=s,(ct=a)&&!u)for(K=i;K!==null;)s=K,a=s.child,s.tag===22&&s.memoizedState!==null?bm(i):a!==null?(a.return=s,K=a):bm(i);for(;o!==null;)K=o,Kx(o),o=o.sibling;K=i,Vl=l,ct=u}Im(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,K=o):Im(t)}}function Im(t){for(;K!==null;){var e=K;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ct||Su(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ct)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:mn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&fm(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}fm(e,s,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var p=c.dehydrated;p!==null&&Vs(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(O(163))}ct||e.flags&512&&$d(e)}catch(m){Oe(e,e.return,m)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function Mm(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function bm(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Su(4,e)}catch(a){Oe(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){Oe(e,i,a)}}var o=e.return;try{$d(e)}catch(a){Oe(e,o,a)}break;case 5:var s=e.return;try{$d(e)}catch(a){Oe(e,s,a)}}}catch(a){Oe(e,e.return,a)}if(e===t){K=null;break}var l=e.sibling;if(l!==null){l.return=e.return,K=l;break}K=e.return}}var yT=Math.ceil,Ba=sr.ReactCurrentDispatcher,mp=sr.ReactCurrentOwner,tn=sr.ReactCurrentBatchConfig,xe=0,Je=null,Ue=null,rt=0,Ot=0,lo=qr(0),$e=0,Ks=null,Ei=0,Cu=0,gp=0,Cs=null,Nt=null,yp=0,_o=1/0,zn=null,Ua=!1,Wd=null,Rr=null,Bl=!1,Cr=null,za=0,Es=0,jd=null,ca=-1,da=0;function vt(){return xe&6?Be():ca!==-1?ca:ca=Be()}function Dr(t){return t.mode&1?xe&2&&rt!==0?rt&-rt:eT.transition!==null?(da===0&&(da=Dv()),da):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:Uv(t.type)),t):1}function Sn(t,e,n,r){if(50<Es)throw Es=0,jd=null,Error(O(185));cl(t,n,r),(!(xe&2)||t!==Je)&&(t===Je&&(!(xe&2)&&(Cu|=n),$e===4&&xr(t,rt)),bt(t,r),n===1&&xe===0&&!(e.mode&1)&&(_o=Be()+500,vu&&Wr()))}function bt(t,e){var n=t.callbackNode;eE(t,e);var r=Ta(t,t===Je?rt:0);if(r===0)n!==null&&Bh(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Bh(n),e===1)t.tag===0?ZE(_m.bind(null,t)):ox(_m.bind(null,t)),KE(function(){!(xe&6)&&Wr()}),n=null;else{switch(Pv(r)){case 1:n=$f;break;case 4:n=_v;break;case 16:n=Ea;break;case 536870912:n=Rv;break;default:n=Ea}n=r1(n,Yx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Yx(t,e){if(ca=-1,da=0,xe&6)throw Error(O(327));var n=t.callbackNode;if(yo()&&t.callbackNode!==n)return null;var r=Ta(t,t===Je?rt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ha(t,r);else{e=r;var i=xe;xe|=2;var o=Qx();(Je!==t||rt!==e)&&(zn=null,_o=Be()+500,fi(t,e));do try{wT();break}catch(l){Xx(t,l)}while(!0);np(),Ba.current=o,xe=i,Ue!==null?e=0:(Je=null,rt=0,e=$e)}if(e!==0){if(e===2&&(i=wd(t),i!==0&&(r=i,e=Jd(t,i))),e===1)throw n=Ks,fi(t,0),xr(t,r),bt(t,Be()),n;if(e===6)xr(t,r);else{if(i=t.current.alternate,!(r&30)&&!vT(i)&&(e=Ha(t,r),e===2&&(o=wd(t),o!==0&&(r=o,e=Jd(t,o))),e===1))throw n=Ks,fi(t,0),xr(t,r),bt(t,Be()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(O(345));case 2:ri(t,Nt,zn);break;case 3:if(xr(t,r),(r&130023424)===r&&(e=yp+500-Be(),10<e)){if(Ta(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){vt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Id(ri.bind(null,t,Nt,zn),e);break}ri(t,Nt,zn);break;case 4:if(xr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-wn(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*yT(r/1960))-r,10<r){t.timeoutHandle=Id(ri.bind(null,t,Nt,zn),r);break}ri(t,Nt,zn);break;case 5:ri(t,Nt,zn);break;default:throw Error(O(329))}}}return bt(t,Be()),t.callbackNode===n?Yx.bind(null,t):null}function Jd(t,e){var n=Cs;return t.current.memoizedState.isDehydrated&&(fi(t,e).flags|=256),t=Ha(t,e),t!==2&&(e=Nt,Nt=n,e!==null&&Kd(e)),t}function Kd(t){Nt===null?Nt=t:Nt.push.apply(Nt,t)}function vT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!En(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xr(t,e){for(e&=~gp,e&=~Cu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-wn(e),r=1<<n;t[n]=-1,e&=~r}}function _m(t){if(xe&6)throw Error(O(327));yo();var e=Ta(t,0);if(!(e&1))return bt(t,Be()),null;var n=Ha(t,e);if(t.tag!==0&&n===2){var r=wd(t);r!==0&&(e=r,n=Jd(t,r))}if(n===1)throw n=Ks,fi(t,0),xr(t,e),bt(t,Be()),n;if(n===6)throw Error(O(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ri(t,Nt,zn),bt(t,Be()),null}function vp(t,e){var n=xe;xe|=1;try{return t(e)}finally{xe=n,xe===0&&(_o=Be()+500,vu&&Wr())}}function Ti(t){Cr!==null&&Cr.tag===0&&!(xe&6)&&yo();var e=xe;xe|=1;var n=tn.transition,r=Ee;try{if(tn.transition=null,Ee=1,t)return t()}finally{Ee=r,tn.transition=n,xe=e,!(xe&6)&&Wr()}}function xp(){Ot=lo.current,Me(lo)}function fi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,JE(n)),Ue!==null)for(n=Ue.return;n!==null;){var r=n;switch(Zf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ma();break;case 3:Mo(),Me(It),Me(ft),ap();break;case 5:lp(r);break;case 4:Mo();break;case 13:Me(Re);break;case 19:Me(Re);break;case 10:rp(r.type._context);break;case 22:case 23:xp()}n=n.return}if(Je=t,Ue=t=Pr(t.current,null),rt=Ot=e,$e=0,Ks=null,gp=Cu=Ei=0,Nt=Cs=null,ai!==null){for(e=0;e<ai.length;e++)if(n=ai[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}ai=null}return t}function Xx(t,e){do{var n=Ue;try{if(np(),la.current=Va,Fa){for(var r=De.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Fa=!1}if(Ci=0,qe=He=De=null,ws=!1,Ws=0,mp.current=null,n===null||n.return===null){$e=1,Ks=e,Ue=null;break}e:{var o=t,s=n.return,l=n,a=e;if(e=rt,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,p=c.tag;if(!(c.mode&1)&&(p===0||p===11||p===15)){var m=c.alternate;m?(c.updateQueue=m.updateQueue,c.memoizedState=m.memoizedState,c.lanes=m.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=vm(s);if(g!==null){g.flags&=-257,xm(g,s,l,o,e),g.mode&1&&ym(o,u,e),e=g,a=u;var y=e.updateQueue;if(y===null){var v=new Set;v.add(a),e.updateQueue=v}else y.add(a);break e}else{if(!(e&1)){ym(o,u,e),wp();break e}a=Error(O(426))}}else if(_e&&l.mode&1){var w=vm(s);if(w!==null){!(w.flags&65536)&&(w.flags|=256),xm(w,s,l,o,e),ep(bo(a,l));break e}}o=a=bo(a,l),$e!==4&&($e=2),Cs===null?Cs=[o]:Cs.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var x=Px(o,a,e);dm(o,x);break e;case 1:l=a;var E=o.type,C=o.stateNode;if(!(o.flags&128)&&(typeof E.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Rr===null||!Rr.has(C)))){o.flags|=65536,e&=-e,o.lanes|=e;var S=Lx(o,l,e);dm(o,S);break e}}o=o.return}while(o!==null)}e1(n)}catch(N){e=N,Ue===n&&n!==null&&(Ue=n=n.return);continue}break}while(!0)}function Qx(){var t=Ba.current;return Ba.current=Va,t===null?Va:t}function wp(){($e===0||$e===3||$e===2)&&($e=4),Je===null||!(Ei&268435455)&&!(Cu&268435455)||xr(Je,rt)}function Ha(t,e){var n=xe;xe|=2;var r=Qx();(Je!==t||rt!==e)&&(zn=null,fi(t,e));do try{xT();break}catch(i){Xx(t,i)}while(!0);if(np(),xe=n,Ba.current=r,Ue!==null)throw Error(O(261));return Je=null,rt=0,$e}function xT(){for(;Ue!==null;)Zx(Ue)}function wT(){for(;Ue!==null&&!qC();)Zx(Ue)}function Zx(t){var e=n1(t.alternate,t,Ot);t.memoizedProps=t.pendingProps,e===null?e1(t):Ue=e,mp.current=null}function e1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pT(n,e),n!==null){n.flags&=32767,Ue=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$e=6,Ue=null;return}}else if(n=fT(n,e,Ot),n!==null){Ue=n;return}if(e=e.sibling,e!==null){Ue=e;return}Ue=e=t}while(e!==null);$e===0&&($e=5)}function ri(t,e,n){var r=Ee,i=tn.transition;try{tn.transition=null,Ee=1,ST(t,e,n,r)}finally{tn.transition=i,Ee=r}return null}function ST(t,e,n,r){do yo();while(Cr!==null);if(xe&6)throw Error(O(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(O(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(tE(t,o),t===Je&&(Ue=Je=null,rt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bl||(Bl=!0,r1(Ea,function(){return yo(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=tn.transition,tn.transition=null;var s=Ee;Ee=1;var l=xe;xe|=4,mp.current=null,mT(t,n),Jx(n,t),zE(kd),Na=!!Nd,kd=Nd=null,t.current=n,gT(n),WC(),xe=l,Ee=s,tn.transition=o}else t.current=n;if(Bl&&(Bl=!1,Cr=t,za=i),o=t.pendingLanes,o===0&&(Rr=null),KC(n.stateNode),bt(t,Be()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ua)throw Ua=!1,t=Wd,Wd=null,t;return za&1&&t.tag!==0&&yo(),o=t.pendingLanes,o&1?t===jd?Es++:(Es=0,jd=t):Es=0,Wr(),null}function yo(){if(Cr!==null){var t=Pv(za),e=tn.transition,n=Ee;try{if(tn.transition=null,Ee=16>t?16:t,Cr===null)var r=!1;else{if(t=Cr,Cr=null,za=0,xe&6)throw Error(O(331));var i=xe;for(xe|=4,K=t.current;K!==null;){var o=K,s=o.child;if(K.flags&16){var l=o.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(K=u;K!==null;){var c=K;switch(c.tag){case 0:case 11:case 15:Ss(8,c,o)}var p=c.child;if(p!==null)p.return=c,K=p;else for(;K!==null;){c=K;var m=c.sibling,g=c.return;if(qx(c),c===u){K=null;break}if(m!==null){m.return=g,K=m;break}K=g}}}var y=o.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}K=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,K=s;else e:for(;K!==null;){if(o=K,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ss(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,K=x;break e}K=o.return}}var E=t.current;for(K=E;K!==null;){s=K;var C=s.child;if(s.subtreeFlags&2064&&C!==null)C.return=s,K=C;else e:for(s=E;K!==null;){if(l=K,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Su(9,l)}}catch(N){Oe(l,l.return,N)}if(l===s){K=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,K=S;break e}K=l.return}}if(xe=i,Wr(),Dn&&typeof Dn.onPostCommitFiberRoot=="function")try{Dn.onPostCommitFiberRoot(pu,t)}catch{}r=!0}return r}finally{Ee=n,tn.transition=e}}return!1}function Rm(t,e,n){e=bo(n,e),e=Px(t,e,1),t=_r(t,e,1),e=vt(),t!==null&&(cl(t,1,e),bt(t,e))}function Oe(t,e,n){if(t.tag===3)Rm(t,t,n);else for(;e!==null;){if(e.tag===3){Rm(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rr===null||!Rr.has(r))){t=bo(n,t),t=Lx(e,t,1),e=_r(e,t,1),t=vt(),e!==null&&(cl(e,1,t),bt(e,t));break}}e=e.return}}function CT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=vt(),t.pingedLanes|=t.suspendedLanes&n,Je===t&&(rt&n)===n&&($e===4||$e===3&&(rt&130023424)===rt&&500>Be()-yp?fi(t,0):gp|=n),bt(t,e)}function t1(t,e){e===0&&(t.mode&1?(e=Ml,Ml<<=1,!(Ml&130023424)&&(Ml=4194304)):e=1);var n=vt();t=Zn(t,e),t!==null&&(cl(t,e,n),bt(t,n))}function ET(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),t1(t,n)}function TT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(O(314))}r!==null&&r.delete(e),t1(t,n)}var n1;n1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||It.current)kt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return kt=!1,dT(t,e,n);kt=!!(t.flags&131072)}else kt=!1,_e&&e.flags&1048576&&sx(e,Ra,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ua(t,e),t=e.pendingProps;var i=ko(e,ft.current);go(e,n),i=cp(null,e,r,t,i,n);var o=dp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Mt(r)?(o=!0,ba(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,op(e),i.updater=wu,e.stateNode=i,i._reactInternals=e,Ld(e,r,t,n),e=Vd(null,e,r,!0,o,n)):(e.tag=0,_e&&o&&Qf(e),yt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ua(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=kT(r),t=mn(r,t),i){case 0:e=Fd(null,e,r,t,n);break e;case 1:e=Cm(null,e,r,t,n);break e;case 11:e=wm(null,e,r,t,n);break e;case 14:e=Sm(null,e,r,mn(r.type,t),n);break e}throw Error(O(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mn(r,i),Fd(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mn(r,i),Cm(t,e,r,i,n);case 3:e:{if(Bx(e),t===null)throw Error(O(387));r=e.pendingProps,o=e.memoizedState,i=o.element,fx(t,e),La(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=bo(Error(O(423)),e),e=Em(t,e,r,n,i);break e}else if(r!==i){i=bo(Error(O(424)),e),e=Em(t,e,r,n,i);break e}else for(Vt=br(e.stateNode.containerInfo.firstChild),Bt=e,_e=!0,yn=null,n=cx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ao(),r===i){e=er(t,e,n);break e}yt(t,e,r,n)}e=e.child}return e;case 5:return px(e),t===null&&Rd(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Ad(r,i)?s=null:o!==null&&Ad(r,o)&&(e.flags|=32),Vx(t,e),yt(t,e,s,n),e.child;case 6:return t===null&&Rd(e),null;case 13:return Ux(t,e,n);case 4:return sp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Io(e,null,r,n):yt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mn(r,i),wm(t,e,r,i,n);case 7:return yt(t,e,e.pendingProps,n),e.child;case 8:return yt(t,e,e.pendingProps.children,n),e.child;case 12:return yt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,ke(Da,r._currentValue),r._currentValue=s,o!==null)if(En(o.value,s)){if(o.children===i.children&&!It.current){e=er(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){s=o.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(o.tag===1){a=Jn(-1,n&-n),a.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Dd(o.return,n,e),l.lanes|=n;break}a=a.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(O(341));s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Dd(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}yt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,go(e,n),i=ln(i),r=r(i),e.flags|=1,yt(t,e,r,n),e.child;case 14:return r=e.type,i=mn(r,e.pendingProps),i=mn(r.type,i),Sm(t,e,r,i,n);case 15:return Ox(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mn(r,i),ua(t,e),e.tag=1,Mt(r)?(t=!0,ba(e)):t=!1,go(e,n),Dx(e,r,i),Ld(e,r,i,n),Vd(null,e,r,!0,t,n);case 19:return zx(t,e,n);case 22:return Fx(t,e,n)}throw Error(O(156,e.tag))};function r1(t,e){return bv(t,e)}function NT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(t,e,n,r){return new NT(t,e,n,r)}function Sp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function kT(t){if(typeof t=="function")return Sp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Uf)return 11;if(t===zf)return 14}return 2}function Pr(t,e){var n=t.alternate;return n===null?(n=en(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function fa(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")Sp(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Xi:return pi(n.children,i,o,e);case Bf:s=8,i|=8;break;case od:return t=en(12,n,e,i|2),t.elementType=od,t.lanes=o,t;case sd:return t=en(13,n,e,i),t.elementType=sd,t.lanes=o,t;case ld:return t=en(19,n,e,i),t.elementType=ld,t.lanes=o,t;case pv:return Eu(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case dv:s=10;break e;case fv:s=9;break e;case Uf:s=11;break e;case zf:s=14;break e;case hr:s=16,r=null;break e}throw Error(O(130,t==null?t:typeof t,""))}return e=en(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function pi(t,e,n,r){return t=en(7,t,r,e),t.lanes=n,t}function Eu(t,e,n,r){return t=en(22,t,r,e),t.elementType=pv,t.lanes=n,t.stateNode={isHidden:!1},t}function Tc(t,e,n){return t=en(6,t,null,e),t.lanes=n,t}function Nc(t,e,n){return e=en(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function AT(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oc(0),this.expirationTimes=oc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oc(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Cp(t,e,n,r,i,o,s,l,a){return t=new AT(t,e,n,l,a),e===1?(e=1,o===!0&&(e|=8)):e=0,o=en(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},op(o),t}function IT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function i1(t){if(!t)return zr;t=t._reactInternals;e:{if(Di(t)!==t||t.tag!==1)throw Error(O(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Mt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(O(171))}if(t.tag===1){var n=t.type;if(Mt(n))return ix(t,n,e)}return e}function o1(t,e,n,r,i,o,s,l,a){return t=Cp(n,r,!0,t,i,o,s,l,a),t.context=i1(null),n=t.current,r=vt(),i=Dr(n),o=Jn(r,i),o.callback=e??null,_r(n,o,i),t.current.lanes=i,cl(t,i,r),bt(t,r),t}function Tu(t,e,n,r){var i=e.current,o=vt(),s=Dr(i);return n=i1(n),e.context===null?e.context=n:e.pendingContext=n,e=Jn(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=_r(i,e,s),t!==null&&(Sn(t,i,s,o),sa(t,i,s)),s}function $a(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Dm(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ep(t,e){Dm(t,e),(t=t.alternate)&&Dm(t,e)}function MT(){return null}var s1=typeof reportError=="function"?reportError:function(t){console.error(t)};function Tp(t){this._internalRoot=t}Nu.prototype.render=Tp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(O(409));Tu(t,e,null,null)};Nu.prototype.unmount=Tp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ti(function(){Tu(null,t,null,null)}),e[Qn]=null}};function Nu(t){this._internalRoot=t}Nu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Fv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vr.length&&e!==0&&e<vr[n].priority;n++);vr.splice(n,0,t),n===0&&Bv(t)}};function Np(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ku(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Pm(){}function bT(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=$a(s);o.call(u)}}var s=o1(e,r,t,0,null,!1,!1,"",Pm);return t._reactRootContainer=s,t[Qn]=s.current,zs(t.nodeType===8?t.parentNode:t),Ti(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=$a(a);l.call(u)}}var a=Cp(t,0,!1,null,null,!1,!1,"",Pm);return t._reactRootContainer=a,t[Qn]=a.current,zs(t.nodeType===8?t.parentNode:t),Ti(function(){Tu(e,a,n,r)}),a}function Au(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var l=i;i=function(){var a=$a(s);l.call(a)}}Tu(e,s,t,i)}else s=bT(n,e,t,i,r);return $a(s)}Lv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=cs(e.pendingLanes);n!==0&&(Gf(e,n|1),bt(e,Be()),!(xe&6)&&(_o=Be()+500,Wr()))}break;case 13:Ti(function(){var r=Zn(t,1);if(r!==null){var i=vt();Sn(r,t,1,i)}}),Ep(t,1)}};qf=function(t){if(t.tag===13){var e=Zn(t,134217728);if(e!==null){var n=vt();Sn(e,t,134217728,n)}Ep(t,134217728)}};Ov=function(t){if(t.tag===13){var e=Dr(t),n=Zn(t,e);if(n!==null){var r=vt();Sn(n,t,e,r)}Ep(t,e)}};Fv=function(){return Ee};Vv=function(t,e){var n=Ee;try{return Ee=t,e()}finally{Ee=n}};yd=function(t,e,n){switch(e){case"input":if(cd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=yu(r);if(!i)throw Error(O(90));mv(r),cd(r,i)}}}break;case"textarea":yv(t,n);break;case"select":e=n.value,e!=null&&fo(t,!!n.multiple,e,!1)}};Tv=vp;Nv=Ti;var _T={usingClientEntryPoint:!1,Events:[fl,to,yu,Cv,Ev,vp]},ns={findFiberByHostInstance:li,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RT={bundleType:ns.bundleType,version:ns.version,rendererPackageName:ns.rendererPackageName,rendererConfig:ns.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Iv(t),t===null?null:t.stateNode},findFiberByHostInstance:ns.findFiberByHostInstance||MT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ul=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ul.isDisabled&&Ul.supportsFiber)try{pu=Ul.inject(RT),Dn=Ul}catch{}}$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_T;$t.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Np(e))throw Error(O(200));return IT(t,e,null,n)};$t.createRoot=function(t,e){if(!Np(t))throw Error(O(299));var n=!1,r="",i=s1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Cp(t,1,!1,null,null,n,!1,r,i),t[Qn]=e.current,zs(t.nodeType===8?t.parentNode:t),new Tp(e)};$t.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(O(188)):(t=Object.keys(t).join(","),Error(O(268,t)));return t=Iv(e),t=t===null?null:t.stateNode,t};$t.flushSync=function(t){return Ti(t)};$t.hydrate=function(t,e,n){if(!ku(e))throw Error(O(200));return Au(null,t,e,!0,n)};$t.hydrateRoot=function(t,e,n){if(!Np(t))throw Error(O(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=s1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=o1(e,null,t,1,n??null,i,!1,o,s),t[Qn]=e.current,zs(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Nu(e)};$t.render=function(t,e,n){if(!ku(e))throw Error(O(200));return Au(null,t,e,!1,n)};$t.unmountComponentAtNode=function(t){if(!ku(t))throw Error(O(40));return t._reactRootContainer?(Ti(function(){Au(null,null,t,!1,function(){t._reactRootContainer=null,t[Qn]=null})}),!0):!1};$t.unstable_batchedUpdates=vp;$t.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ku(n))throw Error(O(200));if(t==null||t._reactInternals===void 0)throw Error(O(38));return Au(t,e,n,!1,r)};$t.version="18.3.1-next-f1338f8080-20240426";function l1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l1)}catch(t){console.error(t)}}l1(),lv.exports=$t;var Iu=lv.exports;const DT=K0(Iu);var Lm=Iu;rd.createRoot=Lm.createRoot,rd.hydrateRoot=Lm.hydrateRoot;var Ce=(t=>(t.AUTH="AUTH",t.HOME="HOME",t.CHAT="CHAT",t.KNOWLEDGE="KNOWLEDGE",t.SETTINGS="SETTINGS",t.AGENTS="AGENTS",t.NOTES="NOTES",t))(Ce||{}),Ne=(t=>(t.INDEXED="Indexed",t.PENDING="Pending",t.ERROR="Error",t))(Ne||{}),pe=(t=>(t.FILE="Document",t.WEBSITE="Website",t.DATABASE="Database",t.INTEGRATION="Integration",t))(pe||{}),D=(t=>(t.RAG_SEARCH="Knowledge Retrieval",t.DOC_READER="Document Reader",t.DOC_WRITER="Document Writer",t.WEB_BROWSER="Web Browser",t.DATA_ANALYSIS="Data Analysis",t.EMAIL_SENDER="Email Sender",t.NOTIFICATION="System Notification",t.GOOGLE_DRIVE="Google Drive",t.ROUTER_CONDITIONAL="Router / Logic",t.HUMAN_INTERRUPT="Human Approval",t.END_NODE="End Workflow",t.LLM_NODE="LLM / Chain Step",t))(D||{}),at=(t=>(t.ADMIN="Admin",t.EDITOR="Editor",t.VIEWER="Viewer",t))(at||{});/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PT=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),LT=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),Om=t=>{const e=LT(t);return e.charAt(0).toUpperCase()+e.slice(1)},a1=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),OT=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var FT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VT=_.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:o,iconNode:s,...l},a)=>_.createElement("svg",{ref:a,...FT,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:a1("lucide",i),...!o&&!OT(l)&&{"aria-hidden":"true"},...l},[...s.map(([u,c])=>_.createElement(u,c)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=(t,e)=>{const n=_.forwardRef(({className:r,...i},o)=>_.createElement(VT,{ref:o,iconNode:e,className:a1(`lucide-${PT(Om(t))}`,`lucide-${t}`,r),...i}));return n.displayName=Om(t),n};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BT=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],kc=J("activity",BT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UT=[["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}],["path",{d:"M10 4v4",key:"pp8u80"}],["path",{d:"M2 8h20",key:"d11cs7"}],["path",{d:"M6 4v4",key:"1svtjw"}]],kp=J("app-window",UT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],vo=J("arrow-right",zT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HT=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Ap=J("bell",HT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $T=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],GT=J("bold",$T);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qT=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],xt=J("bot",qT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Ip=J("brain-circuit",WT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jT=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]],Mp=J("chart-line",jT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],u1=J("check",JT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KT=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],c1=J("chevron-down",KT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YT=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],d1=J("chevron-left",YT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XT=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],f1=J("chevron-right",XT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QT=[["path",{d:"M10.88 21.94 15.46 14",key:"xkve6t"}],["path",{d:"M21.17 8H12",key:"19dcdn"}],["path",{d:"M3.95 6.06 8.54 14",key:"g8jz9m"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]],ZT=J("chromium",QT);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Fm=J("circle-alert",eN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],bp=J("circle-check",tN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],Mu=J("circle-stop",nN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],iN=J("circle",rN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oN=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],_p=J("clock",oN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sN=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],lN=J("cloud-upload",sN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aN=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],hl=J("cpu",aN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uN=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Ga=J("database",uN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cN=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],dN=J("download",cN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fN=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],pN=J("ellipsis",fN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hN=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],mN=J("eye-off",hN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],p1=J("eye",gN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=[["path",{d:"M20 10V8a2.4 2.4 0 0 0-.706-1.704l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.35",key:"1cdjst"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M16 14a2 2 0 0 0-2 2",key:"ceaadl"}],["path",{d:"M16 22a2 2 0 0 1-2-2",key:"1wqh5n"}],["path",{d:"M20 14a2 2 0 0 1 2 2",key:"1ny6zw"}],["path",{d:"M20 22a2 2 0 0 0 2-2",key:"1l9q4k"}]],Rp=J("file-scan",yN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],tr=J("file-text",vN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],wN=J("funnel",xN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],bu=J("git-branch",SN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],Vm=J("github",CN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Ni=J("globe",EN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],h1=J("grid-3x3",TN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],ml=J("hard-drive",NN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],Bm=J("heading-1",kN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],Um=J("heading-2",AN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],MN=J("house",IN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],_N=J("italic",bN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RN=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],DN=J("library",RN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],qa=J("list",PN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LN=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ON=J("loader-circle",LN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],VN=J("lock",FN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],zm=J("log-out",BN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UN=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],gl=J("mail",UN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zN=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],HN=J("maximize",zN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M7 11h10",key:"1twpyw"}],["path",{d:"M7 15h6",key:"d9of3u"}],["path",{d:"M7 7h8",key:"af5zfr"}]],xo=J("message-square-text",$N);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],qN=J("message-square",GN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],jN=J("mic",WN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]],KN=J("notebook",JN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],XN=J("panel-left-close",YN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],ZN=J("panel-left",QN);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ek=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],tk=J("paperclip",ek);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nk=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],Dp=J("pen-tool",nk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rk=[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M17 8a1 1 0 0 1 1 1v4a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1z",key:"1xoxul"}],["path",{d:"M9 8V2",key:"14iosj"}]],ik=J("plug",rk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],nr=J("plus",ok);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sk=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],m1=J("save",sk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lk=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Hr=J("search",lk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],g1=J("send",ak);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ys=J("settings",uk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],dk=J("share-2",ck);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fk=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Yd=J("sparkles",fk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ki=J("trash-2",pk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],mk=J("underline",hk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],_u=J("user-check",gk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Pp=J("x",yk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]],xk=J("youtube",vk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Sk=J("zap",wk);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ck=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Ek=J("zoom-in",Ck);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Nk=J("zoom-out",Tk),kk=({activeView:t,onChangeView:e,onLogout:n,user:r,sessions:i=[],agents:o=[],activeSessionId:s,onSelectSession:l,onDeleteSession:a})=>{const[u,c]=_.useState(()=>window.innerWidth<1024),p=y=>{e(y),window.innerWidth<1024&&c(!0)},m=y=>`
    flex items-center gap-3 px-3 py-3 mx-2 rounded-xl cursor-pointer transition-all duration-200 font-medium text-sm tracking-wide group relative
    ${t===y?"bg-primary-50 text-primary-900 shadow-sm":"text-slate-600 hover:bg-slate-100 hover:text-slate-900"}
    ${u?"justify-center":""}
  `,g=({text:y})=>u?h.jsx("div",{className:"absolute left-full ml-2 px-2 py-1 bg-slate-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none",children:y}):null;return h.jsxs("div",{className:`${u?"w-20":"w-72"} h-[95vh] my-auto ml-4 rounded-3xl bg-white/80 backdrop-blur-xl flex flex-col flex-shrink-0 z-20 border border-white/50 shadow-soft transition-all duration-300 ease-in-out`,children:[h.jsxs("div",{className:`h-24 flex items-center shrink-0 ${u?"justify-center":"justify-between px-6"}`,children:[!u&&h.jsxs("div",{className:"flex items-center gap-3 cursor-pointer overflow-hidden",onClick:()=>p(Ce.HOME),children:[h.jsx("div",{className:"bg-primary-600 p-2 rounded-xl shadow-lg shadow-primary-600/20 shrink-0",children:h.jsx(Ip,{className:"w-6 h-6 text-white"})}),h.jsx("span",{className:"text-xl font-medium text-slate-800 tracking-tight whitespace-nowrap",children:"OpenKB"})]}),h.jsx("button",{onClick:()=>c(!u),className:"p-2 rounded-full hover:bg-slate-100 text-slate-500 transition-colors ",title:u?"Expand Sidebar":"Collapse Sidebar",children:u?h.jsx(ZN,{size:24}):h.jsx(XN,{size:20})})]}),h.jsxs("div",{className:"flex-1 py-4 flex flex-col gap-2 overflow-y-auto custom-scrollbar overflow-x-hidden",children:[!u&&h.jsx("div",{className:"px-8 mb-2 mt-2 fade-in",children:h.jsx("span",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Workspace"})}),u&&h.jsx("div",{className:"h-4"}),h.jsxs("div",{className:m(Ce.HOME),onClick:()=>p(Ce.HOME),children:[h.jsx(MN,{size:20}),!u&&h.jsx("span",{children:"Home"}),h.jsx(g,{text:"Home"})]}),h.jsxs("div",{className:m(Ce.CHAT),onClick:()=>p(Ce.CHAT),children:[h.jsx(xo,{size:20}),!u&&h.jsx("span",{children:"Ask Agent"}),h.jsx(g,{text:"Ask Agent"})]}),h.jsxs("div",{className:m(Ce.AGENTS),onClick:()=>p(Ce.AGENTS),children:[h.jsx(xt,{size:20}),!u&&h.jsx("span",{children:"Agent Studio"}),h.jsx(g,{text:"Agent Studio"})]}),!u&&h.jsx("div",{className:"px-8 mt-6 mb-2 fade-in",children:h.jsx("span",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Management"})}),u&&h.jsx("div",{className:"border-t border-slate-100 my-4 mx-4"}),h.jsxs("div",{className:m(Ce.KNOWLEDGE),onClick:()=>p(Ce.KNOWLEDGE),children:[h.jsx(DN,{size:20}),!u&&h.jsx("span",{children:"Knowledge Base"}),h.jsx(g,{text:"Knowledge Base"})]}),h.jsxs("div",{className:m(Ce.NOTES),onClick:()=>p(Ce.NOTES),children:[h.jsx(KN,{size:20}),!u&&h.jsx("span",{children:"Notes"}),h.jsx(g,{text:"Notes"})]}),h.jsxs("div",{className:m(Ce.SETTINGS),onClick:()=>p(Ce.SETTINGS),children:[h.jsx(Ys,{size:20}),!u&&h.jsx("span",{children:"Settings"}),h.jsx(g,{text:"Settings"})]}),!u&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"px-8 mt-6 mb-2",children:h.jsx("span",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Recent Chats"})}),h.jsxs("div",{className:"space-y-4 px-3 pb-4",children:[o.map(y=>{const v=i.filter(w=>w.agentId===y.id).sort((w,x)=>new Date(x.lastModified).getTime()-new Date(w.lastModified).getTime());return v.length===0?null:h.jsxs("div",{className:"mb-2",children:[h.jsxs("div",{className:"px-5 py-1 text-xs font-bold text-slate-500 flex items-center gap-2",children:[h.jsx("div",{className:`w-2 h-2 rounded-full ${y.color}`}),y.name]}),h.jsx("div",{className:"mt-1",children:v.map(w=>h.jsxs("div",{onClick:()=>l&&l(w.id),className:`group flex items-center justify-between px-5 py-2 mx-2 rounded-lg cursor-pointer text-sm transition-colors
                                                ${s===w.id?"bg-slate-100 text-slate-900 font-medium":"text-slate-500 hover:bg-slate-50 hover:text-slate-800"}`,children:[h.jsx("span",{className:"truncate flex-1 pr-2",children:w.title}),a&&h.jsx("button",{onClick:x=>{x.stopPropagation(),a(w.id)},className:"opacity-0 group-hover:opacity-100 text-slate-400 hover:text-red-500 transition-opacity p-1",children:h.jsx(ki,{size:12})})]},w.id))})]},y.id)}),i.length===0&&h.jsx("div",{className:"px-6 py-4 text-xs text-slate-400 italic text-center",children:"No history yet."})]})]})]}),h.jsx("div",{className:"p-4 border-t border-slate-100/50 bg-white/50 rounded-b-3xl",children:r?h.jsxs("div",{className:`flex items-center gap-3 rounded-xl p-2 transition-all ${u?"justify-center":"hover:bg-slate-50"}`,children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-900 text-white flex items-center justify-center font-bold shadow-sm shrink-0",children:r.avatarUrl?h.jsx("img",{src:r.avatarUrl,alt:r.name,className:"w-full h-full rounded-full object-cover"}):r.name.charAt(0)}),!u&&h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm font-bold text-slate-900 truncate",children:r.name}),h.jsx("div",{className:"text-xs text-slate-500 truncate",children:r.email})]}),!u&&h.jsx("button",{onClick:n,className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors",title:"Sign Out",children:h.jsx(zm,{size:18})})]}):h.jsxs("button",{onClick:n,className:`flex items-center gap-3 text-slate-500 hover:bg-red-50 hover:text-red-700 transition-colors rounded-full font-medium text-sm
                ${u?"justify-center w-12 h-12 p-0":"px-6 py-3 w-full"}`,title:"Sign Out",children:[h.jsx(zm,{size:18}),!u&&h.jsx("span",{children:"Sign Out"})]})})]})},Jt=({children:t,className:e="",variant:n="primary",size:r="md",isLoading:i=!1,icon:o,disabled:s,...l})=>{const a="inline-flex items-center justify-center font-medium transition-all rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-1 disabled:opacity-50 disabled:cursor-not-allowed gap-2",u={primary:"bg-primary-600 text-white hover:bg-primary-700 shadow-lg shadow-primary-600/20 active:scale-[0.98]",secondary:"bg-primary-100 text-primary-700 hover:bg-primary-200",ghost:"bg-transparent text-slate-600 hover:bg-slate-100",danger:"bg-red-50 text-red-600 hover:bg-red-100",outline:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50"},c={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2.5 text-sm",lg:"px-6 py-3.5 text-base"};return h.jsxs("button",{className:`${a} ${u[n]} ${c[r]} ${e}`,disabled:s||i,...l,children:[i&&h.jsx(ON,{className:"w-4 h-4 animate-spin"}),!i&&o,t]})},Qt=({label:t,error:e,icon:n,className:r="",id:i,...o})=>h.jsxs("div",{className:"space-y-1.5",children:[t&&h.jsx("label",{htmlFor:i,className:"block text-sm font-medium text-slate-700 pl-1",children:t}),h.jsxs("div",{className:"relative group",children:[n&&h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400 group-focus-within:text-primary-600 transition-colors",children:n}),h.jsx("input",{id:i,className:`
            block w-full bg-slate-50 border rounded-xl 
            focus:ring-2 focus:ring-primary-500 focus:border-primary-500 
            text-slate-900 placeholder-slate-400 text-sm outline-none transition-all
            ${n?"pl-10":"px-4"} py-3
            ${e?"border-red-300 focus:ring-red-200":"border-slate-200"}
            ${r}
          `,...o})]}),e&&h.jsx("p",{className:"text-xs text-red-500 pl-1",children:e})]}),Ak=({onLogin:t})=>{const[e,n]=_.useState(!1),[r,i]=_.useState(""),[o,s]=_.useState(""),[l,a]=_.useState(!1),[u,c]=_.useState(!1),p=v=>{v.preventDefault(),m()},m=()=>{c(!0),setTimeout(()=>{t({email:r||"user@openkb.ai",name:r?r.split("@")[0]:"Demo User",plan:"Pro",joinedDate:new Date().toLocaleDateString()}),c(!1)},1e3)},g=()=>h.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[h.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),h.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),h.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),h.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),y=()=>h.jsx("svg",{className:"w-5 h-5 text-[#1877F2] fill-current",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.791-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})});return h.jsxs("div",{className:"min-h-screen bg-[#FDFBFF] flex items-center justify-center p-6 font-roboto relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-[-10%] right-[-5%] w-[500px] h-[500px] bg-primary-100 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse"}),h.jsx("div",{className:"absolute bottom-[-10%] left-[-5%] w-[500px] h-[500px] bg-purple-100 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse",style:{animationDelay:"2s"}}),h.jsxs("div",{className:"max-w-[400px] w-full bg-white/80 backdrop-blur-xl p-8 md:p-10 rounded-[32px] shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-white z-10",children:[h.jsxs("div",{className:"flex flex-col items-center mb-8",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[h.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-primary-600 to-indigo-600 rounded-[12px] flex items-center justify-center shadow-lg shadow-primary-500/20",children:h.jsx(Ip,{className:"w-5 h-5 text-white"})}),h.jsx("div",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"OpenKB"})]}),h.jsx("h2",{className:"text-xl font-medium text-slate-600 mb-2",children:e?"Create Account":"Welcome back"}),h.jsx("p",{className:"text-slate-500 text-sm text-center",children:e?"Start building intelligent agents today":"Sign in to access your workspace"})]}),h.jsxs("div",{className:"space-y-3 mb-6",children:[h.jsxs("button",{onClick:m,type:"button",className:"w-full flex items-center justify-center gap-3 py-3 px-4 bg-white border border-slate-200 rounded-[14px] hover:bg-slate-50 transition-colors shadow-sm text-sm font-medium text-slate-700",children:[h.jsx(g,{}),h.jsx("span",{children:"Continue with Google"})]}),h.jsxs("button",{onClick:m,type:"button",className:"w-full flex items-center justify-center gap-3 py-3 px-4 bg-white border border-slate-200 rounded-[14px] hover:bg-slate-50 transition-colors shadow-sm text-sm font-medium text-slate-700",children:[h.jsx(y,{}),h.jsx("span",{children:"Continue with Facebook"})]})]}),h.jsxs("div",{className:"relative flex items-center justify-center mb-6",children:[h.jsx("div",{className:"absolute inset-0 flex items-center",children:h.jsx("div",{className:"w-full border-t border-slate-200"})}),h.jsx("span",{className:"relative bg-white px-3 text-xs text-slate-400 uppercase tracking-wider font-medium",children:"Or continue with"})]}),h.jsxs("form",{onSubmit:p,className:"space-y-5",children:[h.jsx(Qt,{type:"email",required:!0,value:r,onChange:v=>i(v.target.value),placeholder:"Email Address",icon:h.jsx(gl,{className:"h-5 w-5"})}),h.jsxs("div",{className:"relative",children:[h.jsx(Qt,{type:l?"text":"password",required:!0,value:o,onChange:v=>s(v.target.value),placeholder:"Password",icon:h.jsx(VN,{className:"h-5 w-5"})}),h.jsx("button",{type:"button",onClick:()=>a(!l),className:"absolute top-3.5 right-3 text-slate-400 hover:text-slate-600 focus:outline-none z-10",children:l?h.jsx(mN,{size:18}):h.jsx(p1,{size:18})})]}),h.jsx(Jt,{type:"submit",disabled:u,className:"w-full",size:"lg",isLoading:u,icon:e?void 0:h.jsx(vo,{className:"w-4 h-4 ml-2"}),children:e?"Create Account":"Sign In"})]}),h.jsx("div",{className:"mt-8 text-center",children:h.jsxs("p",{className:"text-sm text-slate-500",children:[e?"Already have an account?":"Don't have an account?"," ",h.jsx("button",{onClick:()=>n(!e),className:"text-primary-600 hover:text-primary-700 font-semibold transition-colors focus:outline-none",children:e?"Sign in":"Sign up"})]})})]}),h.jsx("div",{className:"absolute bottom-6 text-center w-full",children:h.jsx("p",{className:"text-xs text-slate-400",children:" 2024 OpenKB. Secure & Open Source."})})]})},rs=({children:t,className:e="",onClick:n,hoverEffect:r=!1})=>h.jsx("div",{onClick:n,className:`
                bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden
                ${r?"transition-all duration-300 hover:shadow-glow hover:border-primary-300 cursor-pointer":""}
                ${e}
            `,children:t}),Wa=({isOpen:t,onClose:e,children:n,title:r,className:i=""})=>(_.useEffect(()=>{const o=s=>{s.key==="Escape"&&e()};return t&&document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)},[t,e]),t?Iu.createPortal(h.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:h.jsxs("div",{className:`bg-[#FDFBFF] w-full max-w-4xl max-h-[90vh] rounded-[28px] shadow-2xl flex flex-col overflow-hidden animate-in zoom-in-95 duration-200 border border-white/20 ring-1 ring-black/5 ${i}`,onClick:o=>o.stopPropagation(),children:[r&&h.jsxs("div",{className:"flex justify-between items-center px-8 py-6 border-b border-slate-100 bg-white/50",children:[h.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:r}),h.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-100 rounded-full text-slate-400 hover:text-slate-600 transition-colors",children:h.jsx(Pp,{size:24})})]}),h.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar",children:n})]})}),document.body):null),Ts=({children:t,variant:e="default",className:n=""})=>{const r={default:"bg-slate-100 text-slate-600 border border-slate-200",success:"bg-emerald-50 text-emerald-700 border border-emerald-100",warning:"bg-amber-50 text-amber-700 border border-amber-100",error:"bg-red-50 text-red-700 border border-red-100",outline:"bg-transparent border border-slate-200 text-slate-500"};return h.jsx("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-bold ${r[e]} ${n}`,children:t})},Lp=({label:t,error:e,icon:n,options:r,className:i="",...o})=>h.jsxs("div",{className:`flex flex-col gap-1.5 ${i}`,children:[t&&h.jsx("label",{className:"text-sm font-medium text-slate-700 ml-1",children:t}),h.jsxs("div",{className:"relative",children:[n&&h.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",children:n}),h.jsx("select",{className:`
                        w-full bg-white border border-slate-300 text-slate-900 text-sm rounded-[12px] 
                        focus:ring-2 focus:ring-primary-500 focus:border-primary-500 block p-3 appearance-none
                        disabled:bg-slate-50 disabled:text-slate-500
                        ${n?"pl-10":"pl-4"}
                        ${e?"border-red-500 focus:ring-red-200":""}
                    `,...o,children:r.map(s=>h.jsx("option",{value:s.value,children:s.label},s.value))}),h.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",children:h.jsx(c1,{size:16})})]}),e&&h.jsx("span",{className:"text-xs text-red-500 ml-1",children:e})]}),Pi=({children:t,className:e="",isFullWidth:n=!1,scrollable:r=!0})=>h.jsx("div",{className:`flex-1 ${r?"overflow-y-auto":"overflow-hidden flex flex-col"} custom-scrollbar bg-slate-25 p-6 md:p-8 ${e}`,children:h.jsx("div",{className:`mx-auto w-full ${n?"":"max-w-7xl"} ${r?"space-y-8":"h-full flex flex-col"} transition-all duration-300`,children:t})}),Cn=({children:t,className:e="",noPadding:n=!1})=>h.jsx("div",{className:`bg-white/60 backdrop-blur-xl rounded-3xl border border-white/60 shadow-soft overflow-hidden ${n?"":"p-6 md:p-8"} ${e}`,children:t}),Ik=t=>{switch(t){case pe.FILE:return tr;case pe.WEBSITE:return Ni;case pe.DATABASE:return Ga;case pe.INTEGRATION:return kp;default:return tr}},Mk=({assets:t,onAddAsset:e,onRemoveAsset:n,onToggleAssetStatus:r})=>{const i=_.useRef(null),[o,s]=_.useState(pe.FILE),[l,a]=_.useState(!1),[u,c]=_.useState(null),[p,m]=_.useState(""),[g,y]=_.useState(1),v=5,[w,x]=_.useState(null),[E,C]=_.useState(""),[S,N]=_.useState(!1),[T,k]=_.useState(""),[I,R]=_.useState({host:"",type:"PostgreSQL",database:""}),[M,q]=_.useState(""),$=t.filter(V=>{const dn=V.type===o,qt=V.name.toLowerCase().includes(p.toLowerCase())||V.details.toLowerCase().includes(p.toLowerCase());return dn&&qt}),F=Math.ceil($.length/v),z=$.slice((g-1)*v,g*v),ie=V=>{V>=1&&V<=F&&y(V)};Se.useEffect(()=>{y(1)},[o,p]);const Y=V=>{V.target.files&&V.target.files[0]&&se(V.target.files[0])},se=V=>{e({name:V.name,type:pe.FILE,details:(V.size/1024).toFixed(1)+" KB",status:Ne.PENDING})},L=V=>{V.preventDefault(),V.stopPropagation(),V.type==="dragenter"||V.type==="dragover"?a(!0):V.type==="dragleave"&&a(!1)},X=V=>{V.preventDefault(),V.stopPropagation(),a(!1),V.dataTransfer.files&&V.dataTransfer.files[0]&&se(V.dataTransfer.files[0])},Z=()=>{T&&(e({name:T,type:pe.WEBSITE,details:"Pending Crawl",status:Ne.PENDING}),k(""))},oe=()=>{!I.host||!I.database||(e({name:`${I.type} - ${I.database}`,type:pe.DATABASE,details:I.host,status:Ne.PENDING}),R({host:"",type:"PostgreSQL",database:""}))},te=V=>{x(V),C("")},he=V=>{V.preventDefault(),!(!w||!E)&&(N(!0),setTimeout(()=>{e({name:`${w} - ${E}`,type:pe.INTEGRATION,details:`Connected Account (${w})`,status:Ne.INDEXED}),N(!1),x(null)},1e3))},ce=()=>{M&&(e({name:`YouTube Video: ${M}`,type:pe.INTEGRATION,details:"Video Transcript",status:Ne.PENDING}),q(""))},be=V=>{switch(V){case Ne.INDEXED:return h.jsxs(Ts,{variant:"success",children:[h.jsx(bp,{size:12})," Ready"]});case Ne.PENDING:return h.jsxs(Ts,{variant:"warning",children:[h.jsx(_p,{size:12})," Indexing"]});default:return h.jsxs(Ts,{variant:"error",children:[h.jsx(Fm,{size:12})," Error"]})}},Le=()=>h.jsxs(Wa,{isOpen:!!u,onClose:()=>c(null),title:u==null?void 0:u.name,className:"max-w-3xl",children:[h.jsxs("div",{className:"bg-slate-50/50 px-8 py-2 border-b border-slate-100 flex items-center gap-2 text-xs text-slate-500 mb-6 -mx-8 -mt-2",children:[h.jsx("span",{className:"font-bold uppercase tracking-wider",children:u==null?void 0:u.type}),h.jsx("span",{children:""}),h.jsx("span",{children:u==null?void 0:u.details}),h.jsx("span",{children:""}),h.jsx("span",{children:u==null?void 0:u.dateIndexed})]}),h.jsxs("div",{className:"prose prose-slate max-w-none",children:[h.jsx("h4",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mb-4",children:"Content Preview"}),h.jsxs("p",{className:"text-slate-600 leading-relaxed",children:["[Preview of ",u==null?void 0:u.name,"]",h.jsx("br",{}),h.jsx("br",{}),"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",h.jsx("br",{}),h.jsx("br",{}),"Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."]}),h.jsx("div",{className:"mt-8 p-4 bg-slate-50 rounded-xl border border-slate-100 text-center text-sm text-slate-500 italic",children:"This is a simulated preview of the indexed content."})]}),h.jsxs("div",{className:"mt-8 flex justify-end gap-3 pt-4 border-t border-slate-100",children:[h.jsx(Jt,{variant:"ghost",onClick:()=>c(null),children:"Close"}),h.jsx(Jt,{variant:"primary",icon:h.jsx(dN,{size:16}),children:"Download"})]})]}),ot=()=>h.jsx(Wa,{isOpen:!!w,onClose:()=>x(null),title:`Connect ${w}`,className:"max-w-md",children:h.jsx("div",{className:"p-6",children:h.jsxs("form",{onSubmit:he,children:[h.jsxs("div",{className:"mb-6",children:[h.jsx(Qt,{label:"Account Email / ID",required:!0,placeholder:"name@example.com",value:E,onChange:V=>C(V.target.value),autoFocus:!0}),h.jsx("p",{className:"text-xs text-slate-500 mt-2 pl-1",children:"We will redirect you to authenticate securely."})]}),h.jsx(Jt,{type:"submit",variant:"primary",className:"w-full",isLoading:S,disabled:S,children:S?"Authenticating...":"Authorize Access"})]})})});return h.jsxs(Pi,{children:[h.jsxs("div",{className:"space-y-6",children:[h.jsx("div",{className:"flex justify-between items-end mb-2",children:h.jsxs("div",{children:[h.jsx("h1",{className:"text-4xl font-normal text-slate-900 tracking-tight mb-2",children:"Knowledge Base"}),h.jsx("p",{className:"text-slate-500 text-lg",children:"Manage data sources and integrations for your OpenKB agent."})]})}),h.jsxs(Cn,{noPadding:!0,className:"overflow-hidden",children:[h.jsx("div",{className:"flex border-b border-white/50 overflow-x-auto p-1.5 gap-1 bg-white/40",children:[{type:pe.FILE,icon:tr,label:"Documents"},{type:pe.WEBSITE,icon:Ni,label:"Web Resources"},{type:pe.DATABASE,icon:Ga,label:"Databases"},{type:pe.INTEGRATION,icon:kp,label:"Apps & Integrations"}].map(V=>h.jsxs("button",{onClick:()=>s(V.type),className:`flex-1 min-w-[140px] flex items-center justify-center gap-2 py-3.5 text-sm font-bold transition-all rounded-[24px]
                  ${o===V.type?"text-slate-900 bg-white shadow-sm border border-slate-100/50":"text-slate-500 hover:text-slate-700 hover:bg-white/40"}`,children:[h.jsx(V.icon,{size:18}),V.label]},V.type))}),h.jsxs("div",{className:"p-8 bg-transparent",children:[o===pe.FILE&&h.jsxs("div",{onClick:()=>{var V;return(V=i.current)==null?void 0:V.click()},className:`border-2 border-dashed rounded-[24px] p-12 flex flex-col items-center justify-center transition-all cursor-pointer group bg-white/40 backdrop-blur-sm
                  ${l?"border-primary-500 bg-primary-50/50":"border-slate-300/60 hover:border-primary-400 hover:bg-white/60"}`,onDragEnter:L,onDragLeave:L,onDragOver:L,onDrop:X,children:[h.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mb-4 group-hover:bg-primary-100 transition-colors",children:h.jsx(lN,{className:"w-8 h-8 text-primary-600"})}),h.jsx("p",{className:"text-slate-900 font-medium text-lg",children:"Click or drag files to upload"}),h.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"PDF, DOCX, TXT, XLSX (Max 20MB)"}),h.jsx("input",{ref:i,type:"file",className:"hidden",onChange:Y,accept:".pdf,.docx,.txt,.xlsx"})]}),o===pe.WEBSITE&&h.jsxs(rs,{className:"p-8 bg-white/40 backdrop-blur-md border-white/60 shadow-none",children:[h.jsxs("div",{className:"flex gap-3 items-end",children:[h.jsx("div",{className:"flex-1",children:h.jsx(Qt,{label:"Add Website URL",placeholder:"https://docs.example.com",value:T,onChange:V=>k(V.target.value),icon:h.jsx(Ni,{className:"h-5 w-5 text-slate-400"})})}),h.jsx(Jt,{onClick:Z,variant:"primary",icon:h.jsx(nr,{size:18}),className:"mb-0.5 h-[46px]",children:"Add Source"})]}),h.jsxs("p",{className:"text-xs text-slate-500 mt-3 pl-1 flex items-center gap-1",children:[h.jsx(Fm,{size:12})," The agent will crawl and index pages from this domain recursively."]})]}),o===pe.DATABASE&&h.jsxs(rs,{className:"p-8 bg-white/40 backdrop-blur-md border-white/60 shadow-none",children:[h.jsxs("h3",{className:"text-lg font-medium text-slate-900 mb-6 flex items-center gap-2",children:[h.jsx(Ga,{size:20,className:"text-primary-600"})," New Database Connection"]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[h.jsx("div",{children:h.jsx(Lp,{label:"Type",value:I.type,onChange:V=>R({...I,type:V.target.value}),options:["PostgreSQL","MySQL","MongoDB","Snowflake"].map(V=>({value:V,label:V}))})}),h.jsx("div",{children:h.jsx(Qt,{label:"Host",placeholder:"db.example.com",value:I.host,onChange:V=>R({...I,host:V.target.value})})}),h.jsx("div",{className:"md:col-span-2",children:h.jsx(Qt,{label:"Database Name",placeholder:"production_db",value:I.database,onChange:V=>R({...I,database:V.target.value})})})]}),h.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-100",children:h.jsx(Jt,{onClick:oe,variant:"primary",icon:h.jsx(ik,{size:18}),className:"px-8",children:"Connect Database"})})]}),o===pe.INTEGRATION&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[h.jsxs(rs,{className:"p-6 flex flex-col items-center text-center hover:shadow-xl hover:scale-[1.02] transition-all duration-300 group bg-white/40 backdrop-blur-md border-white/60",children:[h.jsx("div",{className:"w-16 h-16 bg-white rounded-[22px] flex items-center justify-center mb-5 text-primary-600 shadow-md group-hover:scale-110 transition-transform",children:h.jsx(ml,{size:32})}),h.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"Google Drive"}),h.jsx("p",{className:"text-sm text-slate-500 mb-6 font-medium",children:"Connect docs, sheets, and slides."}),h.jsx(Jt,{onClick:()=>te("Google Drive"),variant:"ghost",className:"mt-auto w-full border border-white/50 bg-white/50 hover:bg-white text-primary-700 shadow-sm",children:"Connect"})]}),h.jsxs(rs,{className:"p-6 flex flex-col items-center text-center hover:shadow-xl hover:scale-[1.02] transition-all duration-300 group bg-white/40 backdrop-blur-md border-white/60",children:[h.jsx("div",{className:"w-16 h-16 bg-white rounded-[22px] flex items-center justify-center mb-5 text-red-600 shadow-md group-hover:scale-110 transition-transform",children:h.jsx(gl,{size:32})}),h.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"Gmail"}),h.jsx("p",{className:"text-sm text-slate-500 mb-6 font-medium",children:"Index emails and threads."}),h.jsx(Jt,{onClick:()=>te("Gmail"),variant:"ghost",className:"mt-auto w-full border border-white/50 bg-white/50 hover:bg-white text-red-700 shadow-sm",children:"Connect"})]}),h.jsxs(rs,{className:"p-6 flex flex-col items-center text-center hover:shadow-xl hover:scale-[1.02] transition-all duration-300 group bg-white/40 backdrop-blur-md border-white/60",children:[h.jsx("div",{className:"w-16 h-16 bg-white rounded-[22px] flex items-center justify-center mb-5 text-red-600 shadow-md group-hover:scale-110 transition-transform",children:h.jsx(xk,{size:32})}),h.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"YouTube"}),h.jsx("p",{className:"text-sm text-slate-500 mb-6 font-medium",children:"Transcribe and index videos."}),h.jsxs("div",{className:"w-full mt-auto space-y-3",children:[h.jsx(Qt,{placeholder:"Video URL...",value:M,onChange:V=>q(V.target.value),className:"bg-white/50 border-white/50 focus:bg-white"}),h.jsx(Jt,{onClick:ce,disabled:!M,variant:"primary",className:"w-full bg-red-600 hover:bg-red-700 border-none shadow-lg shadow-red-600/20",children:"Add Video"})]})]})]})]})]}),h.jsxs(Cn,{noPadding:!0,className:"overflow-hidden",children:[h.jsxs("div",{className:"p-6 border-b border-white/50 flex flex-col md:flex-row justify-between items-center gap-4 bg-white/30",children:[h.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:["Indexed Assets ",h.jsx("span",{className:"bg-white text-primary-600 border border-primary-100 text-xs font-bold px-2.5 py-1 rounded-full shadow-sm",children:$.length})]}),h.jsxs("div",{className:"relative w-full md:w-80",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(Hr,{className:"h-4 w-4 text-slate-400"})}),h.jsx("input",{type:"text",value:p,onChange:V=>m(V.target.value),placeholder:"Search assets...",className:"block w-full pl-10 pr-4 py-2.5 bg-white/50 border border-white/50 rounded-full text-sm focus:ring-2 focus:ring-primary-500 text-slate-900 placeholder-slate-400 transition-all font-medium"})]})]}),h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left text-sm",children:[h.jsx("thead",{className:"bg-white/50 text-slate-400 uppercase tracking-wider font-bold text-[11px] border-b border-white/50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-8 py-5",children:"Name"}),h.jsx("th",{className:"px-8 py-5",children:"Type / Details"}),h.jsx("th",{className:"px-8 py-5",children:"Status"}),h.jsx("th",{className:"px-8 py-5",children:"Active"}),h.jsx("th",{className:"px-8 py-5 text-right",children:"Actions"})]})}),h.jsxs("tbody",{className:"divide-y divide-white/50",children:[z.map(V=>h.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[h.jsxs("td",{className:"px-8 py-5",children:[h.jsx("div",{className:"font-bold text-slate-900 text-base mb-0.5",children:V.name}),h.jsx("div",{className:"text-xs text-slate-400",children:V.dateIndexed})]}),h.jsx("td",{className:"px-8 py-5",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"p-1.5 bg-slate-100 rounded-md text-slate-500",children:Se.createElement(Ik(V.type),{size:14})}),h.jsx("span",{className:"text-slate-600 font-medium",children:V.details})]})}),h.jsx("td",{className:"px-8 py-5",children:be(V.status)}),h.jsx("td",{className:"px-8 py-5",children:h.jsx("button",{onClick:()=>r(V.id),className:`relative w-11 h-6 rounded-full transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500
                             ${V.isActive?"bg-primary-600":"bg-slate-200"}`,children:h.jsx("span",{className:`absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 ease-in-out
                                ${V.isActive?"translate-x-5":"translate-x-0"}`})})}),h.jsx("td",{className:"px-8 py-5 text-right",children:h.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:()=>c(V),className:"text-slate-400 hover:text-primary-600 p-2 rounded-full hover:bg-primary-50 transition-colors",title:"Preview",children:h.jsx(p1,{size:18})}),h.jsx("button",{onClick:()=>n(V.id),className:"text-slate-400 hover:text-red-500 p-2 rounded-full hover:bg-red-50 transition-colors",title:"Delete",children:h.jsx(ki,{size:18})})]})})]},V.id)),z.length===0&&h.jsx("tr",{children:h.jsx("td",{colSpan:5,className:"px-8 py-12 text-center text-slate-400",children:h.jsxs("div",{className:"flex flex-col items-center justify-center",children:[h.jsx(Hr,{size:32,className:"mb-3 text-slate-200"}),h.jsx("p",{children:"No assets found."})]})})})]})]})}),F>1&&h.jsx("div",{className:"px-8 py-5 border-t border-slate-100 flex items-center justify-center bg-white",children:h.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 p-1.5 rounded-full border border-slate-100",children:[h.jsx("button",{onClick:()=>ie(g-1),disabled:g===1,className:"w-9 h-9 flex items-center justify-center rounded-full hover:bg-white hover:shadow-sm text-slate-500 disabled:opacity-30 disabled:hover:bg-transparent disabled:hover:shadow-none transition-all",children:h.jsx(d1,{size:18})}),h.jsxs("span",{className:"text-sm font-bold text-slate-700 px-4",children:[g," ",h.jsx("span",{className:"text-slate-400 font-normal",children:"/"})," ",F]}),h.jsx("button",{onClick:()=>ie(g+1),disabled:g===F,className:"w-9 h-9 flex items-center justify-center rounded-full hover:bg-white hover:shadow-sm text-slate-500 disabled:opacity-30 disabled:hover:bg-transparent disabled:hover:shadow-none transition-all",children:h.jsx(f1,{size:18})})]})})]})]}),h.jsx(Le,{}),h.jsx(ot,{})]})},bk=({messages:t,onSendMessage:e,isThinking:n,agents:r,activeAgentId:i,onAgentChange:o,onNewChat:s,sessionTitle:l})=>{const[a,u]=_.useState(""),[c,p]=_.useState(!1),m=_.useRef(null),g=_.useRef(null),y=_.useRef(null),v=r.find(T=>T.id===i)||r[0],w=()=>{var T;(T=m.current)==null||T.scrollIntoView({behavior:"smooth"})};_.useEffect(()=>{w()},[t,n]),_.useEffect(()=>{const T=k=>{g.current&&!g.current.contains(k.target)&&p(!1)};return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[]);const x=()=>{a.trim()&&(e(a),u(""))},E=T=>{T.key==="Enter"&&!T.shiftKey&&(T.preventDefault(),x())},C=()=>{var T;(T=y.current)==null||T.click()},S=T=>{T.target.files&&T.target.files.length>0&&alert(`Attached: ${T.target.files[0].name}`)},N=()=>{alert("Voice input is not configured in this demo.")};return h.jsx(Pi,{scrollable:!1,children:h.jsxs(Cn,{className:"flex flex-col h-full p-0 overflow-hidden",noPadding:!0,children:[h.jsxs("div",{className:"h-20 flex items-center justify-between px-6 md:px-8 border-b border-white/50 bg-white/40 shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:`w-12 h-12 rounded-[16px] flex items-center justify-center text-white shadow-lg shadow-purple-900/10 ${v.color}`,children:h.jsx(xt,{size:24})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800 leading-tight flex items-center gap-2 tracking-tight",children:l||v.name}),h.jsx("div",{className:"text-sm font-medium text-slate-500",children:v.role})]})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(Jt,{onClick:s,variant:"ghost",icon:h.jsx(nr,{size:20}),className:"hidden md:flex bg-white/50 hover:bg-white border-white/50 shadow-sm",children:"New Chat"}),h.jsxs("div",{className:"relative",ref:g,children:[h.jsxs("button",{onClick:()=>p(!c),className:"flex items-center gap-3 bg-white/50 hover:bg-white transition-all px-4 py-2 rounded-2xl cursor-pointer border border-white/60 shadow-sm hover:shadow-md",children:[h.jsxs("div",{className:"flex flex-col items-end hidden md:flex",children:[h.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Persona"}),h.jsx("span",{className:"text-sm font-bold text-slate-800",children:v.name})]}),h.jsx("div",{className:`transition-transform duration-200 ${c?"rotate-180":""}`,children:h.jsx(c1,{size:18,className:"text-slate-500"})})]}),c&&h.jsxs("div",{className:"absolute top-full right-0 mt-3 w-80 bg-white/80 backdrop-blur-xl rounded-[24px] shadow-2xl shadow-purple-900/10 border border-white/60 py-2 z-50 animate-in fade-in zoom-in-95 slide-in-from-top-2 duration-200 overflow-hidden ring-1 ring-black/5",children:[h.jsx("div",{className:"px-5 py-3 border-b border-slate-100/50",children:h.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Switch Persona"})}),h.jsx("div",{className:"max-h-80 overflow-y-auto py-2 custom-scrollbar p-2",children:r.map(T=>h.jsxs("button",{onClick:()=>{o(T.id),p(!1)},className:`w-full text-left px-3 py-3 rounded-xl flex items-center gap-4 hover:bg-white/60 transition-all group
                                   ${i===T.id?"bg-primary-50/80 border border-primary-100/50":"border border-transparent"}`,children:[h.jsx("div",{className:`w-10 h-10 rounded-[12px] flex items-center justify-center text-white text-xs shadow-md shadow-purple-900/5 ${T.color} group-hover:scale-105 transition-transform`,children:h.jsx(xt,{size:18})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:`font-bold text-base ${i===T.id?"text-primary-700":"text-slate-800"}`,children:T.name}),h.jsx("div",{className:"text-xs text-slate-500 truncate font-medium",children:T.role})]}),i===T.id&&h.jsx("div",{className:"bg-primary-600 text-white p-1 rounded-full",children:h.jsx(u1,{size:12})})]},T.id))})]})]})]})]}),h.jsx("div",{className:"flex-1 overflow-y-auto px-4 md:px-8 py-6 space-y-6 custom-scrollbar scroll-smooth bg-white/30",children:h.jsxs("div",{className:"max-w-3xl mx-auto space-y-8 pb-4",children:[t.length===0&&h.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-80",children:[h.jsx("div",{className:`w-20 h-20 rounded-[28px] flex items-center justify-center mb-6 text-white shadow-xl ${v.color}`,children:h.jsx(Yd,{size:40})}),h.jsxs("h3",{className:"text-2xl font-normal text-slate-800 mb-3",children:["Hi there, I'm ",v.name]}),h.jsxs("p",{className:"text-slate-500 text-center max-w-md leading-relaxed mb-8",children:[v.systemInstructions.slice(0,150),"..."]}),v.tools&&v.tools.length>0&&h.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:v.tools.map(T=>h.jsx(Ts,{variant:"outline",className:"bg-white/60",children:T},T))})]}),t.map(T=>h.jsx("div",{className:`flex w-full ${T.role==="user"?"justify-end":"justify-start"}`,children:h.jsxs("div",{className:`flex max-w-[85%] md:max-w-[75%] gap-4 ${T.role==="user"?"flex-row-reverse":"flex-row group"}`,children:[T.role==="model"&&h.jsx("div",{className:`w-10 h-10 rounded-[14px] flex-shrink-0 flex items-center justify-center text-white shadow-md ${v.color} opacity-0 group-hover:opacity-100 transition-opacity`,children:h.jsx(xt,{size:20})}),h.jsxs("div",{className:`flex flex-col gap-1 ${T.role==="user"?"items-end":"items-start"}`,children:[h.jsx("div",{className:`px-6 py-4 text-base leading-7 whitespace-pre-wrap shadow-sm backdrop-blur-sm
                        ${T.role==="user"?"bg-slate-900 text-white rounded-[24px] rounded-tr-sm shadow-xl shadow-slate-900/10":"bg-white/80 border border-white/60 text-slate-800 rounded-[24px] rounded-tl-sm shadow-[0_4px_20px_rgb(0,0,0,0.03)]"}`,children:T.content}),T.role==="model"&&T.sources&&T.sources.length>0&&h.jsxs("div",{className:"mt-3 ml-2",children:[h.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest pl-1 mb-2 block",children:"Sources"}),h.jsx("div",{className:"flex flex-wrap gap-2",children:T.sources.map(k=>h.jsx("div",{className:"cursor-pointer",children:h.jsxs("div",{className:"bg-white/50 hover:bg-white border border-white/60 hover:border-white/80 rounded-xl py-2 pl-3 pr-4 flex items-center gap-2 transition-all shadow-sm hover:shadow-md",children:[h.jsx(tr,{size:14,className:"text-primary-600"}),h.jsx("span",{className:"truncate max-w-[150px] text-xs font-bold text-slate-600",children:k.title})]})},k.id))})]})]})]})},T.id)),n&&h.jsx("div",{className:"flex w-full justify-start items-center gap-4 pl-14",children:h.jsx("div",{className:"flex gap-4 flex-row",children:h.jsxs("div",{className:"bg-white/60 backdrop-blur-md px-6 py-4 rounded-[24px] rounded-tl-sm flex items-center gap-2 border border-white/50 shadow-sm",children:[h.jsx("div",{className:"w-2.5 h-2.5 bg-primary-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),h.jsx("div",{className:"w-2.5 h-2.5 bg-indigo-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),h.jsx("div",{className:"w-2.5 h-2.5 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),h.jsx("div",{ref:m})]})}),h.jsxs("div",{className:"p-6 md:p-8 bg-white/40 border-t border-white/50 shrink-0",children:[h.jsxs("div",{className:"max-w-3xl mx-auto relative flex items-end gap-2 bg-white/70 backdrop-blur-xl rounded-[32px] p-2 pr-2 border border-white/80 transition-all focus-within:bg-white/90 focus-within:shadow-[0_8px_30px_rgb(0,0,0,0.08)] focus-within:border-primary-200/50 shadow-lg shadow-purple-900/5 ring-1 ring-white/50",children:[h.jsx("button",{onClick:C,className:"p-3.5 text-slate-400 hover:text-primary-600 hover:bg-primary-50 rounded-full transition-all mb-1 ml-1",title:"Attach file",children:h.jsx(tk,{size:22})}),h.jsx("input",{type:"file",ref:y,className:"hidden",onChange:S}),h.jsx("textarea",{value:a,onChange:T=>u(T.target.value),onKeyDown:E,placeholder:`Message ${v.name}...`,className:"w-full py-4 bg-transparent border-none outline-none focus:ring-0 resize-none h-[64px] max-h-[200px] text-slate-700 placeholder-slate-400 scrollbar-hide text-lg font-medium",style:{minHeight:"64px"}}),h.jsx("button",{onClick:N,className:"p-3.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-full transition-all mb-1",title:"Voice Input",children:h.jsx(jN,{size:22})}),h.jsx("button",{onClick:x,disabled:!a.trim()||n,className:`w-14 h-14 flex-shrink-0 flex items-center justify-center rounded-[24px] transition-all duration-300 mb-0.5
                ${!a.trim()||n?"bg-slate-100 text-slate-300 cursor-not-allowed":"bg-slate-900 text-white hover:bg-primary-600 shadow-xl shadow-slate-900/20 hover:shadow-primary-600/30 hover:scale-105 active:scale-95"}`,children:h.jsx(g1,{size:24,className:a.trim()?"ml-1":""})})]}),h.jsx("div",{className:"text-center mt-4",children:h.jsx("p",{className:"text-[10px] font-bold text-slate-300 uppercase tracking-widest",children:"OpenKB v2.0  Gemini 1.5 Pro"})})]})]})})},_k={"Google Gemini":["gemini-1.5-pro","gemini-1.5-flash","gemini-1.0-pro"],OpenAI:["gpt-4o","gpt-4-turbo","gpt-3.5-turbo"],Anthropic:["claude-3-opus","claude-3-sonnet","claude-3-haiku"],"Mistral AI":["mistral-large","mistral-medium","mistral-small"],"Local (Ollama)":["llama3","mistral","gemma","phi3"]},Rk=({user:t,onUpdateUser:e})=>{const[n,r]=_.useState(t.name),[i,o]=_.useState(t.email),[s,l]=_.useState(""),[a,u]=_.useState(!1),[c,p]=_.useState([{id:"1",name:"Primary Gemini",provider:"Google Gemini",modelId:"gemini-1.5-pro",apiKeyPreview:"AIzaSy...",lastUsed:"Just now"},{id:"2",name:"Backup GPT",provider:"OpenAI",modelId:"gpt-4-turbo",apiKeyPreview:"sk-proj...",lastUsed:"2 days ago"}]),[m,g]=_.useState(!1),[y,v]=_.useState({provider:"Google Gemini",name:"",apiKey:"",modelId:"gemini-1.5-pro"}),w=()=>{e({name:n,email:i}),u(!0),setTimeout(()=>u(!1),2e3)},x=C=>{p(S=>S.filter(N=>N.id!==C))},E=C=>{C.preventDefault();const S={id:Date.now().toString(),name:y.name||`${y.provider} Connection`,provider:y.provider,modelId:y.modelId,apiKeyPreview:y.apiKey.substring(0,6)+"...",lastUsed:"Never"};p([...c,S]),g(!1),v({provider:"Google Gemini",name:"",apiKey:"",modelId:"gemini-1.5-pro"})};return h.jsxs(Pi,{children:[h.jsxs("div",{className:"space-y-8",children:[h.jsx("div",{className:"flex justify-between items-end",children:h.jsxs("div",{children:[h.jsx("h1",{className:"text-4xl font-normal text-slate-900 tracking-tight mb-2",children:"Settings"}),h.jsx("p",{className:"text-slate-500 text-lg",children:"Manage your account preferences and AI model connections."})]})}),h.jsxs(Cn,{children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"w-20 h-20 rounded-full bg-primary-100 flex items-center justify-center text-primary-600 border-4 border-slate-50 text-2xl font-bold shadow-sm",children:t.avatarUrl?h.jsx("img",{src:t.avatarUrl,className:"w-full h-full rounded-full object-cover"}):n.charAt(0)}),h.jsx("button",{className:"absolute bottom-0 right-0 p-1.5 bg-slate-900 text-white rounded-full hover:bg-primary-600 transition-colors shadow-sm",children:h.jsx(nr,{size:14})})]}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-medium text-slate-900",children:"Personal Profile"}),h.jsx("p",{className:"text-sm text-slate-500",children:"Update your photo and personal details."})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsx("div",{children:h.jsx(Qt,{label:"Full Name",value:n,onChange:C=>r(C.target.value)})}),h.jsx("div",{children:h.jsx(Qt,{label:"Email Address",value:i,onChange:C=>o(C.target.value),type:"email"})}),h.jsx("div",{children:h.jsx(Qt,{label:"New Password",type:"password",placeholder:"Leave blank to keep current",value:s,onChange:C=>l(C.target.value)})})]}),h.jsx("div",{className:"mt-8 pt-6 border-t border-slate-100 flex justify-end",children:h.jsx(Jt,{onClick:w,variant:a?"success":"primary",icon:a?h.jsx(bp,{size:18}):h.jsx(m1,{size:18}),className:"px-8",children:a?"Saved!":"Save Changes"})})]}),h.jsxs(Cn,{children:[h.jsxs("div",{className:"flex justify-between items-start mb-8",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center text-orange-600",children:h.jsx(hl,{size:24})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-medium text-slate-900",children:"Connected Models"}),h.jsx("p",{className:"text-sm text-slate-500",children:"Manage your LLM connections."})]})]}),h.jsxs("button",{onClick:()=>g(!0),className:"px-5 py-2.5 bg-slate-900 text-white rounded-full text-sm font-medium hover:bg-slate-800 transition-colors shadow-sm flex items-center gap-2",children:[h.jsx(nr,{size:16})," Add Model"]})]}),h.jsx("div",{className:"space-y-4",children:c.map(C=>h.jsxs("div",{className:"flex items-center justify-between p-5 rounded-[16px] border border-slate-200 hover:border-primary-300 hover:shadow-sm transition-all bg-slate-50/50",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-xl bg-white border border-slate-200 flex items-center justify-center font-bold text-slate-700 text-xs shadow-sm",children:C.provider.slice(0,2).toUpperCase()}),h.jsxs("div",{children:[h.jsx("div",{className:"font-bold text-slate-900",children:C.name}),h.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 mt-0.5",children:[h.jsx("span",{className:"bg-white border border-slate-200 px-1.5 py-0.5 rounded-md",children:C.provider}),h.jsx("span",{children:""}),h.jsx("span",{children:C.modelId}),h.jsx("span",{children:""}),h.jsxs("span",{children:["Last used: ",C.lastUsed]})]})]})]}),h.jsx("button",{onClick:()=>x(C.id),className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:h.jsx(ki,{size:18})})]},C.id))})]}),h.jsxs(Cn,{children:[h.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[h.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center text-purple-600",children:h.jsx(Vm,{size:24})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-medium text-slate-900",children:"Connected Accounts"}),h.jsx("p",{className:"text-sm text-slate-500",children:"Enable social login for easier access."})]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center justify-between p-4 rounded-[16px] border border-slate-100",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(Vm,{className:"text-slate-900"}),h.jsx("span",{className:"font-medium text-slate-700",children:"GitHub"})]}),h.jsx("button",{className:"text-sm font-medium text-red-600 hover:underline",children:"Disconnect"})]}),h.jsxs("div",{className:"flex items-center justify-between p-4 rounded-[16px] border border-slate-100",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(ZT,{className:"text-primary-600"}),h.jsx("span",{className:"font-medium text-slate-700",children:"Google"})]}),h.jsx("button",{className:"text-sm font-medium text-primary-600 hover:underline",children:"Connect"})]})]})]})]}),h.jsx(Wa,{isOpen:m,onClose:()=>g(!1),title:"Add New Model",className:"max-w-md",children:h.jsx("div",{className:"p-6",children:h.jsxs("form",{onSubmit:E,className:"space-y-5",children:[h.jsx("div",{children:h.jsx(Qt,{label:"Connection Name",required:!0,placeholder:"e.g. Work Gemini",value:y.name,onChange:C=>v({...y,name:C.target.value})})}),h.jsx("div",{children:h.jsx(Lp,{label:"Provider",value:y.provider,onChange:C=>v({...y,provider:C.target.value}),options:Object.keys(_k).map(C=>({value:C,label:C}))})}),h.jsx("div",{children:h.jsx(Qt,{label:"API Key",type:"password",required:!0,placeholder:"sk-...",value:y.apiKey,onChange:C=>v({...y,apiKey:C.target.value})})}),h.jsx(Jt,{type:"submit",variant:"primary",className:"w-full mt-2",children:"Save Connection"})]})})})]})},Hm=({label:t,onClick:e})=>h.jsxs("button",{onClick:n=>{n.stopPropagation(),e()},onMouseDown:n=>n.stopPropagation(),className:"flex items-center gap-3 bg-white/80 backdrop-blur-xl px-4 py-3 rounded-2xl shadow-[0_8px_30px_rgb(0,0,0,0.08)] border border-white/60 text-slate-700 font-bold text-sm hover:scale-105 transition-all active:scale-95 group ring-1 ring-white/50",children:[h.jsx("div",{className:"w-8 h-8 rounded-xl bg-slate-900 text-white flex items-center justify-center transition-transform group-hover:rotate-90",children:h.jsx(nr,{size:18})}),h.jsx("span",{children:t})]}),Ac=t=>{switch(t){case"Document":return tr;case"Website":return Ni;case"Database":return Ga;case"Integration":return kp;default:return tr}},Ic=t=>{switch(t){case D.RAG_SEARCH:return Hr;case D.DOC_READER:return Rp;case D.DOC_WRITER:return Dp;case D.WEB_BROWSER:return Ni;case D.DATA_ANALYSIS:return Mp;case D.EMAIL_SENDER:return gl;case D.NOTIFICATION:return Ap;case D.GOOGLE_DRIVE:return ml;case D.ROUTER_CONDITIONAL:return bu;case D.HUMAN_INTERRUPT:return _u;case D.END_NODE:return Mu;case D.LLM_NODE:return hl;default:return xt}},Dk=({agent:t,assets:e,onSave:n,onCancel:r})=>{const[i,o]=_.useState({...t}),[s,l]=_.useState("flow"),[a,u]=_.useState({type:null,x:0,y:0}),[c,p]=_.useState(!1),[m,g]=_.useState(!1),[y,v]=_.useState({x:0,y:0,zoom:1}),[w,x]=_.useState(!1),[E,C]=_.useState({x:0,y:0}),S=_.useRef(null),[N,T]=_.useState([]),[k,I]=_.useState([]),[R,M]=_.useState(!1),[q,$]=_.useState(null),[F,z]=_.useState(null),[ie,Y]=_.useState(null),[se,L]=_.useState(null),[X,Z]=_.useState({x:0,y:0}),oe=_.useRef(null),[te,he]=_.useState(!1),[ce,be]=_.useState(null),[Le,ot]=_.useState({x:0,y:0}),[V,dn]=_.useState(null);_.useEffect(()=>{N.length===0&&qt(i)},[]);const qt=A=>{var b;const ee=[];ee.push({id:"trigger-chat",type:"trigger",dataId:"chat",label:"User Chat",subLabel:"Start",x:100,y:350,icon:xo,color:"bg-slate-800"}),ee.push({id:"brain-core",type:"brain",dataId:"brain",label:A.name||"Agent",subLabel:"Intelligence",x:420,y:350,icon:xt,color:"bg-slate-900"});const ye=(b=A.tools)==null?void 0:b.includes(D.RAG_SEARCH);let ve=350;ye&&(ee.push({id:`tool-${D.RAG_SEARCH}`,type:"tool",dataId:D.RAG_SEARCH,label:"Knowledge Retrieval",subLabel:"Capability",x:100+320*2,y:250,icon:Hr,color:"bg-indigo-600"}),ve=250,(A.allowedAssetIds||[]).forEach((U,re)=>{const ge=e.find(me=>me.id===U);ge&&ee.push({id:`asset-${U}`,type:"asset",dataId:U,label:ge.name,subLabel:ge.type,x:100+320*3,y:ve+re*120,icon:Ac(ge.type),color:"bg-emerald-600"})}));const fe=(A.tools||[]).filter(U=>U!==D.RAG_SEARCH);fe.forEach((U,re)=>{ee.push({id:`tool-${U}`,type:"tool",dataId:U,label:U,subLabel:"Action",x:100+320*2,y:470+re*120,icon:Ic(U),color:"bg-purple-600"})});const Tt=[];Tt.push({id:"e-trigger-brain",source:"trigger-chat",target:"brain-core"}),ye&&(Tt.push({id:"e-brain-rag",source:"brain-core",target:`tool-${D.RAG_SEARCH}`}),(A.allowedAssetIds||[]).forEach(U=>{e.find(re=>re.id===U)&&Tt.push({id:`e-rag-${U}`,source:`tool-${D.RAG_SEARCH}`,target:`asset-${U}`})})),fe.forEach(U=>{Tt.push({id:`e-brain-${U}`,source:"brain-core",target:`tool-${U}`})}),T(ee),I(Tt)};_.useEffect(()=>{const A=H=>{if((H.key==="Delete"||H.key==="Backspace")&&se){const j=k.find(B=>B.id===se);if(j){if(I(B=>B.filter(ee=>ee.id!==se)),j.source.startsWith("tool-rag_search")&&j.target.startsWith("asset-")){const B=j.target.replace("asset-","");o(ee=>({...ee,allowedAssetIds:(ee.allowedAssetIds||[]).filter(ye=>ye!==B)}))}else if(j.source==="brain-core"&&j.target.startsWith("tool-")){const B=j.target.replace("tool-","");o(ee=>({...ee,tools:(ee.tools||[]).filter(ye=>ye!==B)}))}}L(null)}};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[se,k]);const Wt=(A,H)=>{if(!S.current)return{x:0,y:0};const j=S.current.getBoundingClientRect();return{x:(A-j.left-y.x)/y.zoom,y:(H-j.top-y.y)/y.zoom}},Vi=(A,H)=>{A.stopPropagation();const j=N.find(ee=>ee.id===H);if(!j)return;z(H),u({...a,type:null});const B=Wt(A.clientX,A.clientY);Z({x:B.x-j.x,y:B.y-j.y}),$(H),M(!0)},Nn=(A,H,j)=>{A.stopPropagation(),A.preventDefault();const B=N.find(fe=>fe.id===H);if(!B)return;const ee=Wt(A.clientX,A.clientY),ye=j==="output"?B.x+288:B.x,ve=B.y+60;he(!0),be({x:ye,y:ve,sourceNodeId:H,type:j}),ot(ee)},Bi=A=>{x(!0),C({x:A.clientX,y:A.clientY}),z(null),Y(null),L(null),u({...a,type:null})},Ui=A=>{const H=Wt(A.clientX,A.clientY);if(te){ot(H);const j=N.find(B=>B.id===(ce==null?void 0:ce.sourceNodeId)?!1:H.x>=B.x&&H.x<=B.x+288&&H.y>=B.y&&H.y<=B.y+120);dn(j?j.id:null);return}if(R&&q){T(j=>j.map(B=>B.id===q?{...B,x:H.x-X.x,y:H.y-X.y}:B));return}if(w){const j=A.clientX-E.x,B=A.clientY-E.y;v(ee=>({...ee,x:ee.x+j,y:ee.y+B})),C({x:A.clientX,y:A.clientY})}},Qr=A=>{var H,j;if(te&&ce){const B=Wt(A.clientX,A.clientY),ee=N.find(ve=>ve.id===ce.sourceNodeId),ye=N.find(ve=>ve.id===ce.sourceNodeId?!1:B.x>=ve.x&&B.x<=ve.x+288&&B.y>=ve.y&&B.y<=ve.y+120);if(ye){if((ee==null?void 0:ee.type)==="brain"&&ce.type==="output"&&ye.type==="tool"){const fe=ye.dataId;(H=i.tools)!=null&&H.includes(fe)||o(Tt=>({...Tt,tools:[...Tt.tools||[],fe]}))}else(ee==null?void 0:ee.dataId)===D.RAG_SEARCH&&ce.type==="output"&&ye.type==="asset"&&((j=i.allowedAssetIds)!=null&&j.includes(ye.dataId)||o(fe=>({...fe,allowedAssetIds:[...fe.allowedAssetIds||[],ye.dataId]})));const ve=`e-${ee.id}-${ye.id}`;k.find(fe=>fe.id===ve)||I(fe=>[...fe,{id:ve,source:ee.id,target:ye.id}])}else{let ve=null;(ee==null?void 0:ee.type)==="brain"&&ce.type==="output"?ve="tool":(ee==null?void 0:ee.dataId)===D.RAG_SEARCH&&ce.type==="output"&&(ve="asset"),ve&&(u({type:ve,x:A.clientX,y:A.clientY}),oe.current={x:B.x-144,y:B.y-50,id:"pending"})}}M(!1),$(null),x(!1),he(!1),be(null),dn(null)},ur=(A,H)=>{var ye,ve;let j=0,B=0;if(H)j=H.x,B=H.y;else if(oe.current)j=oe.current.x,B=oe.current.y;else{const fe=(ye=S.current)==null?void 0:ye.getBoundingClientRect();if(fe){const Tt=(fe.width/2-y.x)/y.zoom,b=(fe.height/2-y.y)/y.zoom;j=Tt-144,B=b-60}}const ee=e.find(fe=>fe.id===A);ee&&!((ve=i.allowedAssetIds)!=null&&ve.includes(A))&&o(fe=>({...fe,allowedAssetIds:[...fe.allowedAssetIds||[],A]})),ee&&T(fe=>[...fe,{id:`asset-${A}-${Date.now()}`,type:"asset",dataId:A,label:ee.name,subLabel:ee.type,x:j,y:B,icon:Ac(ee.type),color:"bg-emerald-600"}]),u({...a,type:null}),p(!1)},fn=(A,H)=>{var ye,ve;let j=0,B=0;if(H)j=H.x,B=H.y;else if(oe.current)j=oe.current.x,B=oe.current.y;else{const fe=(ye=S.current)==null?void 0:ye.getBoundingClientRect();if(fe){const Tt=(fe.width/2-y.x)/y.zoom,b=(fe.height/2-y.y)/y.zoom;j=Tt-144,B=b-60}}(ve=i.tools)!=null&&ve.includes(A)||o(fe=>({...fe,tools:[...fe.tools||[],A]}));const ee=A===D.RAG_SEARCH;T(fe=>[...fe,{id:`tool-${A}-${Date.now()}`,type:"tool",dataId:A,label:ee?"Knowledge Retrieval":A,subLabel:"Action",x:j,y:B,icon:Ic(A),color:ee?"bg-indigo-600":"bg-purple-600"}]),u({...a,type:null}),g(!1)},zi=(A,H)=>{const j=A.x+288,B=A.y+60,ee=H.x,ye=H.y+60,ve=Math.abs(ee-j)/2;return`M ${j} ${B} C ${j+ve} ${B}, ${ee-ve} ${ye}, ${ee} ${ye}`},pn=()=>{if(!ce)return"";const A=ce.x,H=ce.y,j=Le.x,B=Le.y,ee=Math.abs(j-A)/2,ye=ce.type==="output"?A+ee:A-ee,ve=ce.type==="output"?j-ee:j+ee;return`M ${A} ${H} C ${ye} ${H}, ${ve} ${B}, ${j} ${B}`},kn=(A,H)=>{T(j=>j.map(B=>B.id===F?{...B,config:{...B.config||{},[A]:H}}:B))},cr=(A,H,j)=>{A.dataTransfer.setData("type",H),A.dataTransfer.setData("id",j)},Bn=A=>{A.preventDefault();const H=A.dataTransfer.getData("type"),j=A.dataTransfer.getData("id"),B=Wt(A.clientX,A.clientY),ee=B.x-144,ye=B.y-50;H==="asset"?ur(j,{x:ee,y:ye}):H==="tool"&&fn(j,{x:ee,y:ye})},Zr=()=>{var H,j;const A=N.find(B=>B.id===ie);return A?h.jsxs("div",{className:"absolute right-6 top-24 bottom-6 w-96 bg-white/70 backdrop-blur-2xl rounded-[32px] border border-white/60 shadow-[0_20px_50px_rgba(0,0,0,0.1)] z-[60] flex flex-col animate-in slide-in-from-right-10 fade-in duration-300 overflow-hidden ring-1 ring-white/50",onClick:B=>B.stopPropagation(),onMouseDown:B=>B.stopPropagation(),children:[h.jsxs("div",{className:"p-6 border-b border-white/40 flex justify-between items-center bg-white/30 backdrop-blur-sm",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:`p-2.5 rounded-xl ${A.color} text-white shadow-lg shadow-indigo-500/20`,children:Se.createElement(A.icon,{size:20})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-slate-900 text-lg leading-tight",children:A.label}),h.jsxs("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest mt-0.5",children:[A.type," Node"]})]})]}),h.jsx("button",{onClick:()=>Y(null),className:"w-8 h-8 rounded-full bg-slate-100 hover:bg-slate-200 text-slate-500 flex items-center justify-center transition-colors",children:h.jsx(Pp,{size:16})})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar bg-white/10",children:[A.type==="trigger"&&h.jsx("div",{className:"bg-blue-50/50 p-4 rounded-2xl border border-blue-100/50",children:h.jsx("p",{className:"text-sm font-medium text-slate-700 leading-relaxed",children:"This workflow starts when a user sends a message in the chat interface."})}),A.type==="brain"&&h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"LLM Model"}),h.jsxs("div",{className:"relative",children:[h.jsxs("select",{className:"w-full px-4 py-3 border border-white/60 rounded-xl text-sm bg-white/50 text-slate-900 focus:ring-2 focus:ring-primary-500/20 outline-none appearance-none font-medium",children:[h.jsx("option",{children:"Gemini 2.5 Flash"}),h.jsx("option",{children:"GPT-4o"})]}),h.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-slate-500",children:h.jsx(vo,{size:14,className:"rotate-90"})})]})]})}),A.type==="tool"&&h.jsxs("div",{className:"space-y-6",children:[A.dataId===D.EMAIL_SENDER&&h.jsx(h.Fragment,{children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Recipient"}),h.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-white/60 rounded-xl text-sm bg-white/50 text-slate-900 focus:ring-2 focus:ring-primary-500/20 outline-none font-medium placeholder-slate-400",placeholder:"e.g. hr@company.com",value:((H=A.config)==null?void 0:H.recipient)||"",onChange:B=>kn("recipient",B.target.value)})]})}),A.dataId===D.GOOGLE_DRIVE&&h.jsx(h.Fragment,{children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Folder"}),h.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-slate-50/50 border border-white/60 rounded-xl",children:[h.jsx(ml,{size:16,className:"text-slate-400"}),h.jsx("input",{type:"text",className:"bg-transparent border-none p-0 text-sm w-full text-slate-600 font-medium focus:ring-0",value:((j=A.config)==null?void 0:j.folder)||"/Reports",readOnly:!0})]})]})}),A.dataId===D.DOC_WRITER&&h.jsx(h.Fragment,{children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Output Format"}),h.jsxs("div",{className:"relative",children:[h.jsxs("select",{className:"w-full px-4 py-3 border border-white/60 rounded-xl text-sm bg-white/50 text-slate-900 focus:ring-2 focus:ring-primary-500/20 outline-none appearance-none font-medium",children:[h.jsx("option",{children:"PDF"}),h.jsx("option",{children:"DOCX"})]}),h.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-slate-500",children:h.jsx(vo,{size:14,className:"rotate-90"})})]})]})})]})]}),h.jsx("div",{className:"p-4 border-t border-white/40 bg-white/30 backdrop-blur-sm",children:h.jsxs("button",{onClick:()=>Y(null),className:"w-full py-3 bg-slate-900 text-white rounded-xl text-sm font-bold hover:bg-slate-800 flex items-center justify-center gap-2 shadow-lg shadow-slate-900/10 hover:scale-[1.02] active:scale-95 transition-all",children:[h.jsx(m1,{size:16})," Save Changes"]})})]}):null};return h.jsxs("div",{className:"flex flex-col h-full bg-transparent",children:[h.jsx("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 z-40",children:h.jsxs("div",{className:"bg-white/70 backdrop-blur-xl rounded-full p-2 pr-2 border border-white/60 shadow-[0_8px_30px_rgb(0,0,0,0.04)] ring-1 ring-white/50 flex items-center gap-4",children:[h.jsx("button",{onClick:r,className:"w-10 h-10 flex items-center justify-center bg-white rounded-full shadow-sm hover:bg-slate-50 transition-colors",children:h.jsx(vo,{size:20,className:"rotate-180 text-slate-600"})}),h.jsx("div",{className:"h-6 w-px bg-slate-200"}),h.jsxs("div",{className:"flex items-center gap-3 pl-1",children:[h.jsx("div",{className:`w-8 h-8 rounded-full ${i.color} flex items-center justify-center text-white text-xs shadow-sm`,children:h.jsx(xt,{size:16})}),h.jsx("input",{type:"text",value:i.name,onChange:A=>o({...i,name:A.target.value}),className:"font-bold text-lg text-slate-900 border-none p-0 focus:ring-0 placeholder-slate-400 bg-transparent w-48 focus:w-64 transition-all",placeholder:"Name your agent..."})]}),h.jsx("div",{className:"h-6 w-px bg-slate-200"}),h.jsxs("div",{className:"flex bg-slate-100/50 rounded-full p-1 border border-slate-200/50",children:[h.jsxs("button",{onClick:()=>l("flow"),className:`px-4 py-1.5 rounded-full text-xs font-bold transition-all flex items-center gap-1.5 ${s==="flow"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[h.jsx(Sk,{size:14})," Design"]}),h.jsxs("button",{onClick:()=>l("settings"),className:`px-4 py-1.5 rounded-full text-xs font-bold transition-all flex items-center gap-1.5 ${s==="settings"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[h.jsx(Ys,{size:14})," Configure"]})]}),h.jsx("button",{onClick:()=>n(i),className:"bg-slate-900 text-white w-10 h-10 rounded-full flex items-center justify-center hover:bg-primary-600 transition-all shadow-md ml-2 hover:scale-105 active:scale-95",children:h.jsx(u1,{size:18})})]})}),h.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[s==="settings"&&h.jsx("div",{className:"w-full h-full overflow-y-auto custom-scrollbar p-12",children:h.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 glass-panel p-8 rounded-[32px]",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Agent Name"}),h.jsx("input",{type:"text",value:i.name,onChange:A=>o({...i,name:A.target.value}),className:"w-full px-5 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-primary-500/20 outline-none text-slate-900 font-bold text-lg bg-white/50 backdrop-blur-sm transition-all shadow-sm",placeholder:"e.g. Research Assistant"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Role / Title"}),h.jsx("input",{type:"text",value:i.role,onChange:A=>o({...i,role:A.target.value}),className:"w-full px-5 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-primary-500/20 outline-none text-slate-700 bg-white/50 backdrop-blur-sm transition-all shadow-sm",placeholder:"e.g. Technical Specialist"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Description"}),h.jsx("textarea",{rows:3,value:i.description,onChange:A=>o({...i,description:A.target.value}),className:"w-full px-5 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-primary-500/20 outline-none text-slate-700 bg-white/50 backdrop-blur-sm transition-all shadow-sm resize-none",placeholder:"Briefly describe what this agent does..."})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-4",children:"Appearance Color"}),h.jsx("div",{className:"flex flex-wrap gap-4",children:["bg-slate-900","bg-blue-600","bg-indigo-600","bg-violet-600","bg-purple-600","bg-fuchsia-600","bg-pink-600","bg-rose-600","bg-orange-600","bg-amber-600","bg-emerald-600","bg-teal-600","bg-cyan-600","bg-sky-600"].map(A=>h.jsx("button",{onClick:()=>o({...i,color:A}),className:`w-12 h-12 rounded-full cursor-pointer transition-all hover:scale-110 shadow-sm border-2 ${A} ${i.color===A?"border-white ring-4 ring-slate-200 scale-110":"border-transparent"}`},A))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"System Instructions (Prompt)"}),h.jsxs("div",{className:"relative",children:[h.jsx("textarea",{rows:12,value:i.systemInstructions,onChange:A=>o({...i,systemInstructions:A.target.value}),className:"w-full px-5 py-4 border border-slate-200 rounded-xl focus:ring-2 focus:ring-primary-500/20 outline-none text-slate-700 bg-white/50 backdrop-blur-sm transition-all shadow-sm font-mono text-sm leading-relaxed",placeholder:"You are a helpful AI assistant..."}),h.jsx("div",{className:"absolute right-4 bottom-4 text-xs font-bold text-slate-400 pointer-events-none",children:"MARKDOWN SUPPORTED"})]})]})]})}),s==="flow"&&h.jsxs("div",{ref:S,className:"absolute inset-0 overflow-hidden bg-transparent cursor-grab",onMouseDown:Bi,onMouseMove:Ui,onMouseUp:Qr,onDragOver:A=>A.preventDefault(),onDrop:Bn,onClick:()=>u({...a,type:null}),onWheel:A=>v(H=>({...H,zoom:Math.min(Math.max(y.zoom-A.deltaY*.001,.2),2.5)})),children:[h.jsxs("div",{style:{transform:`translate(${y.x}px, ${y.y}px) scale(${y.zoom})`,transformOrigin:"0 0",width:"100%",height:"100%"},children:[h.jsxs("svg",{className:"absolute inset-0 w-full h-full z-0 overflow-visible",children:[h.jsx("defs",{children:h.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:h.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#94A3B8"})})}),k.map(A=>{const H=N.find(B=>B.id===A.source),j=N.find(B=>B.id===A.target);return!H||!j?null:h.jsx("g",{onClick:B=>{B.stopPropagation(),L(A.id),z(null),Y(null)},className:"cursor-pointer group",children:h.jsx("path",{d:zi(H,j),fill:"none",stroke:se===A.id?"#7c3aed":"#CBD5E1",strokeWidth:se===A.id?"3":"2",markerEnd:"url(#arrowhead)",className:"transition-all group-hover:stroke-primary-400"})},A.id)}),te&&h.jsx("path",{d:pn(),fill:"none",stroke:"#7c3aed",strokeWidth:"4",strokeDasharray:"5",className:"animate-pulse"})]}),N.map(A=>h.jsxs("div",{className:"absolute w-72",style:{left:A.x,top:A.y},onMouseDown:H=>Vi(H,A.id),onDoubleClick:H=>{H.stopPropagation(),Y(A.id)},children:[h.jsxs("div",{className:`
                                        bg-white/80 backdrop-blur-xl rounded-[20px] shadow-lg overflow-hidden transition-all duration-300
                                        ${F===A.id?"ring-2 ring-primary-500 shadow-xl scale-[1.02] z-20":"border border-white/60 hover:shadow-xl hover:bg-white/90"}
                                    `,children:[h.jsx("div",{className:`h-1.5 w-full ${A.color}`}),h.jsxs("div",{className:"p-4 flex items-center gap-3 relative",children:[h.jsx("div",{className:`p-2.5 rounded-xl ${A.color} bg-opacity-10 text-slate-700`,children:Se.createElement(A.icon,{size:20,className:"opacity-90"})}),h.jsxs("div",{className:"flex-1 min-w-0 pr-6",children:[h.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest leading-none mb-1",children:A.subLabel}),h.jsx("div",{className:"font-bold text-slate-900 text-sm truncate",children:A.label})]}),h.jsx("button",{onClick:H=>{H.stopPropagation(),Y(A.id)},className:"absolute top-4 right-4 text-slate-300 hover:text-primary-600 transition-colors p-1 rounded-full hover:bg-slate-50",children:h.jsx(Ys,{size:14})})]})]}),A.type!=="brain"&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"absolute -left-1.5 top-1/2 w-3 h-3 bg-slate-300 rounded-full border-2 border-white z-20 cursor-crosshair hover:scale-125 transition-transform",onMouseDown:H=>Nn(H,A.id,"input")}),h.jsx("div",{className:"absolute -right-1.5 top-1/2 w-3 h-3 bg-slate-300 rounded-full border-2 border-white z-20 cursor-crosshair hover:scale-125 transition-transform",onMouseDown:H=>Nn(H,A.id,"output")})]}),A.type==="brain"&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"absolute -left-1.5 top-1/2 w-4 h-4 bg-slate-900 rounded-full border-2 border-white z-20 cursor-crosshair hover:scale-125 transition-transform",onMouseDown:H=>Nn(H,A.id,"input")}),h.jsx("div",{className:"absolute -right-1.5 top-1/2 w-4 h-4 bg-slate-900 rounded-full border-2 border-white z-20 cursor-crosshair hover:scale-125 transition-transform",onMouseDown:H=>Nn(H,A.id,"output")})]})]},A.id))]}),h.jsx(Zr,{}),h.jsxs("div",{className:"absolute bottom-6 left-6 flex gap-2 z-50",children:[h.jsxs("div",{className:"flex bg-white/70 backdrop-blur-xl rounded-xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-white/60 p-1",children:[h.jsx("button",{onClick:()=>v(A=>({...A,zoom:Math.max(A.zoom-.1,.2)})),className:"p-2 hover:bg-white/50 rounded-lg text-slate-600",title:"Zoom Out",children:h.jsx(Nk,{size:18})}),h.jsxs("button",{onClick:()=>v({x:0,y:0,zoom:1}),className:"px-3 hover:bg-white/50 rounded-lg text-slate-600 font-mono text-xs flex items-center",children:[Math.round(y.zoom*100),"%"]}),h.jsx("button",{onClick:()=>v(A=>({...A,zoom:Math.min(A.zoom+.1,2.5)})),className:"p-2 hover:bg-white/50 rounded-lg text-slate-600",title:"Zoom In",children:h.jsx(Ek,{size:18})})]}),h.jsx("button",{onClick:()=>v({x:0,y:0,zoom:1}),className:"p-2 bg-white/70 backdrop-blur-xl rounded-xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-white/60 text-slate-600 hover:bg-white/50",title:"Fit to Screen",children:h.jsx(HN,{size:20})})]}),h.jsxs("div",{className:"absolute top-8 right-8 flex flex-col gap-4 z-50",onClick:A=>A.stopPropagation(),onMouseDown:A=>A.stopPropagation(),children:[h.jsxs("div",{className:"relative",children:[h.jsx(Hm,{label:"Add Knowledge",onClick:()=>u({type:a.type==="asset"?null:"asset",x:0,y:0})}),(a.type==="asset"||c)&&h.jsxs("div",{className:"absolute top-full right-0 mt-3 w-72 bg-white rounded-[20px] shadow-xl border border-slate-100 overflow-hidden z-50 ring-1 ring-black/5 custom-scrollbar",style:a.x!==0?{position:"fixed",left:a.x,top:a.y,marginTop:0}:{},children:[h.jsx("div",{className:"p-4 border-b border-slate-50 bg-slate-50/50 text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Select Data Source"}),h.jsxs("div",{className:"max-h-64 overflow-y-auto p-2 custom-scrollbar",children:[e.map(A=>h.jsxs("button",{draggable:!0,onDragStart:H=>cr(H,"asset",A.id),onClick:()=>ur(A.id),className:"w-full text-left px-3 py-3 hover:bg-slate-50 rounded-xl text-sm flex items-center gap-3 transition-colors group cursor-grab active:cursor-grabbing",children:[h.jsx("div",{className:"bg-white border border-slate-200 p-2 rounded-lg text-slate-500 group-hover:text-primary-600 group-hover:border-primary-200 transition-colors",children:Se.createElement(Ac(A.type),{size:16})}),h.jsx("span",{className:"truncate font-medium text-slate-700",children:A.name})]},A.id)),e.length===0&&h.jsx("div",{className:"p-4 text-xs text-center text-slate-400",children:"No assets found"})]})]})]}),h.jsxs("div",{className:"relative",children:[h.jsx(Hm,{label:"Add Action",onClick:()=>u({type:a.type==="tool"?null:"tool",x:0,y:0})}),(a.type==="tool"||m)&&h.jsxs("div",{className:"absolute top-full right-0 mt-3 w-72 bg-white rounded-[20px] shadow-xl border border-slate-100 overflow-hidden z-50 ring-1 ring-black/5",style:a.x!==0?{position:"fixed",left:a.x,top:a.y,marginTop:0}:{},children:[h.jsx("div",{className:"p-4 border-b border-slate-50 bg-slate-50/50 text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Select Capability"}),h.jsxs("div",{className:"max-h-64 overflow-y-auto p-2 custom-scrollbar",children:[h.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase px-1 mb-2 mt-2",children:"Flow Logic & AI"}),h.jsxs("button",{onClick:()=>fn(D.LLM_NODE),className:"w-full text-left p-2 hover:bg-slate-100 rounded-lg flex items-center gap-2 text-sm text-slate-700",children:[h.jsx("div",{className:"p-1.5 bg-cyan-100 text-cyan-600 rounded-md",children:h.jsx(hl,{size:16})}),"LLM / Chain Step"]}),h.jsxs("button",{onClick:()=>fn(D.ROUTER_CONDITIONAL),className:"w-full text-left p-2 hover:bg-slate-100 rounded-lg flex items-center gap-2 text-sm text-slate-700",children:[h.jsx("div",{className:"p-1.5 bg-amber-100 text-amber-600 rounded-md",children:h.jsx(bu,{size:16})}),"Logic Router"]}),h.jsxs("button",{onClick:()=>fn(D.HUMAN_INTERRUPT),className:"w-full text-left p-2 hover:bg-slate-100 rounded-lg flex items-center gap-2 text-sm text-slate-700",children:[h.jsx("div",{className:"p-1.5 bg-pink-100 text-pink-600 rounded-md",children:h.jsx(_u,{size:16})}),"Human Approval"]}),h.jsxs("button",{onClick:()=>fn(D.END_NODE),className:"w-full text-left p-2 hover:bg-slate-100 rounded-lg flex items-center gap-2 text-sm text-slate-700",children:[h.jsx("div",{className:"p-1.5 bg-slate-100 text-slate-600 rounded-md",children:h.jsx(Mu,{size:16})}),"End Workflow"]}),h.jsx("div",{className:"my-2 border-b border-slate-100"}),h.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase px-1 mb-2",children:"Available Actions"}),Object.values(D).map(A=>{var j;if([D.LLM_NODE,D.ROUTER_CONDITIONAL,D.HUMAN_INTERRUPT,D.END_NODE].includes(A))return null;const H=Ic(A);return h.jsxs("button",{draggable:!0,onDragStart:B=>cr(B,"tool",A),disabled:(j=i.tools)==null?void 0:j.includes(A),onClick:()=>fn(A),className:"w-full text-left px-3 py-3 hover:bg-slate-50 rounded-xl text-sm flex items-center gap-3 transition-colors disabled:opacity-50 disabled:cursor-not-allowed group cursor-grab active:cursor-grabbing",children:[h.jsx("div",{className:"bg-white border border-slate-200 p-2 rounded-lg text-slate-500 group-hover:text-purple-600 group-hover:border-purple-200 transition-colors",children:h.jsx(H,{size:16})}),h.jsx("span",{className:"truncate font-medium text-slate-700",children:A})]},A)})]})]})]})]})]})]})]})},Pk=t=>{switch(t){case D.RAG_SEARCH:return Hr;case D.DOC_READER:return Rp;case D.DOC_WRITER:return Dp;case D.WEB_BROWSER:return Ni;case D.DATA_ANALYSIS:return Mp;case D.EMAIL_SENDER:return gl;case D.NOTIFICATION:return Ap;case D.GOOGLE_DRIVE:return ml;case D.ROUTER_CONDITIONAL:return bu;case D.HUMAN_INTERRUPT:return _u;case D.END_NODE:return Mu;case D.LLM_NODE:return hl;default:return xt}},Lk=({agent:t,onEdit:e,onDelete:n,onChat:r})=>{var i,o;return h.jsxs("div",{onClick:()=>r(t.id),className:"group relative flex flex-col p-6 rounded-2xl bg-white/80 backdrop-blur-xl border border-white/60 shadow-sm hover:shadow-soft transition-all duration-300 cursor-pointer h-full overflow-hidden",children:[h.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 rounded-bl-[60px] opacity-10 transition-colors duration-300 ${((i=t.color)==null?void 0:i.replace("bg-","bg-"))||"bg-slate-500"}`}),h.jsxs("div",{className:"absolute top-4 right-4 flex gap-1 z-20",children:[h.jsx("button",{onClick:s=>{s.stopPropagation(),e(t)},className:"p-1.5 text-slate-400 hover:text-primary-600 transition-colors",children:h.jsx(Ys,{size:16})}),h.jsx("button",{onClick:s=>{s.stopPropagation(),n(t.id)},className:"p-1.5 text-slate-400 hover:text-red-500 transition-colors",children:h.jsx(ki,{size:16})})]}),h.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-white text-xl shadow-lg shadow-indigo-900/5 mb-4 ${t.color||"bg-slate-500"}`,children:h.jsx(xt,{size:24,strokeWidth:1.5})}),h.jsx("h3",{className:"font-bold text-lg text-slate-900 leading-tight mb-1 group-hover:text-primary-700 transition-colors",children:t.name}),h.jsx("div",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-400",children:t.role})]}),h.jsx("p",{className:"text-xs text-slate-500 leading-relaxed line-clamp-2 mb-6 font-medium",children:t.systemInstructions||t.description||"No specific instructions provided."}),h.jsxs("div",{className:"mt-auto flex flex-wrap gap-x-4 gap-y-2",children:[t.tools.slice(0,3).map((s,l)=>h.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-slate-500",children:[Se.createElement(Pk(s),{size:12,className:"text-slate-400"}),h.jsx("span",{className:"capitalize",children:s.toLowerCase().replace("_"," ").replace("search","Ret...").replace("reader","Rea...")})]},l)),(((o=t.tools)==null?void 0:o.length)||0)>3&&h.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-slate-500",children:[h.jsx("span",{className:"w-1 h-1 rounded-full bg-slate-300"}),h.jsxs("span",{children:["+",t.tools.length-3," more"]})]})]})]})]})},Ok=t=>{switch(t){case D.RAG_SEARCH:return Hr;case D.DOC_READER:return Rp;case D.DOC_WRITER:return Dp;case D.WEB_BROWSER:return Ni;case D.DATA_ANALYSIS:return Mp;case D.EMAIL_SENDER:return gl;case D.NOTIFICATION:return Ap;case D.GOOGLE_DRIVE:return ml;case D.ROUTER_CONDITIONAL:return bu;case D.HUMAN_INTERRUPT:return _u;case D.END_NODE:return Mu;case D.LLM_NODE:return hl;default:return xt}},Fk=({agents:t,assets:e,onSaveAgent:n,onDeleteAgent:r,onChatWithAgent:i})=>{const[o,s]=_.useState(!1),[l,a]=_.useState({id:"",name:"",role:"",description:"",systemInstructions:"",allowedAssetIds:[],tools:[],color:"bg-primary-600"}),[u,c]=_.useState("grid"),[p,m]=_.useState(""),[g,y]=_.useState("All"),[v,w]=_.useState(1),x=u==="grid"?12:8,E=t.filter(M=>{var F;const q=M.name.toLowerCase().includes(p.toLowerCase())||M.role.toLowerCase().includes(p.toLowerCase()),$=g==="All"||((F=M.tools)==null?void 0:F.includes(g));return q&&$}),C=Math.ceil(E.length/x),S=E.slice((v-1)*x,v*x),N=M=>{M>=1&&M<=C&&w(M)};_.useEffect(()=>{w(1)},[p,g,u]);const T=()=>{a({id:Date.now().toString(),name:"New Agent",role:"Assistant",description:"",systemInstructions:"You are a helpful assistant.",allowedAssetIds:[],tools:[D.RAG_SEARCH],color:"bg-primary-600"}),s(!0)},k=M=>{a({...M}),s(!0)},I=M=>{n(M),s(!1)},R=()=>h.jsx(Wa,{isOpen:o,onClose:()=>s(!1),className:"md:w-[96vw] md:h-[92vh] max-w-none max-h-none h-full w-full p-0 overflow-hidden md:rounded-[28px]",children:h.jsx("div",{className:"w-full h-full flex flex-col",children:h.jsx(Dk,{agent:l,assets:e,onSave:I,onCancel:()=>s(!1)})})});return h.jsxs(Pi,{children:[h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"flex justify-between items-end",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-4xl font-normal text-slate-900 tracking-tight mb-2",children:"Agent Studio"}),h.jsx("p",{className:"text-slate-500 text-lg",children:"Manage intelligent assistants and workflows."})]}),h.jsxs("button",{onClick:T,className:"bg-primary-200 text-primary-900 px-6 py-4 rounded-[16px] hover:bg-primary-300 transition-all flex items-center gap-3 shadow-sm hover:shadow-md font-medium",children:[h.jsx(nr,{size:24}),h.jsx("span",{className:"text-base",children:"New Agent"})]})]}),h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white/60 backdrop-blur-xl p-2 rounded-[24px] border border-white/60 shadow-[0_8px_30px_rgb(0,0,0,0.04)]",children:[h.jsxs("div",{className:"flex items-center gap-3 flex-1 w-full pl-2",children:[h.jsxs("div",{className:"relative flex-1",children:[h.jsx(Hr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 w-4 h-4"}),h.jsx("input",{type:"text",placeholder:"Search agents...",value:p,onChange:M=>m(M.target.value),className:"w-full pl-9 pr-4 py-2.5 bg-white/50 border border-white/50 rounded-full text-sm focus:ring-2 focus:ring-primary-100 text-slate-700 placeholder:text-slate-400"})]}),h.jsx("div",{className:"relative",children:h.jsx(Lp,{value:g,onChange:M=>y(M.target.value),options:[{value:"All",label:"All Tools"},...Object.values(D).map(M=>({value:M,label:M}))],icon:h.jsx(wN,{className:"w-4 h-4 text-slate-400"}),className:"w-48 bg-white/50 border-white/50 rounded-full h-[42px]"})})]}),h.jsxs("div",{className:"flex bg-white/50 p-1 rounded-full border border-white/50",children:[h.jsx("button",{onClick:()=>c("grid"),className:`p-2 rounded-full transition-all ${u==="grid"?"bg-white shadow-sm text-primary-600":"text-slate-400 hover:text-slate-600"}`,children:h.jsx(h1,{size:18})}),h.jsx("button",{onClick:()=>c("list"),className:`p-2 rounded-full transition-all ${u==="list"?"bg-white shadow-sm text-primary-600":"text-slate-400 hover:text-slate-600"}`,children:h.jsx(qa,{size:18})})]})]}),h.jsxs(Cn,{children:[h.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[h.jsx("div",{className:"w-10 h-10 rounded-xl bg-purple-100 flex items-center justify-center text-purple-600",children:h.jsx(xt,{size:20})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h2",{className:"text-xl font-medium text-slate-800",children:"Your Agents"}),h.jsx("p",{className:"text-sm text-slate-500",children:"Manage and customize your AI assistants."})]})]}),u==="grid"?h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",children:S.map(M=>h.jsx(Lk,{agent:M,onEdit:k,onDelete:r,onChat:i},M.id))}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left border-collapse",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"border-b border-white/50 text-xs font-bold text-slate-400 uppercase tracking-widest",children:[h.jsx("th",{className:"px-8 py-5",children:"Agent"}),h.jsx("th",{className:"px-8 py-5",children:"Role"}),h.jsx("th",{className:"px-8 py-5",children:"Tools"}),h.jsx("th",{className:"px-8 py-5 text-right",children:"Actions"})]})}),h.jsx("tbody",{className:"divide-y divide-white/50",children:S.map(M=>{var q,$;return h.jsxs("tr",{className:"hover:bg-white/80 transition-colors cursor-pointer group",onClick:()=>i(M.id),children:[h.jsx("td",{className:"px-8 py-5",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:`w-10 h-10 rounded-[12px] flex items-center justify-center text-white text-xs ${M.color} shadow-sm group-hover:scale-110 transition-transform`,children:h.jsx(xt,{size:20})}),h.jsx("span",{className:"font-bold text-slate-900 text-base",children:M.name})]})}),h.jsx("td",{className:"px-8 py-5",children:h.jsx(Ts,{variant:"outline",className:"bg-white/50",children:M.role})}),h.jsx("td",{className:"px-8 py-5",children:h.jsxs("div",{className:"flex -space-x-2",children:[(q=M.tools)==null?void 0:q.slice(0,3).map((F,z)=>h.jsx("div",{className:"w-8 h-8 rounded-full bg-white border-2 border-white flex items-center justify-center text-slate-500 shadow-sm",title:F,children:Se.createElement(Ok(F),{size:14})},z)),((($=M.tools)==null?void 0:$.length)||0)>3&&h.jsxs("div",{className:"w-8 h-8 rounded-full bg-slate-50 border-2 border-white flex items-center justify-center text-xs font-bold text-slate-400",children:["+",M.tools.length-3]})]})}),h.jsx("td",{className:"px-8 py-5 text-right",children:h.jsxs("div",{className:"flex justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:F=>{F.stopPropagation(),k(M)},className:"p-2 hover:bg-slate-100 text-slate-400 rounded-full transition-colors",children:h.jsx(Ys,{size:18})}),h.jsx("button",{onClick:F=>{F.stopPropagation(),i(M.id)},className:"p-2 hover:bg-primary-50 text-primary-600 rounded-full transition-colors",children:h.jsx(xo,{size:18})}),h.jsx("button",{onClick:F=>{F.stopPropagation(),r(M.id)},className:"p-2 hover:bg-red-50 text-red-500 rounded-full transition-colors",children:h.jsx(ki,{size:18})})]})})]},M.id)})})]})}),C>1&&h.jsx("div",{className:"flex justify-center mt-8 border-t border-slate-100/50 pt-8",children:h.jsxs("div",{className:"flex items-center gap-2 bg-white/50 p-1 rounded-full shadow-sm border border-slate-100/50 backdrop-blur-sm",children:[h.jsx("button",{onClick:()=>N(v-1),disabled:v===1,className:"p-2 hover:bg-slate-50 rounded-full disabled:opacity-50",children:h.jsx(d1,{size:16})}),h.jsxs("span",{className:"text-sm font-medium text-slate-600 px-2",children:[v," / ",C]}),h.jsx("button",{onClick:()=>N(v+1),disabled:v===C,className:"p-2 hover:bg-slate-50 rounded-full disabled:opacity-50",children:h.jsx(f1,{size:16})})]})})]})]}),R()]})},Vk=({user:t,agents:e,assets:n,sessions:r,onNavigate:i,onSelectSession:o,onNewChat:s})=>{const l=[...r].sort((c,p)=>new Date(p.lastModified).getTime()-new Date(c.lastModified).getTime()).slice(0,3),a=[{label:"Active Agents",value:e.length,icon:xt,color:"bg-primary-50 text-primary-600"},{label:"Indexed Assets",value:n.length,icon:tr,color:"bg-emerald-100 text-emerald-600"},{label:"Total Chats",value:r.length,icon:xo,color:"bg-purple-100 text-purple-600"}],u=c=>{const p=Date.now()-new Date(c).getTime(),m=Math.floor(p/6e4);if(m<60)return`${m}m ago`;const g=Math.floor(m/60);return g<24?`${g}h ago`:`${Math.floor(g/24)}d ago`};return h.jsx(Pi,{children:h.jsxs("div",{className:"space-y-10",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsxs("h1",{className:"text-5xl font-light text-slate-900 tracking-tight mb-2",children:["Welcome back, ",h.jsx("span",{className:"font-semibold bg-gradient-to-r from-primary-600 to-indigo-600 bg-clip-text text-transparent",children:t.name})]}),h.jsx("p",{className:"text-slate-500 text-lg font-light",children:"Here's what's happening in your workspace today."})]}),h.jsxs("button",{onClick:s,className:"group relative px-6 py-4 rounded-[20px] bg-slate-900 text-white shadow-xl shadow-primary-900/10 hover:shadow-2xl hover:shadow-primary-900/20 hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary-600 to-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),h.jsxs("div",{className:"relative flex items-center gap-3",children:[h.jsx(nr,{size:24}),h.jsx("span",{className:"text-base font-medium",children:"New Chat"})]})]})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:a.map((c,p)=>h.jsxs("div",{className:"bg-white/60 backdrop-blur-xl p-6 rounded-[28px] border border-white/60 shadow-[0_8px_30px_rgb(0,0,0,0.04)] flex items-center gap-5 hover:transform hover:scale-[1.02] transition-all duration-300 group cursor-default",children:[h.jsx("div",{className:`w-16 h-16 rounded-[22px] flex items-center justify-center ${c.color} shadow-sm group-hover:scale-110 transition-transform duration-300`,children:h.jsx(c.icon,{size:32})}),h.jsxs("div",{children:[h.jsx("div",{className:"text-4xl font-semibold text-slate-800 tracking-tight",children:c.value}),h.jsx("div",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mt-1",children:c.label})]})]},p))}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("h2",{className:"text-xl font-semibold text-slate-800 tracking-tight flex items-center gap-2",children:[h.jsx(_p,{size:20,className:"text-slate-400"})," Jump back in"]}),h.jsxs("button",{onClick:()=>i(Ce.CHAT),className:"text-sm font-bold uppercase tracking-wider text-primary-600 hover:text-primary-700 flex items-center gap-1 group",children:["View history ",h.jsx(vo,{size:16,className:"group-hover:translate-x-1 transition-transform"})]})]}),h.jsxs("div",{className:"grid gap-4",children:[l.map(c=>{var m;const p=e.find(g=>g.id===c.agentId);return h.jsxs("div",{onClick:()=>o(c.id),className:"group bg-white/40 backdrop-blur-md p-5 rounded-[24px] border border-white/50 shadow-sm hover:bg-white/80 hover:shadow-lg hover:scale-[1.01] transition-all duration-300 cursor-pointer flex items-center gap-5",children:[h.jsx("div",{className:`w-14 h-14 rounded-[20px] flex items-center justify-center text-white shadow-lg shadow-purple-900/10 flex-shrink-0 ${(p==null?void 0:p.color)||"bg-slate-500"}`,children:h.jsx(xt,{size:26})}),h.jsxs("div",{className:"flex-1 min-w-0 py-1",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[h.jsx("span",{className:"text-sm font-bold text-slate-700 bg-white/50 px-2 py-0.5 rounded-full border border-white/50",children:p==null?void 0:p.name}),h.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1 ml-auto",children:u(c.lastModified)})]}),h.jsx("div",{className:"font-semibold text-lg text-slate-800 truncate group-hover:text-primary-600 transition-colors",children:c.title}),h.jsx("div",{className:"text-sm text-slate-500 truncate mt-1 font-light",children:((m=c.messages[c.messages.length-1])==null?void 0:m.content)||"No messages yet"})]}),h.jsx("div",{className:"w-10 h-10 rounded-full bg-white/50 flex items-center justify-center text-slate-300 group-hover:bg-primary-500 group-hover:text-white transition-all duration-300 shadow-sm",children:h.jsx(vo,{size:20,className:"-ml-0.5"})})]},c.id)}),l.length===0&&h.jsxs("div",{className:"p-10 rounded-[24px] border border-slate-100 text-center",children:[h.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-300",children:h.jsx(xo,{size:32})}),h.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No recent chats"}),h.jsx("p",{className:"text-slate-500 mb-6",children:"Start a new conversation with an AI agent."}),h.jsx("button",{onClick:s,className:"text-primary-600 font-medium hover:underline",children:"Start Chat"})]})]})]}),h.jsxs("div",{className:"space-y-8",children:[h.jsxs(Cn,{children:[h.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[h.jsx("div",{className:"w-10 h-10 rounded-xl bg-rose-100 flex items-center justify-center text-rose-600",children:h.jsx(kc,{size:20})}),h.jsx("h2",{className:"text-xl font-medium text-slate-800",children:"Quick Actions"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("button",{onClick:()=>s(),className:"p-4 rounded-2xl bg-white/50 border border-slate-100 hover:border-primary-300 hover:shadow-md transition-all text-left group",children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-100 text-primary-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:h.jsx(xo,{size:20})}),h.jsx("span",{className:"font-semibold text-slate-700 block",children:"New Chat"}),h.jsx("span",{className:"text-xs text-slate-500",children:"Start a conversation"})]}),h.jsxs("button",{onClick:()=>i(Ce.KNOWLEDGE),className:"p-4 rounded-2xl bg-white/50 border border-slate-100 hover:border-primary-300 hover:shadow-md transition-all text-left group",children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:h.jsx(tr,{size:20})}),h.jsx("span",{className:"font-semibold text-slate-700 block",children:"Add Knowledge"}),h.jsx("span",{className:"text-xs text-slate-500",children:"Upload data"})]}),h.jsxs("button",{onClick:()=>i(Ce.AGENTS),className:"p-4 rounded-2xl bg-white/50 border border-slate-100 hover:border-primary-300 hover:shadow-md transition-all text-left group",children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:h.jsx(xt,{size:20})}),h.jsx("span",{className:"font-semibold text-slate-700 block",children:"Create Agent"}),h.jsx("span",{className:"text-xs text-slate-500",children:"Build a custom bot"})]}),h.jsxs("button",{onClick:()=>i(Ce.KNOWLEDGE),className:"p-4 rounded-2xl bg-white/50 border border-slate-100 hover:border-primary-300 hover:shadow-md transition-all text-left group",children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-100 text-amber-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:h.jsx(Ip,{size:20})}),h.jsx("span",{className:"font-semibold text-slate-700 block",children:"Manage Assets"}),h.jsx("span",{className:"text-xs text-slate-500",children:"View all assets"})]})]})]}),h.jsxs(Cn,{children:[h.jsxs("h2",{className:"text-xl font-medium text-slate-800 mb-6 flex items-center gap-2",children:[h.jsx(kc,{size:20,className:"text-emerald-400"})," System Status"]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Vector Database"}),h.jsxs("span",{className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded-full border border-emerald-100",children:[h.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"})," Operational"]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-sm font-medium text-slate-600",children:"LLM Gateway"}),h.jsxs("span",{className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded-full border border-emerald-100",children:[h.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"})," Operational"]})]}),h.jsx("div",{className:"mt-6 pt-4 border-t border-slate-50",children:h.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[h.jsx(kc,{size:14}),h.jsx("span",{children:"Last system check: Just now"})]})})]})]})]})]})]})})},zl=t=>new Promise(e=>setTimeout(e,t));let fr=[{id:"1",title:"Project Ideas",content:"<h1>Project Ideas</h1><p>Here are some <b>bold</b> ideas.</p>",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"2",title:"Meeting Notes",content:"<h2>Meeting - 10/24</h2><ul><li>Discussed Q4 roadmap</li><li>Approved budget</li></ul>",createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:new Date(Date.now()-864e5).toISOString()}];const Hl={getAll:async()=>(await zl(300),[...fr].sort((t,e)=>new Date(e.updatedAt).getTime()-new Date(t.updatedAt).getTime())),getById:async t=>(await zl(200),fr.find(e=>e.id===t)),save:async t=>{await zl(500);const e=fr.findIndex(i=>i.id===t.id),n=new Date().toISOString(),r={...t,updatedAt:n};return e>=0?fr[e]=r:fr.push({...r,createdAt:n}),r},delete:async t=>{await zl(300),fr=fr.filter(e=>e.id!==t)},getContextString:async t=>{const e=fr.find(n=>n.id===t);return e?`Title: ${e.title}
Content:
${e.content.replace(/<[^>]*>?/gm," ")}`:""}};function et(t){this.content=t}et.prototype={constructor:et,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),o=r.content.slice();return i==-1?o.push(n||t,e):(o[i+1]=e,n&&(o[i]=n)),new et(o)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new et(n)},addToStart:function(t,e){return new et([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new et(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),o=r.find(t);return i.splice(o==-1?i.length:o,0,e,n),new et(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=et.from(t),t.size?new et(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=et.from(t),t.size?new et(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=et.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};et.from=function(t){if(t instanceof et)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new et(e)};function y1(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),o=e.child(r);if(i==o){n+=i.nodeSize;continue}if(!i.sameMarkup(o))return n;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)n++;return n}if(i.content.size||o.content.size){let s=y1(i.content,o.content,n+1);if(s!=null)return s}n+=i.nodeSize}}function v1(t,e,n,r){for(let i=t.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:n,b:r};let s=t.child(--i),l=e.child(--o),a=s.nodeSize;if(s==l){n-=a,r-=a;continue}if(!s.sameMarkup(l))return{a:n,b:r};if(s.isText&&s.text!=l.text){let u=0,c=Math.min(s.text.length,l.text.length);for(;u<c&&s.text[s.text.length-u-1]==l.text[l.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||l.content.size){let u=v1(s.content,l.content,n-1,r-1);if(u)return u}n-=a,r-=a}}class P{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,o){for(let s=0,l=0;l<n;s++){let a=this.content[s],u=l+a.nodeSize;if(u>e&&r(a,i+l,o||null,s)!==!1&&a.content.size){let c=l+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,n-c),r,i+c)}l=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let o="",s=!0;return this.nodesBetween(e,n,(l,a)=>{let u=l.isText?l.text.slice(Math.max(e,a)-a,n-a):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&r&&(s?s=!1:o+=r),o+=u},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new P(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let o=0,s=0;s<n;o++){let l=this.content[o],a=s+l.nodeSize;a>e&&((s<e||a>n)&&(l.isText?l=l.cut(Math.max(0,e-s),Math.min(l.text.length,n-s)):l=l.cut(Math.max(0,e-s-1),Math.min(l.content.size,n-s-1))),r.push(l),i+=l.nodeSize),s=a}return new P(r,i)}cutByIndex(e,n){return e==n?P.empty:e==0&&n==this.content.length?this:new P(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),o=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new P(i,o)}addToStart(e){return new P([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new P(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return y1(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return v1(this,e,n,r)}findIndex(e){if(e==0)return $l(0,e);if(e==this.size)return $l(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=this.child(n),o=r+i.nodeSize;if(o>=e)return o==e?$l(n+1,o):$l(n,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return P.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new P(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return P.empty;let n,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(n||(n=e.slice(0,i)),n[n.length-1]=o.withText(n[n.length-1].text+o.text)):n&&n.push(o)}return new P(n||e,r)}static from(e){if(!e)return P.empty;if(e instanceof P)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new P([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}P.empty=new P([],0);const Mc={index:0,offset:0};function $l(t,e){return Mc.index=t,Mc.offset=e,Mc}function ja(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!ja(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!ja(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let Te=class Xd{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))n||(n=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(o)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&ja(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Xd.none;if(e instanceof Xd)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};Te.none=[];class Ja extends Error{}class W{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=w1(this.content,e+this.openStart,n);return r&&new W(r,this.openStart,this.openEnd)}removeBetween(e,n){return new W(x1(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return W.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new W(P.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.lastChild)i++;return new W(e,r,i)}}W.empty=new W(P.empty,0,0);function x1(t,e,n){let{index:r,offset:i}=t.findIndex(e),o=t.maybeChild(r),{index:s,offset:l}=t.findIndex(n);if(i==e||o.isText){if(l!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(r,o.copy(x1(o.content,e-i-1,n-i-1)))}function w1(t,e,n,r){let{index:i,offset:o}=t.findIndex(e),s=t.maybeChild(i);if(o==e||s.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let l=w1(s.content,e-o-1,n,s);return l&&t.replaceChild(i,s.copy(l))}function Bk(t,e,n){if(n.openStart>t.depth)throw new Ja("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Ja("Inconsistent open depths");return S1(t,e,n,0)}function S1(t,e,n,r){let i=t.index(r),o=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let s=S1(t,e,n,r+1);return o.copy(o.content.replaceChild(i,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let s=t.parent,l=s.content;return mi(s,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}else{let{start:s,end:l}=Uk(n,t);return mi(o,E1(t,s,l,e,r))}else return mi(o,Ka(t,e,r))}function C1(t,e){if(!e.type.compatibleContent(t.type))throw new Ja("Cannot join "+e.type.name+" onto "+t.type.name)}function Qd(t,e,n){let r=t.node(n);return C1(r,e.node(n)),r}function hi(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Ns(t,e,n,r){let i=(e||t).node(n),o=0,s=e?e.index(n):i.childCount;t&&(o=t.index(n),t.depth>n?o++:t.textOffset&&(hi(t.nodeAfter,r),o++));for(let l=o;l<s;l++)hi(i.child(l),r);e&&e.depth==n&&e.textOffset&&hi(e.nodeBefore,r)}function mi(t,e){return t.type.checkContent(e),t.copy(e)}function E1(t,e,n,r,i){let o=t.depth>i&&Qd(t,e,i+1),s=r.depth>i&&Qd(n,r,i+1),l=[];return Ns(null,t,i,l),o&&s&&e.index(i)==n.index(i)?(C1(o,s),hi(mi(o,E1(t,e,n,r,i+1)),l)):(o&&hi(mi(o,Ka(t,e,i+1)),l),Ns(e,n,i,l),s&&hi(mi(s,Ka(n,r,i+1)),l)),Ns(r,null,i,l),new P(l)}function Ka(t,e,n){let r=[];if(Ns(null,t,n,r),t.depth>n){let i=Qd(t,e,n+1);hi(mi(i,Ka(t,e,n+1)),r)}return Ns(e,null,n,r),new P(r)}function Uk(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let o=n-1;o>=0;o--)i=e.node(o).copy(P.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class Xs{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Te.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let l=r;r=i,i=l}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Ya(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,o=n;for(let s=e;;){let{index:l,offset:a}=s.content.findIndex(o),u=o-a;if(r.push(s,l,i+a),!u||(s=s.child(l),s.isText))break;o=u-1,i+=a+1}return new Xs(n,r,o)}static resolveCached(e,n){let r=$m.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==n)return s}else $m.set(e,r=new zk);let i=r.elts[r.i]=Xs.resolve(e,n);return r.i=(r.i+1)%Hk,i}}class zk{constructor(){this.elts=[],this.i=0}}const Hk=12,$m=new WeakMap;class Ya{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const $k=Object.create(null);let Lr=class Zd{constructor(e,n,r,i=Te.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||P.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&ja(this.attrs,n||e.defaultAttrs||$k)&&Te.sameSet(this.marks,r||Te.none)}copy(e=null){return e==this.content?this:new Zd(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Zd(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return W.empty;let i=this.resolve(e),o=this.resolve(n),s=r?0:i.sharedDepth(n),l=i.start(s),u=i.node(s).content.cut(i.pos-l,o.pos-l);return new W(u,i.depth-s,o.depth-s)}replace(e,n,r){return Bk(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return Xs.resolveCached(this,e)}resolveNoCache(e){return Xs.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),T1(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=P.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),l=s&&s.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(let a=i;a<o;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,n);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Te.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Te.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=P.fromJSON(e,n.content),o=e.nodeType(n.type).create(n.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};Lr.prototype.text=void 0;class Xa extends Lr{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):T1(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Xa(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Xa(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function T1(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Ai{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new Gk(e,n);if(r.next==null)return Ai.empty;let i=N1(r);r.next&&r.err("Unexpected trailing text");let o=Xk(Yk(i));return Qk(o,r),o}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let o=n;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function o(s,l){let a=s.matchFragment(e,r);if(a&&(!n||a.validEnd))return P.from(l.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:c,next:p}=s.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(p)==-1){i.push(p);let m=o(p,l.concat(c));if(m)return m}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let l=i;l.type;l=l.via)s.push(l.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:l,next:a}=o.next[s];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),n[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}Ai.empty=new Ai(!0);class Gk{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function N1(t){let e=[];do e.push(qk(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function qk(t){let e=[];do e.push(Wk(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function Wk(t){let e=Kk(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=jk(t,e);else break;return e}function Gm(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function jk(t,e){let n=Gm(t),r=n;return t.eat(",")&&(t.next!="}"?r=Gm(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function Jk(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let o in n){let s=n[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function Kk(t){if(t.eat("(")){let e=N1(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=Jk(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Yk(t){let e=[[]];return i(o(t,0),n()),e;function n(){return e.push([])-1}function r(s,l,a){let u={term:a,to:l};return e[s].push(u),u}function i(s,l){s.forEach(a=>a.to=l)}function o(s,l){if(s.type=="choice")return s.exprs.reduce((a,u)=>a.concat(o(u,l)),[]);if(s.type=="seq")for(let a=0;;a++){let u=o(s.exprs[a],l);if(a==s.exprs.length-1)return u;i(u,l=n())}else if(s.type=="star"){let a=n();return r(l,a),i(o(s.expr,a),a),[r(a)]}else if(s.type=="plus"){let a=n();return i(o(s.expr,l),a),i(o(s.expr,a),a),[r(a)]}else{if(s.type=="opt")return[r(l)].concat(o(s.expr,l));if(s.type=="range"){let a=l;for(let u=0;u<s.min;u++){let c=n();i(o(s.expr,a),c),a=c}if(s.max==-1)i(o(s.expr,a),a);else for(let u=s.min;u<s.max;u++){let c=n();r(a,c),i(o(s.expr,a),c),a=c}return[r(a)]}else{if(s.type=="name")return[r(l,void 0,s.value)];throw new Error("Unknown expr type")}}}}function k1(t,e){return e-t}function qm(t,e){let n=[];return r(e),n.sort(k1);function r(i){let o=t[i];if(o.length==1&&!o[0].term)return r(o[0].to);n.push(i);for(let s=0;s<o.length;s++){let{term:l,to:a}=o[s];!l&&n.indexOf(a)==-1&&r(a)}}}function Xk(t){let e=Object.create(null);return n(qm(t,0));function n(r){let i=[];r.forEach(s=>{t[s].forEach(({term:l,to:a})=>{if(!l)return;let u;for(let c=0;c<i.length;c++)i[c][0]==l&&(u=i[c][1]);qm(t,a).forEach(c=>{u||i.push([l,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let o=e[r.join(",")]=new Ai(r.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let l=i[s][1].sort(k1);o.next.push({type:i[s][0],next:e[l.join(",")]||n(l)})}return o}}function Qk(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],o=!i.validEnd,s=[];for(let l=0;l<i.next.length;l++){let{type:a,next:u}=i.next[l];s.push(a.name),o&&!(a.isText||a.hasRequiredAttrs())&&(o=!1),r.indexOf(u)==-1&&r.push(u)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function A1(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function I1(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let o=t[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function M1(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let o=t[i];o.validate&&o.validate(e[i])}}function b1(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new eA(t,r,e[r]);return n}let Wm=class _1{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=b1(e,r.attrs),this.defaultAttrs=A1(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Ai.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:I1(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Lr(this,this.computeAttrs(e),P.from(n),Te.setFrom(r))}createChecked(e=null,n,r){return n=P.from(n),this.checkContent(n),new Lr(this,this.computeAttrs(e),n,Te.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=P.from(n),n.size){let s=this.contentMatch.fillBefore(n);if(!s)return null;n=s.append(n)}let i=this.contentMatch.matchFragment(n),o=i&&i.fillBefore(P.empty,!0);return o?new Lr(this,e,n.append(o),Te.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){M1(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Te.none:e}static compile(e,n){let r=Object.create(null);e.forEach((o,s)=>r[o]=new _1(o,n,s));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function Zk(t,e,n){let r=n.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${o}`)}}class eA{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?Zk(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Ru{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=b1(e,i.attrs),this.excluded=null;let o=A1(this.attrs);this.instance=o?new Te(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Te(this,I1(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new Ru(o,i++,n,s)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){M1(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class R1{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=et.from(e.nodes),n.marks=et.from(e.marks||{}),this.nodes=Wm.compile(this.spec.nodes,this),this.marks=Ru.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",l=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=Ai.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=l=="_"?null:l?jm(this,l.split(" ")):l==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:jm(this,s.split(" "))}this.nodeFromJSON=i=>Lr.fromJSON(this,i),this.markFromJSON=i=>Te.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Wm){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new Xa(r,r.defaultAttrs,e,Te.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function jm(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],o=t.marks[i],s=o;if(o)n.push(o);else for(let l in t.marks){let a=t.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=a)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function tA(t){return t.tag!=null}function nA(t){return t.style!=null}class Or{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(tA(i))this.tags.push(i);else if(nA(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,n={}){let r=new Km(this,n,!1);return r.addAll(e,Te.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new Km(this,n,!0);return r.addAll(e,Te.none,n.from,n.to),W.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(oA(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||n.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,n,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],l=s.style;if(!(l.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=n))){if(s.getAttrs){let a=s.getAttrs(n);if(a===!1)continue;s.attrs=a||void 0}return s}}}static schemaRules(e){let n=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<n.length;s++){let l=n[s];if((l.priority==null?50:l.priority)<o)break}n.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Ym(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Ym(s)),s.node||s.ignore||s.mark||(s.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Or(e,Or.schemaRules(e)))}}const D1={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},rA={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},P1={ol:!0,ul:!0},Qs=1,ef=2,ks=4;function Jm(t,e,n){return e!=null?(e?Qs:0)|(e==="full"?ef:0):t&&t.whitespace=="pre"?Qs|ef:n&~ks}class Gl{constructor(e,n,r,i,o,s){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=Te.none,this.match=o||(s&ks?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(P.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Qs)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let n=P.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(P.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!D1.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Km{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,o,s=Jm(null,n.preserveWhitespace,0)|(r?ks:0);i?o=new Gl(i.type,i.attrs,Te.none,!0,n.topMatch||i.type.contentMatch,s):r?o=new Gl(null,null,Te.none,!0,null,s):o=new Gl(e.schema.topNodeType,null,Te.none,!0,null,s),this.nodes=[o],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,o=i.options&ef?"full":this.localPreserveWS||(i.options&Qs)>0,{schema:s}=this.parser;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)if(o==="full")r=r.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(s.linebreakReplacement.create())){let l=r.split(/\r?\n|\r/);for(let a=0;a<l.length;a++)a&&this.insertNode(s.linebreakReplacement.create(),n,!0),l[a]&&this.insertNode(s.text(l[a]),n,!/\S/.test(l[a]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let l=i.content[i.content.length-1],a=e.previousSibling;(!l||a&&a.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(r=r.slice(1))}r&&this.insertNode(s.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),l;P1.hasOwnProperty(s)&&this.parser.normalizeLists&&iA(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,r));e:if(a?a.ignore:rA.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,n);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let u,c=this.needsBlock;if(D1.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),u=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let p=a&&a.skip?n:this.readStyles(e,n);p&&this.addAll(e,p),u&&this.sync(o),this.needsBlock=c}else{let u=this.readStyles(e,n);u&&this.addElementByRule(e,a,u,a.consuming===!1?l:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let l=void 0;;){let a=this.parser.matchStyle(o,s,this,l);if(!a)break;if(a.ignore)return null;if(a.clearMark?n=n.filter(u=>!a.clearMark(u)):n=n.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)l=a;else break}}return n}addElementByRule(e,n,r,i){let o,s;if(n.node)if(s=this.parser.schema.nodes[n.node],s.isLeaf)this.insertNode(s.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let a=this.enter(s,n.attrs||null,r,n.preserveWhitespace);a&&(o=!0,r=a)}else{let a=this.parser.schema.marks[n.mark];r=r.concat(a.create(n.attrs))}let l=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a,r,!1));else{let a=e;typeof n.contentElement=="string"?a=e.querySelector(n.contentElement):typeof n.contentElement=="function"?a=n.contentElement(e):n.contentElement&&(a=n.contentElement),this.findAround(e,a,!0),this.addAll(a,r),this.findAround(e,a,!1)}o&&this.sync(l)&&this.open--}addAll(e,n,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,l=i==null?null:e.childNodes[i];s!=l;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,n);this.findAtPoint(e,o)}findPlace(e,n,r){let i,o;for(let s=this.open,l=0;s>=0;s--){let a=this.nodes[s],u=a.findWrapping(e);if(u&&(!i||i.length>u.length+l)&&(i=u,o=a,!u.length))break;if(a.solid){if(r)break;l+=2}}if(!i)return null;this.sync(o);for(let s=0;s<i.length;s++)n=this.enterInner(i[s],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(n=this.enterInner(o,null,n))}let i=this.findPlace(e,n,r);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let s=Te.none;for(let l of i.concat(e.marks))(o.type?o.type.allowsMarkType(l.type):Xm(l.type,e.type))&&(s=l.addToSet(s));return o.content.push(e.mark(s)),!0}return!1}enter(e,n,r,i){let o=this.findPlace(e.create(n),r,!1);return o&&(o=this.enterInner(e,n,r,!0,i)),o}enterInner(e,n,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let l=Jm(e,o,s.options);s.options&ks&&s.content.length==0&&(l|=ks);let a=Te.none;return r=r.filter(u=>(s.type?s.type.allowsMarkType(u.type):Xm(u.type,e))?(a=u.addToSet(a),!1):!0),this.nodes.push(new Gl(e,n,a,i,null,l)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Qs)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(l,a)=>{for(;l>=0;l--){let u=n[l];if(u==""){if(l==n.length-1||l==0)continue;for(;a>=o;a--)if(s(l-1,a))return!0;return!1}else{let c=a>0||a==0&&i?this.nodes[a].type:r&&a>=o?r.node(a-o).type:null;if(!c||c.name!=u&&!c.isInGroup(u))return!1;a--}}return!0};return s(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function iA(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&P1.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function oA(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Ym(t){let e={};for(let n in t)e[n]=t[n];return e}function Xm(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let o=[],s=l=>{o.push(l);for(let a=0;a<l.edgeCount;a++){let{type:u,next:c}=l.edge(a);if(u==e||o.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}class Li{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=bc(n).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let l=0,a=0;for(;l<o.length&&a<s.marks.length;){let u=s.marks[a];if(!this.marks[u.type.name]){a++;continue}if(!u.eq(o[l][0])||u.type.spec.spanning===!1)break;l++,a++}for(;l<o.length;)i=o.pop()[1];for(;a<s.marks.length;){let u=s.marks[a++],c=this.serializeMark(u,s.isInline,n);c&&(o.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=pa(bc(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,n);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&pa(bc(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return pa(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Li(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=Qm(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return Qm(e.marks)}}function Qm(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function bc(t){return t.document||window.document}const Zm=new WeakMap;function sA(t){let e=Zm.get(t);return e===void 0&&Zm.set(t,e=lA(t)),e}function lA(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function pa(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=sA(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));let l,a=n?t.createElementNS(n,i):t.createElement(i),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let p in u)if(u[p]!=null){let m=p.indexOf(" ");m>0?a.setAttributeNS(p.slice(0,m),p.slice(m+1),u[p]):p=="style"&&a.style?a.style.cssText=u[p]:a.setAttribute(p,u[p])}}for(let p=c;p<e.length;p++){let m=e[p];if(m===0){if(p<e.length-1||p>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:g,contentDOM:y}=pa(t,m,n,r);if(a.appendChild(g),y){if(l)throw new RangeError("Multiple content holes");l=y}}}return{dom:a,contentDOM:l}}const L1=65535,O1=Math.pow(2,16);function aA(t,e){return t+e*O1}function eg(t){return t&L1}function uA(t){return(t-(t&L1))/O1}const F1=1,V1=2,ha=4,B1=8;class tf{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&B1)>0}get deletedBefore(){return(this.delInfo&(F1|ha))>0}get deletedAfter(){return(this.delInfo&(V1|ha))>0}get deletedAcross(){return(this.delInfo&ha)>0}}class Ft{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Ft.empty)return Ft.empty}recover(e){let n=0,r=eg(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+uA(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],p=a+u;if(e<=p){let m=u?e==a?-1:e==p?1:n:n,g=a+i+(m<0?0:c);if(r)return g;let y=e==(n<0?a:p)?null:aA(l/3,e-a),v=e==a?V1:e==p?F1:ha;return(n<0?e!=a:e!=p)&&(v|=B1),new tf(g,v,y)}i+=c-u}return r?e+i:new tf(e+i,0,null)}touches(e,n){let r=0,i=eg(n),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+n],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new Ft(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ft.empty:new Ft(e<0?[0,-e,0]:[0,0,e])}}Ft.empty=new Ft([]);class Zs{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Zs(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new Zs;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],l=s.mapResult(e,n);if(l.recover!=null){let a=this.getMirror(o);if(a!=null&&a>o&&a<this.to){o=a,e=this._maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new tf(e,i,null)}}const _c=Object.create(null);class mt{getMap(){return Ft.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=_c[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in _c)throw new RangeError("Duplicate use of step JSON ID "+e);return _c[e]=n,n.prototype.jsonID=e,n}}class ze{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new ze(e,null)}static fail(e){return new ze(null,e)}static fromReplace(e,n,r,i){try{return ze.ok(e.replace(n,r,i))}catch(o){if(o instanceof Ja)return ze.fail(o.message);throw o}}}function Op(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let o=t.child(i);o.content.size&&(o=o.copy(Op(o.content,e,o))),o.isInline&&(o=e(o,n,i)),r.push(o)}return P.fromArray(r)}class Er extends mt{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new W(Op(n.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),n.openStart,n.openEnd);return ze.fromReplace(e,this.from,this.to,o)}invert(){return new Rn(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Er(n.pos,r.pos,this.mark)}merge(e){return e instanceof Er&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Er(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Er(n.from,n.to,e.markFromJSON(n.mark))}}mt.jsonID("addMark",Er);class Rn extends mt{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new W(Op(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return ze.fromReplace(e,this.from,this.to,r)}invert(){return new Er(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Rn(n.pos,r.pos,this.mark)}merge(e){return e instanceof Rn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Rn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Rn(n.from,n.to,e.markFromJSON(n.mark))}}mt.jsonID("removeMark",Rn);class Tr extends mt{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return ze.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return ze.fromReplace(e,this.pos,this.pos+1,new W(P.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new Tr(this.pos,n.marks[i]);return new Tr(this.pos,this.mark)}}return new Ii(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Tr(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Tr(n.pos,e.markFromJSON(n.mark))}}mt.jsonID("addNodeMark",Tr);class Ii extends mt{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return ze.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return ze.fromReplace(e,this.pos,this.pos+1,new W(P.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new Tr(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ii(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ii(n.pos,e.markFromJSON(n.mark))}}mt.jsonID("removeNodeMark",Ii);class We extends mt{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&nf(e,this.from,this.to)?ze.fail("Structure replace would overwrite content"):ze.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Ft([this.from,this.to-this.from,this.slice.size])}invert(e){return new We(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new We(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof We)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?W.empty:new W(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new We(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?W.empty:new W(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new We(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new We(n.from,n.to,W.fromJSON(e,n.slice),!!n.structure)}}mt.jsonID("replace",We);class Ke extends mt{constructor(e,n,r,i,o,s,l=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(nf(e,this.from,this.gapFrom)||nf(e,this.gapTo,this.to)))return ze.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return ze.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?ze.fromReplace(e,this.from,this.to,r):ze.fail("Content does not fit in gap")}getMap(){return new Ft([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Ke(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||o>r.pos?null:new Ke(n.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ke(n.from,n.to,n.gapFrom,n.gapTo,W.fromJSON(e,n.slice),n.insert,!!n.structure)}}mt.jsonID("replaceAround",Ke);function nf(t,e,n){let r=t.resolve(e),i=n-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function cA(t,e,n,r){let i=[],o=[],s,l;t.doc.nodesBetween(e,n,(a,u,c)=>{if(!a.isInline)return;let p=a.marks;if(!r.isInSet(p)&&c.type.allowsMarkType(r.type)){let m=Math.max(u,e),g=Math.min(u+a.nodeSize,n),y=r.addToSet(p);for(let v=0;v<p.length;v++)p[v].isInSet(y)||(s&&s.to==m&&s.mark.eq(p[v])?s.to=g:i.push(s=new Rn(m,g,p[v])));l&&l.to==m?l.to=g:o.push(l=new Er(m,g,r))}}),i.forEach(a=>t.step(a)),o.forEach(a=>t.step(a))}function dA(t,e,n,r){let i=[],o=0;t.doc.nodesBetween(e,n,(s,l)=>{if(!s.isInline)return;o++;let a=null;if(r instanceof Ru){let u=s.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(s.marks)&&(a=[r]):a=s.marks;if(a&&a.length){let u=Math.min(l+s.nodeSize,n);for(let c=0;c<a.length;c++){let p=a[c],m;for(let g=0;g<i.length;g++){let y=i[g];y.step==o-1&&p.eq(i[g].style)&&(m=y)}m?(m.to=u,m.step=o):i.push({style:p,from:Math.max(l,e),to:u,step:o})}}}),i.forEach(s=>t.step(new Rn(s.from,s.to,s.style)))}function Fp(t,e,n,r=n.contentMatch,i=!0){let o=t.doc.nodeAt(e),s=[],l=e+1;for(let a=0;a<o.childCount;a++){let u=o.child(a),c=l+u.nodeSize,p=r.matchType(u.type);if(!p)s.push(new We(l,c,W.empty));else{r=p;for(let m=0;m<u.marks.length;m++)n.allowsMarkType(u.marks[m].type)||t.step(new Rn(l,c,u.marks[m]));if(i&&u.isText&&n.whitespace!="pre"){let m,g=/\r?\n|\r/g,y;for(;m=g.exec(u.text);)y||(y=new W(P.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),s.push(new We(l+m.index,l+m.index+m[0].length,y))}}l=c}if(!r.validEnd){let a=r.fillBefore(P.empty,!0);t.replace(l,l,new W(a,0,0))}for(let a=s.length-1;a>=0;a--)t.step(s[a])}function fA(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function qo(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,i=0,o=0;;--r){let s=t.$from.node(r),l=t.$from.index(r)+i,a=t.$to.indexAfter(r)-o;if(r<t.depth&&s.canReplace(l,a,n))return r;if(r==0||s.type.spec.isolating||!fA(s,l,a))break;l&&(i=1),a<s.childCount&&(o=1)}return null}function pA(t,e,n){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),l=i.after(o+1),a=s,u=l,c=P.empty,p=0;for(let y=o,v=!1;y>n;y--)v||r.index(y)>0?(v=!0,c=P.from(r.node(y).copy(c)),p++):a--;let m=P.empty,g=0;for(let y=o,v=!1;y>n;y--)v||i.after(y+1)<i.end(y)?(v=!0,m=P.from(i.node(y).copy(m)),g++):u++;t.step(new Ke(a,u,s,l,new W(c.append(m),p,g),c.size-p,!0))}function Vp(t,e,n=null,r=t){let i=hA(t,e),o=i&&mA(r,e);return o?i.map(tg).concat({type:e,attrs:n}).concat(o.map(tg)):null}function tg(t){return{type:t,attrs:null}}function hA(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return n.canReplaceWith(r,i,s)?o:null}function mA(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let a=(s.length?s[s.length-1]:e).contentMatch;for(let u=r;a&&u<i;u++)a=a.matchType(n.child(u).type);return!a||!a.validEnd?null:s}function gA(t,e,n){let r=P.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let l=n[s].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=P.from(n[s].type.create(n[s].attrs,r))}let i=e.start,o=e.end;t.step(new Ke(i,o,i,o,new W(r,0,0),n.length,!0))}function yA(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(e,n,(s,l)=>{let a=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,a)&&vA(t.doc,t.mapping.slice(o).map(l),r)){let u=null;if(r.schema.linebreakReplacement){let g=r.whitespace=="pre",y=!!r.contentMatch.matchType(r.schema.linebreakReplacement);g&&!y?u=!1:!g&&y&&(u=!0)}u===!1&&z1(t,s,l,o),Fp(t,t.mapping.slice(o).map(l,1),r,void 0,u===null);let c=t.mapping.slice(o),p=c.map(l,1),m=c.map(l+s.nodeSize,1);return t.step(new Ke(p,m,p+1,m-1,new W(P.from(r.create(a,null,s.marks)),0,0),1,!0)),u===!0&&U1(t,s,l,o),!1}})}function U1(t,e,n,r){e.forEach((i,o)=>{if(i.isText){let s,l=/\r?\n|\r/g;for(;s=l.exec(i.text);){let a=t.mapping.slice(r).map(n+1+o+s.index);t.replaceWith(a,a+1,e.type.schema.linebreakReplacement.create())}}})}function z1(t,e,n,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(r).map(n+1+o);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function vA(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function xA(t,e,n,r,i){let o=t.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");n||(n=o.type);let s=n.create(r,null,i||o.marks);if(o.isLeaf)return t.replaceWith(e,e+o.nodeSize,s);if(!n.validContent(o.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Ke(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new W(P.from(s),0,0),1,!0))}function Kn(t,e,n=1,r){let i=t.resolve(e),o=i.depth-n,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=n-2;u>o;u--,c--){let p=i.node(u),m=i.index(u);if(p.type.spec.isolating)return!1;let g=p.content.cutByIndex(m,p.childCount),y=r&&r[c+1];y&&(g=g.replaceChild(0,y.type.create(y.attrs)));let v=r&&r[c]||p;if(!p.canReplace(m+1,p.childCount)||!v.type.validContent(g))return!1}let l=i.indexAfter(o),a=r&&r[0];return i.node(o).canReplaceWith(l,l,a?a.type:i.node(o+1).type)}function wA(t,e,n=1,r){let i=t.doc.resolve(e),o=P.empty,s=P.empty;for(let l=i.depth,a=i.depth-n,u=n-1;l>a;l--,u--){o=P.from(i.node(l).copy(o));let c=r&&r[u];s=P.from(c?c.type.create(c.attrs,s):i.node(l).copy(s))}t.step(new We(e,e,new W(o.append(s),n,n),!0))}function jr(t,e){let n=t.resolve(e),r=n.index();return H1(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function SA(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?t.type.schema.nodes.text:o.type;if(n=n.matchType(s),!n||!t.type.allowsMarks(o.marks))return!1}return n.validEnd}function H1(t,e){return!!(t&&e&&!t.isLeaf&&SA(t,e))}function Du(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let o,s,l=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):n>0?(o=r.node(i+1),l++,s=r.node(i).maybeChild(l)):(o=r.node(i).maybeChild(l-1),s=r.node(i+1)),o&&!o.isTextblock&&H1(o,s)&&r.node(i).canReplace(l,l+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function CA(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,o=t.doc.resolve(e-n),s=o.node().type;if(i&&s.inlineContent){let c=s.whitespace=="pre",p=!!s.contentMatch.matchType(i);c&&!p?r=!1:!c&&p&&(r=!0)}let l=t.steps.length;if(r===!1){let c=t.doc.resolve(e+n);z1(t,c.node(),c.before(),l)}s.inlineContent&&Fp(t,e+n-1,s,o.node().contentMatchAt(o.index()),r==null);let a=t.mapping.slice(l),u=a.map(e-n);if(t.step(new We(u,a.map(e+n,-1),W.empty,!0)),r===!0){let c=t.doc.resolve(u);U1(t,c.node(),c.before(),t.steps.length)}return t}function EA(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,n))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,n))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function $1(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let o=0;o<n.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(n.openStart==0&&n.size?2:1);o++)for(let s=r.depth;s>=0;s--){let l=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,a=r.index(s)+(l>0?1:0),u=r.node(s),c=!1;if(o==1)c=u.canReplace(a,a,i);else{let p=u.contentMatchAt(a).findWrapping(i.firstChild.type);c=p&&u.canReplaceWith(a,a,p[0])}if(c)return l==0?r.pos:l<0?r.before(s+1):r.after(s+1)}return null}function Pu(t,e,n=e,r=W.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),o=t.resolve(n);return G1(i,o,r)?new We(e,n,r):new TA(i,o,r).fit()}function G1(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class TA{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=P.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=P.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new W(o,s,l);return e>-1?new Ke(r.pos,e,this.$to.pos,this.$to.end(),a,n):a.size||r.pos!=this.$to.pos?new We(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=n.firstChild;if(n.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}n=o.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Rc(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,p=null;if(n==1&&(s?u.matchType(s.type)||(p=u.fillBefore(P.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:p};if(n==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Rc(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new W(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Rc(e,n);if(i.childCount<=1&&n>0){let o=e.size-n<=n+i.size;this.unplaced=new W(fs(e,n-1,1),n-1,o?n-1:r)}else this.unplaced=new W(fs(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:o}){for(;this.depth>n;)this.closeFrontierNode();if(o)for(let v=0;v<o.length;v++)this.openFrontierNode(o[v]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:p,type:m}=this.frontier[n];if(i){for(let v=0;v<i.childCount;v++)c.push(i.child(v));p=p.matchFragment(i)}let g=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let v=l.child(u),w=p.matchType(v.type);if(!w)break;u++,(u>1||a==0||v.content.size)&&(p=w,c.push(q1(v.mark(m.allowedMarks(v.marks)),u==1?a:0,u==l.childCount?g:-1)))}let y=u==l.childCount;y||(g=-1),this.placed=ps(this.placed,n,P.from(c)),this.frontier[n].match=p,y&&g<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,w=l;v<g;v++){let x=w.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),w=x.content}this.unplaced=y?e==0?W.empty:new W(fs(s.content,e-1,1),e-1,g<0?s.openEnd:e-1):new W(fs(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Dc(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],o=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),s=Dc(e,n,i,r,o);if(s){for(let l=n-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=Dc(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:n,fit:s,move:o?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=ps(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=ps(this.placed,this.depth,P.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(P.empty,!0);n.childCount&&(this.placed=ps(this.placed,this.frontier.length,n))}}function fs(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(fs(t.firstChild.content,e-1,n)))}function ps(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(ps(t.lastChild.content,e-1,n)))}function Rc(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function q1(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,q1(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(P.empty,!0)))),t.copy(r)}function Dc(t,e,n,r,i){let o=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==o.childCount&&!n.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!NA(n,o.content,s)?l:null}function NA(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function kA(t){return t.spec.defining||t.spec.definingForContent}function AA(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),o=t.doc.resolve(n);if(G1(i,o,r))return t.step(new We(e,n,r));let s=j1(i,o);s[s.length-1]==0&&s.pop();let l=-(i.depth+1);s.unshift(l);for(let m=i.depth,g=i.pos-1;m>0;m--,g--){let y=i.node(m).type.spec;if(y.defining||y.definingAsContext||y.isolating)break;s.indexOf(m)>-1?l=m:i.before(m)==g&&s.splice(1,0,-m)}let a=s.indexOf(l),u=[],c=r.openStart;for(let m=r.content,g=0;;g++){let y=m.firstChild;if(u.push(y),g==r.openStart)break;m=y.content}for(let m=c-1;m>=0;m--){let g=u[m],y=kA(g.type);if(y&&!g.sameMarkup(i.node(Math.abs(l)-1)))c=m;else if(y||!g.type.isTextblock)break}for(let m=r.openStart;m>=0;m--){let g=(m+c+1)%(r.openStart+1),y=u[g];if(y)for(let v=0;v<s.length;v++){let w=s[(v+a)%s.length],x=!0;w<0&&(x=!1,w=-w);let E=i.node(w-1),C=i.index(w-1);if(E.canReplaceWith(C,C,y.type,y.marks))return t.replace(i.before(w),x?o.after(w):n,new W(W1(r.content,0,r.openStart,g),g,r.openEnd))}}let p=t.steps.length;for(let m=s.length-1;m>=0&&(t.replace(e,n,r),!(t.steps.length>p));m--){let g=s[m];g<0||(e=i.before(g),n=o.after(g))}}function W1(t,e,n,r,i){if(e<n){let o=t.firstChild;t=t.replaceChild(0,o.copy(W1(o.content,e+1,n,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(t).append(t);t=s.append(o.matchFragment(s).fillBefore(P.empty,!0))}return t}function IA(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=EA(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new W(P.from(r),0,0))}function MA(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),o=j1(r,i);for(let s=0;s<o.length;s++){let l=o[s],a=s==o.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return t.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return t.delete(r.before(l),i.after(l))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&n>r.end(s)&&i.end(s)-n!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return t.delete(r.before(s),n);t.delete(e,n)}function j1(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let o=t.start(i);if(o<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&n.push(i)}return n}class wo extends mt{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return ze.fail("No node at attribute step's position");let r=Object.create(null);for(let o in n.attrs)r[o]=n.attrs[o];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return ze.fromReplace(e,this.pos,this.pos+1,new W(P.from(i),0,n.isLeaf?0:1))}getMap(){return Ft.empty}invert(e){return new wo(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new wo(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new wo(n.pos,n.attr,n.value)}}mt.jsonID("attr",wo);class el extends mt{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return ze.ok(r)}getMap(){return Ft.empty}invert(e){return new el(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new el(n.attr,n.value)}}mt.jsonID("docAttr",el);let Ro=class extends Error{};Ro=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Ro.prototype=Object.create(Error.prototype);Ro.prototype.constructor=Ro;Ro.prototype.name="TransformError";class bA{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Zs}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Ro(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=W.empty){let i=Pu(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new W(P.from(r),0,0))}delete(e,n){return this.replace(e,n,W.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return AA(this,e,n,r),this}replaceRangeWith(e,n,r){return IA(this,e,n,r),this}deleteRange(e,n){return MA(this,e,n),this}lift(e,n){return pA(this,e,n),this}join(e,n=1){return CA(this,e,n),this}wrap(e,n){return gA(this,e,n),this}setBlockType(e,n=e,r,i=null){return yA(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return xA(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new wo(e,n,r)),this}setDocAttribute(e,n){return this.step(new el(e,n)),this}addNodeMark(e,n){return this.step(new Tr(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof Te)n.isInSet(r.marks)&&this.step(new Ii(e,n));else{let i=r.marks,o,s=[];for(;o=n.isInSet(i);)s.push(new Ii(e,o)),i=o.removeFromSet(i);for(let l=s.length-1;l>=0;l--)this.step(s[l])}return this}split(e,n=1,r){return wA(this,e,n,r),this}addMark(e,n,r){return cA(this,e,n,r),this}removeMark(e,n,r){return dA(this,e,n,r),this}clearIncompatible(e,n,r){return Fp(this,e,n,r),this}}const Pc=Object.create(null);class ae{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new _A(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=W.empty){let r=n.content.lastChild,i=null;for(let l=0;l<n.openEnd;l++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){let{$from:a,$to:u}=s[l],c=e.mapping.slice(o);e.replaceRange(c.map(a.pos),c.map(u.pos),l?W.empty:n),l==0&&ig(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:l}=i[o],a=e.mapping.slice(r),u=a.map(s.pos),c=a.map(l.pos);o?e.deleteRange(u,c):(e.replaceRangeWith(u,c,n),ig(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new le(e):ji(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=n<0?ji(e.node(0),e.node(o),e.before(o+1),e.index(o),n,r):ji(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,n,r);if(s)return s}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new Ut(e.node(0))}static atStart(e){return ji(e,e,0,0,1)||new Ut(e)}static atEnd(e){return ji(e,e,e.content.size,e.childCount,-1)||new Ut(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Pc[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Pc)throw new RangeError("Duplicate use of selection JSON ID "+e);return Pc[e]=n,n.prototype.jsonID=e,n}getBookmark(){return le.between(this.$anchor,this.$head).getBookmark()}}ae.prototype.visible=!0;class _A{constructor(e,n){this.$from=e,this.$to=n}}let ng=!1;function rg(t){!ng&&!t.parent.inlineContent&&(ng=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class le extends ae{constructor(e,n=e){rg(e),rg(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return ae.near(r);let i=e.resolve(n.map(this.anchor));return new le(i.parent.inlineContent?i:r,r)}replace(e,n=W.empty){if(super.replace(e,n),n==W.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof le&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Lu(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new le(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let o=ae.findFrom(n,r,!0)||ae.findFrom(n,-r,!0);if(o)n=o.$head;else return ae.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(ae.findFrom(e,-r,!0)||ae.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new le(e,n)}}ae.jsonID("text",le);class Lu{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Lu(e.map(this.anchor),e.map(this.head))}resolve(e){return le.between(e.resolve(this.anchor),e.resolve(this.head))}}class ne extends ae{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),o=e.resolve(i);return r?ae.near(o):new ne(o)}content(){return new W(P.from(this.node),0,0)}eq(e){return e instanceof ne&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Bp(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ne(e.resolve(n.anchor))}static create(e,n){return new ne(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ne.prototype.visible=!1;ae.jsonID("node",ne);class Bp{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Lu(r,r):new Bp(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&ne.isSelectable(r)?new ne(n):ae.near(n)}}class Ut extends ae{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=W.empty){if(n==W.empty){e.delete(0,e.doc.content.size);let r=ae.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new Ut(e)}map(e){return new Ut(e)}eq(e){return e instanceof Ut}getBookmark(){return RA}}ae.jsonID("all",Ut);const RA={map(){return this},resolve(t){return new Ut(t)}};function ji(t,e,n,r,i,o=!1){if(e.inlineContent)return le.create(t,n);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let l=e.child(s);if(l.isAtom){if(!o&&ne.isSelectable(l))return ne.create(t,n-(i<0?l.nodeSize:0))}else{let a=ji(t,l,n+i,i<0?l.childCount:0,i,o);if(a)return a}n+=l.nodeSize*i}return null}function ig(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof We||i instanceof Ke))return;let o=t.mapping.maps[r],s;o.forEach((l,a,u,c)=>{s==null&&(s=c)}),t.setSelection(ae.near(t.doc.resolve(s),n))}const og=1,ql=2,sg=4;class DA extends bA{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|og)&~ql,this.storedMarks=null,this}get selectionSet(){return(this.updated&og)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=ql,this}ensureMarks(e){return Te.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&ql)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~ql,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Te.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(n);o=r==n?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,o)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(ae.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=sg,this}get scrolledIntoView(){return(this.updated&sg)>0}}function lg(t,e){return!e||!t?t:t.bind(e)}class hs{constructor(e,n,r){this.name=e,this.init=lg(n.init,r),this.apply=lg(n.apply,r)}}const PA=[new hs("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new hs("selection",{init(t,e){return t.selection||ae.atStart(e.doc)},apply(t){return t.selection}}),new hs("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new hs("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Lc{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=PA.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new hs(r.key,r.spec.state,r))})}}class ao{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let l=this.config.plugins[s];if(l.spec.appendTransaction){let a=i?i[s].n:0,u=i?i[s].state:this,c=a<n.length&&l.spec.appendTransaction.call(l,a?n.slice(a):n,u,r);if(c&&r.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let p=0;p<this.config.plugins.length;p++)i.push(p<s?{state:r,n:n.length}:{state:this,n:0})}n.push(c),r=r.applyInner(c),o=!0}i&&(i[s]={state:r,n:n.length})}}if(!o)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new ao(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];n[o.name]=o.apply(e,this[o.name],this,n)}return n}get tr(){return new DA(this)}static create(e){let n=new Lc(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new ao(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new Lc(this.schema,e.plugins),r=n.fields,i=new ao(n);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(n[r]=o.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Lc(e.schema,e.plugins),o=new ao(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=Lr.fromJSON(e.schema,n.doc);else if(s.name=="selection")o.selection=ae.fromJSON(o.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(o.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],u=a.spec.state;if(a.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){o[s.name]=u.fromJSON.call(a,e,n[l],o);return}}o[s.name]=s.init(e,o)}}),o}}function J1(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=J1(i,e,{})),n[r]=i}return n}class Qe{constructor(e){this.spec=e,this.props={},e.props&&J1(e.props,this,this.props),this.key=e.key?e.key.key:K1("plugin")}getState(e){return e[this.key]}}const Oc=Object.create(null);function K1(t){return t in Oc?t+"$"+ ++Oc[t]:(Oc[t]=0,t+"$")}class Lt{constructor(e="key"){this.key=K1(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const tt=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Do=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let rf=null;const Hn=function(t,e,n){let r=rf||(rf=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},LA=function(){rf=null},Mi=function(t,e,n,r){return n&&(ag(t,e,n,r,-1)||ag(t,e,n,r,1))},OA=/^(img|br|input|textarea|hr)$/i;function ag(t,e,n,r,i){for(var o;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Zt(t))){let s=t.parentNode;if(!s||s.nodeType!=1||yl(t)||OA.test(t.nodeName)||t.contentEditable=="false")return!1;e=tt(t)+(i<0?0:1),t=s}else if(t.nodeType==1){let s=t.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((o=s.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)e+=i;else return!1;else t=s,e=i<0?Zt(t):0}else return!1}}function Zt(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function FA(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Zt(t)}else if(t.parentNode&&!yl(t))e=tt(t),t=t.parentNode;else return null}}function VA(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!yl(t))e=tt(t)+1,t=t.parentNode;else return null}}function BA(t,e,n){for(let r=e==0,i=e==Zt(t);r||i;){if(t==n)return!0;let o=tt(t);if(t=t.parentNode,!t)return!1;r=r&&o==0,i=i&&o==Zt(t)}}function yl(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Ou=function(t){return t.focusNode&&Mi(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function oi(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function UA(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function zA(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Zt(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Zt(r.startContainer),r.startOffset)}}}const On=typeof navigator<"u"?navigator:null,ug=typeof document<"u"?document:null,Jr=On&&On.userAgent||"",of=/Edge\/(\d+)/.exec(Jr),Y1=/MSIE \d/.exec(Jr),sf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Jr),_t=!!(Y1||sf||of),Fr=Y1?document.documentMode:sf?+sf[1]:of?+of[1]:0,nn=!_t&&/gecko\/(\d+)/i.test(Jr);nn&&+(/Firefox\/(\d+)/.exec(Jr)||[0,0])[1];const lf=!_t&&/Chrome\/(\d+)/.exec(Jr),je=!!lf,X1=lf?+lf[1]:0,pt=!_t&&!!On&&/Apple Computer/.test(On.vendor),Po=pt&&(/Mobile\/\w+/.test(Jr)||!!On&&On.maxTouchPoints>2),Kt=Po||(On?/Mac/.test(On.platform):!1),Q1=On?/Win/.test(On.platform):!1,Wn=/Android \d/.test(Jr),vl=!!ug&&"webkitFontSmoothing"in ug.documentElement.style,HA=vl?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function $A(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Un(t,e){return typeof t=="number"?t:t[e]}function GA(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function cg(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,o=t.dom.ownerDocument;for(let s=n||t.dom;s;){if(s.nodeType!=1){s=Do(s);continue}let l=s,a=l==o.body,u=a?$A(o):GA(l),c=0,p=0;if(e.top<u.top+Un(r,"top")?p=-(u.top-e.top+Un(i,"top")):e.bottom>u.bottom-Un(r,"bottom")&&(p=e.bottom-e.top>u.bottom-u.top?e.top+Un(i,"top")-u.top:e.bottom-u.bottom+Un(i,"bottom")),e.left<u.left+Un(r,"left")?c=-(u.left-e.left+Un(i,"left")):e.right>u.right-Un(r,"right")&&(c=e.right-u.right+Un(i,"right")),c||p)if(a)o.defaultView.scrollBy(c,p);else{let g=l.scrollLeft,y=l.scrollTop;p&&(l.scrollTop+=p),c&&(l.scrollLeft+=c);let v=l.scrollLeft-g,w=l.scrollTop-y;e={left:e.left-v,top:e.top-w,right:e.right-v,bottom:e.bottom-w}}let m=a?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(m))break;s=m=="absolute"?s.offsetParent:Do(s)}}function qA(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=n+1;s<Math.min(innerHeight,e.bottom);s+=5){let l=t.root.elementFromPoint(o,s);if(!l||l==t.dom||!t.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=n-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:Z1(t.dom)}}function Z1(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Do(r));return e}function WA({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;ew(n,r==0?0:r-e)}function ew(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:o}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let qi=null;function jA(t){if(t.setActive)return t.setActive();if(qi)return t.focus(qi);let e=Z1(t);t.focus(qi==null?{get preventScroll(){return qi={preventScroll:!0},!0}}:void 0),qi||(qi=!1,ew(e,0))}function tw(t,e){let n,r=2e8,i,o=0,s=e.top,l=e.top,a,u;for(let c=t.firstChild,p=0;c;c=c.nextSibling,p++){let m;if(c.nodeType==1)m=c.getClientRects();else if(c.nodeType==3)m=Hn(c).getClientRects();else continue;for(let g=0;g<m.length;g++){let y=m[g];if(y.top<=s&&y.bottom>=l){s=Math.max(y.bottom,s),l=Math.min(y.top,l);let v=y.left>e.left?y.left-e.left:y.right<e.left?e.left-y.right:0;if(v<r){n=c,r=v,i=v&&n.nodeType==3?{left:y.right<e.left?y.right:y.left,top:e.top}:e,c.nodeType==1&&v&&(o=p+(e.left>=(y.left+y.right)/2?1:0));continue}}else y.top>e.top&&!a&&y.left<=e.left&&y.right>=e.left&&(a=c,u={left:Math.max(y.left,Math.min(y.right,e.left)),top:y.top});!n&&(e.left>=y.right&&e.top>=y.top||e.left>=y.left&&e.top>=y.bottom)&&(o=p+1)}}return!n&&a&&(n=a,i=u,r=0),n&&n.nodeType==3?JA(n,i):!n||r&&n.nodeType==1?{node:t,offset:o}:tw(n,i)}function JA(t,e){let n=t.nodeValue.length,r=document.createRange(),i;for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let s=pr(r,1);if(s.top!=s.bottom&&Up(e,s)){i={node:t,offset:o+(e.left>=(s.left+s.right)/2?1:0)};break}}return r.detach(),i||{node:t,offset:0}}function Up(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function KA(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function YA(t,e,n){let{node:r,offset:i}=tw(e,n),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(r,i,o)}function XA(t,e,n,r){let i=-1;for(let o=e,s=!1;o!=t.dom;){let l=t.docView.nearestDesc(o,!0),a;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((a=l.dom.getBoundingClientRect()).width||a.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!s&&a.left>r.left||a.top>r.top?i=l.posBefore:(!s&&a.right<r.left||a.bottom<r.top)&&(i=l.posAfter),s=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter;o=l.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function nw(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),o=i;;){let s=t.childNodes[o];if(s.nodeType==1){let l=s.getClientRects();for(let a=0;a<l.length;a++){let u=l[a];if(Up(e,u))return nw(s,e,u)}}if((o=(o+1)%r)==i)break}return t}function QA(t,e){let n=t.dom.ownerDocument,r,i=0,o=zA(n,e.left,e.top);o&&({node:r,offset:i}=o);let s=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),l;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=t.dom.getBoundingClientRect();if(!Up(e,u)||(s=nw(t.dom,e,u),!s))return null}if(pt)for(let u=s;r&&u;u=Do(u))u.draggable&&(r=void 0);if(s=KA(s,e),r){if(nn&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],p;c.nodeName=="IMG"&&(p=c.getBoundingClientRect()).right<=e.left&&p.bottom>e.top&&i++}let u;vl&&i&&r.nodeType==1&&(u=r.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=XA(t,r,i,e))}l==null&&(l=YA(t,s,e));let a=t.docView.nearestDesc(s,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function dg(t){return t.top<t.bottom||t.left<t.right}function pr(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(dg(r))return r}return Array.prototype.find.call(n,dg)||t.getBoundingClientRect()}const ZA=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function rw(t,e,n){let{node:r,offset:i,atom:o}=t.docView.domFromPos(e,n<0?-1:1),s=vl||nn;if(r.nodeType==3)if(s&&(ZA.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let a=pr(Hn(r,i,i),n);if(nn&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let u=pr(Hn(r,i-1,i-1),-1);if(u.top==a.top){let c=pr(Hn(r,i,i+1),-1);if(c.top!=a.top)return is(c,c.left<u.left)}}return a}else{let a=i,u=i,c=n<0?1:-1;return n<0&&!i?(u++,c=-1):n>=0&&i==r.nodeValue.length?(a--,c=1):n<0?a--:u++,is(pr(Hn(r,a,u),c),c<0)}if(!t.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(n<0||i==Zt(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return Fc(a.getBoundingClientRect(),!1)}if(o==null&&i<Zt(r)){let a=r.childNodes[i];if(a.nodeType==1)return Fc(a.getBoundingClientRect(),!0)}return Fc(r.getBoundingClientRect(),n>=0)}if(o==null&&i&&(n<0||i==Zt(r))){let a=r.childNodes[i-1],u=a.nodeType==3?Hn(a,Zt(a)-(s?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(u)return is(pr(u,1),!1)}if(o==null&&i<Zt(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let u=a?a.nodeType==3?Hn(a,0,s?0:1):a.nodeType==1?a:null:null;if(u)return is(pr(u,-1),!0)}return is(pr(r.nodeType==3?Hn(r):r,-n),n>=0)}function is(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Fc(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function iw(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function eI(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return iw(t,e,()=>{let{node:o}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let l=t.docView.nearestDesc(o,!0);if(!l)break;if(l.node.isBlock){o=l.contentDOM||l.dom;break}o=l.dom.parentNode}let s=rw(t,i.pos,1);for(let l=o.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=Hn(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<a.length;u++){let c=a[u];if(c.bottom>c.top+1&&(n=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const tI=/[\u0590-\u08ac]/;function nI(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,l=t.domSelection();return l?!tI.test(r.parent.textContent)||!l.modify?n=="left"||n=="backward"?o:s:iw(t,e,()=>{let{focusNode:a,focusOffset:u,anchorNode:c,anchorOffset:p}=t.domSelectionRange(),m=l.caretBidiLevel;l.modify("move",n,"character");let g=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:y,focusOffset:v}=t.domSelectionRange(),w=y&&!g.contains(y.nodeType==1?y:y.parentNode)||a==y&&u==v;try{l.collapse(c,p),a&&(a!=c||u!=p)&&l.extend&&l.extend(a,u)}catch{}return m!=null&&(l.caretBidiLevel=m),w}):r.pos==r.start()||r.pos==r.end()}let fg=null,pg=null,hg=!1;function rI(t,e,n){return fg==e&&pg==n?hg:(fg=e,pg=n,hg=n=="up"||n=="down"?eI(t,e,n):nI(t,e,n))}const rn=0,mg=1,ci=2,Fn=3;class xl{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=rn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>tt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!n||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let l=i.children[s];if(l.size){i=l;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],l=o+s.size;if(l>e||s instanceof sw){i=e-o;break}o=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof ow&&o.side>=0;r--);if(n<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&n&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,n):{node:this.contentDOM,offset:o?tt(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,n):{node:this.contentDOM,offset:o?tt(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,l=0;;l++){let a=this.children[l],u=s+a.size;if(i==-1&&e<=u){let c=s+a.border;if(e>=c&&n<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,n,c);e=s;for(let p=l;p>0;p--){let m=this.children[p-1];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(1)){i=tt(m.dom)+1;break}e-=m.size}i==-1&&(i=0)}if(i>-1&&(u>n||l==this.children.length-1)){n=u;for(let c=l+1;c<this.children.length;c++){let p=this.children[c];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){o=tt(p.dom);break}n+=p.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let o=Math.min(e,n),s=Math.max(e,n);for(let g=0,y=0;g<this.children.length;g++){let v=this.children[g],w=y+v.size;if(o>y&&s<w)return v.setSelection(e-y-v.border,n-y-v.border,r,i);y=w}let l=this.domFromPos(e,e?-1:1),a=n==e?l:this.domFromPos(n,n?-1:1),u=r.root.getSelection(),c=r.domSelectionRange(),p=!1;if((nn||pt)&&e==n){let{node:g,offset:y}=l;if(g.nodeType==3){if(p=!!(y&&g.nodeValue[y-1]==`
`),p&&y==g.nodeValue.length)for(let v=g,w;v;v=v.parentNode){if(w=v.nextSibling){w.nodeName=="BR"&&(l=a={node:w.parentNode,offset:tt(w)+1});break}let x=v.pmViewDesc;if(x&&x.node&&x.node.isBlock)break}}else{let v=g.childNodes[y-1];p=v&&(v.nodeName=="BR"||v.contentEditable=="false")}}if(nn&&c.focusNode&&c.focusNode!=a.node&&c.focusNode.nodeType==1){let g=c.focusNode.childNodes[c.focusOffset];g&&g.contentEditable=="false"&&(i=!0)}if(!(i||p&&pt)&&Mi(l.node,l.offset,c.anchorNode,c.anchorOffset)&&Mi(a.node,a.offset,c.focusNode,c.focusOffset))return;let m=!1;if((u.extend||e==n)&&!(p&&nn)){u.collapse(l.node,l.offset);try{e!=n&&u.extend(a.node,a.offset),m=!0}catch{}}if(!m){if(e>n){let y=l;l=a,a=y}let g=document.createRange();g.setEnd(a.node,a.offset),g.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(g)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&n>=r:e<s&&n>r){let l=r+o.border,a=s-o.border;if(e>=l&&n<=a){this.dirty=e==r||n==s?ci:mg,e==l&&n==a&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Fn:o.markDirty(e-l,n-l);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?ci:Fn}r=s}this.dirty=ci}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?ci:mg;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class ow extends xl{constructor(e,n,r,i){let o,s=n.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!n.type.spec.raw){if(s.nodeType!=1){let l=document.createElement("span");l.appendChild(s),s=l}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=n,this.widget=n,o=this}matchesWidget(e){return this.dirty==rn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class iI extends xl{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class bi extends xl{constructor(e,n,r,i,o){super(e,[],r,i),this.mark=n,this.spec=o}static create(e,n,r,i){let o=i.nodeViews[n.type.name],s=o&&o(n,i,r);return(!s||!s.dom)&&(s=Li.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new bi(e,n,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Fn||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Fn&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=rn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=rn}}slice(e,n,r){let i=bi.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;n<s&&(o=uf(o,n,s,r)),e>0&&(o=uf(o,0,e,r));for(let l=0;l<o.length;l++)o[l].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Vr extends xl{constructor(e,n,r,i,o,s,l,a,u){super(e,[],o,s),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,n,r,i,o,s){let l=o.nodeViews[n.type.name],a,u=l&&l(n,o,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)},r,i),c=u&&u.dom,p=u&&u.contentDOM;if(n.isText){if(!c)c=document.createTextNode(n.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:p}=Li.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!p&&!n.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),n.type.spec.draggable&&(c.draggable=!0));let m=c;return c=uw(c,r,n),u?a=new oI(e,n,r,i,c,p||null,m,u,o,s+1):n.isText?new Fu(e,n,r,i,c,m,o):new Vr(e,n,r,i,c,p||null,m,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>P.empty)}return e}matchesNode(e,n,r){return this.dirty==rn&&e.eq(this.node)&&Qa(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,o=e.composing?this.localCompositionInfo(e,n):null,s=o&&o.pos>-1?o:null,l=o&&o.pos<0,a=new lI(this,s&&s.node,e);cI(this.node,this.innerDeco,(u,c,p)=>{u.spec.marks?a.syncToMarks(u.spec.marks,r,e):u.type.side>=0&&!p&&a.syncToMarks(c==this.node.childCount?Te.none:this.node.child(c).marks,r,e),a.placeWidget(u,e,i)},(u,c,p,m)=>{a.syncToMarks(u.marks,r,e);let g;a.findNodeMatch(u,c,p,m)||l&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(g=a.findIndexWithChild(o.node))>-1&&a.updateNodeAt(u,c,p,g,e)||a.updateNextNode(u,c,p,e,m,i)||a.addNode(u,c,p,e,i),i+=u.nodeSize}),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==ci)&&(s&&this.protectLocalComposition(e,s),lw(this.contentDOM,this.children,e),Po&&dI(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof le)||r<n||i>n+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,l=fI(this.node.content,s,r-n,i-n);return l<0?null:{node:o,pos:l,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let o=n;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new iI(this,o,n,i);e.input.compositionNodes.push(s),this.children=uf(this.children,r,r+i.length,e,s)}update(e,n,r,i){return this.dirty==Fn||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=rn}updateOuterDeco(e){if(Qa(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=aw(this.dom,this.nodeDOM,af(this.outerDeco,this.node,n),af(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function gg(t,e,n,r,i){uw(r,e,t);let o=new Vr(void 0,t,e,n,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class Fu extends Vr{constructor(e,n,r,i,o,s,l){super(e,n,r,i,o,null,s,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Fn||this.dirty!=rn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=rn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=rn,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),o=document.createTextNode(i.text);return new Fu(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Fn)}get domAtom(){return!1}isText(e){return this.node.text==e}}class sw extends xl{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==rn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class oI extends Vr{constructor(e,n,r,i,o,s,l,a,u,c){super(e,n,r,i,o,s,l,u,c),this.spec=a}update(e,n,r,i){if(this.dirty==Fn)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,n,r);return o&&this.updateInner(e,n,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function lw(t,e,n){let r=t.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],l=s.dom;if(l.parentNode==t){for(;l!=r;)r=yg(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(l,r);if(s instanceof bi){let a=r?r.previousSibling:t.lastChild;lw(s.contentDOM,s.children,n),r=a?a.nextSibling:t.firstChild}}for(;r;)r=yg(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const As=function(t){t&&(this.nodeName=t)};As.prototype=Object.create(null);const di=[new As];function af(t,e,n){if(t.length==0)return di;let r=n?di[0]:new As,i=[r];for(let o=0;o<t.length;o++){let s=t[o].type.attrs;if(s){s.nodeName&&i.push(r=new As(s.nodeName));for(let l in s){let a=s[l];a!=null&&(n&&i.length==1&&i.push(r=new As(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function aw(t,e,n,r){if(n==di&&r==di)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],l=n[o];if(o){let a;l&&l.nodeName==s.nodeName&&i!=t&&(a=i.parentNode)&&a.nodeName.toLowerCase()==s.nodeName||(a=document.createElement(s.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=di[0]),i=a}sI(i,l||di[0],s)}return i}function sI(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&t.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&t.classList.add(i[o]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function uw(t,e,n){return aw(t,t,di,af(e,n,t.nodeType!=1))}function Qa(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function yg(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class lI{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=aI(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=rn,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let u=this.top.children[a];if(u.matchesMark(e[o])&&!this.isLocked(u.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=bi.create(this.top,e[o],n,r);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,o++}}findNodeMatch(e,n,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,n,r))o=this.top.children.indexOf(s,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let u=this.top.children[l];if(u.matchesNode(e,n,r)&&!this.preMatch.matched.has(u)){o=l;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,n,r,i,o){let s=this.top.children[i];return s.dirty==Fn&&s.dom==s.contentDOM&&(s.dirty=ci),s.update(e,n,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,o,s){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof Vr){let u=this.preMatch.matched.get(a);if(u!=null&&u!=o)return!1;let c=a.dom,p,m=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=Fn&&Qa(n,a.outerDeco));if(!m&&a.update(e,n,r,i))return this.destroyBetween(this.index,l),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!m&&(p=this.recreateWrapper(a,e,n,r,i,s)))return this.destroyBetween(this.index,l),this.top.children[this.index]=p,p.contentDOM&&(p.dirty=ci,p.updateChildren(i,s+1),p.dirty=rn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,o,s){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Qa(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let l=Vr.create(this.top,n,r,i,o,s);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,n,r,i,o){let s=Vr.create(this.top,e,n,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new ow(this.top,e,n,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof bi;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Fu)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((pt||je)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new sw(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function aI(t,e){let n=e,r=n.children.length,i=t.childCount,o=new Map,s=[];e:for(;i>0;){let l;for(;;)if(r){let u=n.children[r-1];if(u instanceof bi)n=u,r=u.children.length;else{l=u,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let a=l.node;if(a){if(a!=t.child(i-1))break;--i,o.set(l,i),s.push(l)}}return{index:i,matched:o,matches:s.reverse()}}function uI(t,e){return t.type.side-e.type.side}function cI(t,e,n,r){let i=e.locals(t),o=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let c=t.child(u);r(c,i,e.forChild(o,c),u),o+=c.nodeSize}return}let s=0,l=[],a=null;for(let u=0;;){let c,p;for(;s<i.length&&i[s].to==o;){let w=i[s++];w.widget&&(c?(p||(p=[c])).push(w):c=w)}if(c)if(p){p.sort(uI);for(let w=0;w<p.length;w++)n(p[w],u,!!a)}else n(c,u,!!a);let m,g;if(a)g=-1,m=a,a=null;else if(u<t.childCount)g=u,m=t.child(u++);else break;for(let w=0;w<l.length;w++)l[w].to<=o&&l.splice(w--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)l.push(i[s++]);let y=o+m.nodeSize;if(m.isText){let w=y;s<i.length&&i[s].from<w&&(w=i[s].from);for(let x=0;x<l.length;x++)l[x].to<w&&(w=l[x].to);w<y&&(a=m.cut(w-o),m=m.cut(0,w-o),y=w,g=-1)}else for(;s<i.length&&i[s].to<y;)s++;let v=m.isInline&&!m.isLeaf?l.filter(w=>!w.inline):l.slice();r(m,v,e.forChild(o,m),g),o=y}}function dI(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function fI(t,e,n,r){for(let i=0,o=0;i<t.childCount&&o<=r;){let s=t.child(i++),l=o;if(o+=s.nodeSize,!s.isText)continue;let a=s.text;for(;i<t.childCount;){let u=t.child(i++);if(o+=u.nodeSize,!u.isText)break;a+=u.text}if(o>=n){if(o>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let u=l<r?a.lastIndexOf(e,r-l-1):-1;if(u>=0&&u+e.length+l>=n)return l+u;if(n==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function uf(t,e,n,r,i){let o=[];for(let s=0,l=0;s<t.length;s++){let a=t[s],u=l,c=l+=a.size;u>=n||c<=e?o.push(a):(u<e&&o.push(a.slice(0,e-u,r)),i&&(o.push(i),i=void 0),c>n&&o.push(a.slice(n-u,a.size,r)))}return o}function zp(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),o=i&&i.size==0,s=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,u;if(Ou(n)){for(a=s;i&&!i.node;)i=i.parent;let p=i.node;if(i&&p.isAtom&&ne.isSelectable(p)&&i.parent&&!(p.isInline&&BA(n.focusNode,n.focusOffset,i.dom))){let m=i.posBefore;u=new ne(s==m?l:r.resolve(m))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let p=s,m=s;for(let g=0;g<n.rangeCount;g++){let y=n.getRangeAt(g);p=Math.min(p,t.docView.posFromDOM(y.startContainer,y.startOffset,1)),m=Math.max(m,t.docView.posFromDOM(y.endContainer,y.endOffset,-1))}if(p<0)return null;[a,s]=m==t.state.selection.anchor?[m,p]:[p,m],l=r.resolve(s)}else a=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let c=r.resolve(a);if(!u){let p=e=="pointer"||t.state.selection.head<l.pos&&!o?1:-1;u=Hp(t,c,l,p)}return u}function cw(t){return t.editable?t.hasFocus():fw(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Yn(t,e=!1){let n=t.state.selection;if(dw(t,n),!!cw(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&je){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Mi(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)hI(t);else{let{anchor:r,head:i}=n,o,s;vg&&!(n instanceof le)&&(n.$from.parent.inlineContent||(o=xg(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(s=xg(t,n.to))),t.docView.setSelection(r,i,t,e),vg&&(o&&wg(o),s&&wg(s)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&pI(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const vg=pt||je&&X1<63;function xg(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,o=r?n.childNodes[r-1]:null;if(pt&&i&&i.contentEditable=="false")return Vc(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Vc(i);if(o)return Vc(o)}}function Vc(t){return t.contentEditable="true",pt&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function wg(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function pI(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!cw(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function hI(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,tt(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&_t&&Fr<=11&&(n.disabled=!0,n.disabled=!1)}function dw(t,e){if(e instanceof ne){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Sg(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Sg(t)}function Sg(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Hp(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||le.between(e,n,r)}function Cg(t){return t.editable&&!t.hasFocus()?!1:fw(t)}function fw(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function mI(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Mi(e.node,e.offset,n.anchorNode,n.anchorOffset)}function cf(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),o=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return o&&ae.findFrom(o,e)}function gr(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Eg(t,e,n){let r=t.state.selection;if(r instanceof le)if(n.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return gr(t,new le(r.$anchor,s))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=cf(t.state,e);return i&&i instanceof ne?gr(t,i):!1}else if(!(Kt&&n.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let l=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=t.docView.descAt(l))&&!s.contentDOM?ne.isSelectable(o)?gr(t,new ne(e<0?t.state.doc.resolve(i.pos-o.nodeSize):i)):vl?gr(t,new le(t.state.doc.resolve(e<0?l:l+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ne&&r.node.isInline)return gr(t,new le(e>0?r.$to:r.$from));{let i=cf(t.state,e);return i?gr(t,i):!1}}}function Za(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Is(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Wi(t,e){return e<0?gI(t):yI(t)}function gI(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,o,s=!1;for(nn&&n.nodeType==1&&r<Za(n)&&Is(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(n.nodeType!=1)break;{let l=n.childNodes[r-1];if(Is(l,-1))i=n,o=--r;else if(l.nodeType==3)n=l,r=n.nodeValue.length;else break}}else{if(pw(n))break;{let l=n.previousSibling;for(;l&&Is(l,-1);)i=n.parentNode,o=tt(l),l=l.previousSibling;if(l)n=l,r=Za(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}s?df(t,n,r):i&&df(t,i,o)}function yI(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Za(n),o,s;for(;;)if(r<i){if(n.nodeType!=1)break;let l=n.childNodes[r];if(Is(l,1))o=n,s=++r;else break}else{if(pw(n))break;{let l=n.nextSibling;for(;l&&Is(l,1);)o=l.parentNode,s=tt(l)+1,l=l.nextSibling;if(l)n=l,r=0,i=Za(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}o&&df(t,o,s)}function pw(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function vI(t,e){for(;t&&e==t.childNodes.length&&!yl(t);)e=tt(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function xI(t,e){for(;t&&!e&&!yl(t);)e=tt(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function df(t,e,n){if(e.nodeType!=3){let o,s;(s=vI(e,n))?(e=s,n=0):(o=xI(e,n))&&(e=o,n=o.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Ou(r)){let o=document.createRange();o.setEnd(e,n),o.setStart(e,n),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Yn(t)},50)}function Tg(t,e){let n=t.state.doc.resolve(e);if(!(je||Q1)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let o=t.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<n.end()){let o=t.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function Ng(t,e,n){let r=t.state.selection;if(r instanceof le&&!r.empty||n.indexOf("s")>-1||Kt&&n.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=cf(t.state,e);if(s&&s instanceof ne)return gr(t,s)}if(!i.parent.inlineContent){let s=e<0?i:o,l=r instanceof Ut?ae.near(s,e):ae.findFrom(s,e);return l?gr(t,l):!1}return!1}function kg(t,e){if(!(t.state.selection instanceof le))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(o&&!o.isText){let s=t.state.tr;return e<0?s.delete(n.pos-o.nodeSize,n.pos):s.delete(n.pos,n.pos+o.nodeSize),t.dispatch(s),!0}return!1}function Ag(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function wI(t){if(!pt||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Ag(t,r,"true"),setTimeout(()=>Ag(t,r,"false"),20)}return!1}function SI(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function CI(t,e){let n=e.keyCode,r=SI(e);if(n==8||Kt&&n==72&&r=="c")return kg(t,-1)||Wi(t,-1);if(n==46&&!e.shiftKey||Kt&&n==68&&r=="c")return kg(t,1)||Wi(t,1);if(n==13||n==27)return!0;if(n==37||Kt&&n==66&&r=="c"){let i=n==37?Tg(t,t.state.selection.from)=="ltr"?-1:1:-1;return Eg(t,i,r)||Wi(t,i)}else if(n==39||Kt&&n==70&&r=="c"){let i=n==39?Tg(t,t.state.selection.from)=="ltr"?1:-1:1;return Eg(t,i,r)||Wi(t,i)}else{if(n==38||Kt&&n==80&&r=="c")return Ng(t,-1,r)||Wi(t,-1);if(n==40||Kt&&n==78&&r=="c")return wI(t)||Ng(t,1,r)||Wi(t,1);if(r==(Kt?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function $p(t,e){t.someProp("transformCopied",g=>{e=g(e,t)});let n=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let g=r.firstChild;n.push(g.type.name,g.attrs!=g.type.defaultAttrs?g.attrs:null),r=g.content}let s=t.someProp("clipboardSerializer")||Li.fromSchema(t.state.schema),l=xw(),a=l.createElement("div");a.appendChild(s.serializeFragment(r,{document:l}));let u=a.firstChild,c,p=0;for(;u&&u.nodeType==1&&(c=vw[u.nodeName.toLowerCase()]);){for(let g=c.length-1;g>=0;g--){let y=l.createElement(c[g]);for(;a.firstChild;)y.appendChild(a.firstChild);a.appendChild(y),p++}u=a.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${o}${p?` -${p}`:""} ${JSON.stringify(n)}`);let m=t.someProp("clipboardTextSerializer",g=>g(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:m,slice:e}}function hw(t,e,n,r,i){let o=i.parent.type.spec.code,s,l;if(!n&&!e)return null;let a=!!e&&(r||o||!n);if(a){if(t.someProp("transformPastedText",m=>{e=m(e,o||r,t)}),o)return l=new W(P.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",m=>{l=m(l,t,!0)}),l;let p=t.someProp("clipboardTextParser",m=>m(e,i,r,t));if(p)l=p;else{let m=i.marks(),{schema:g}=t.state,y=Li.fromSchema(g);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let w=s.appendChild(document.createElement("p"));v&&w.appendChild(y.serializeNode(g.text(v,m)))})}}else t.someProp("transformPastedHTML",p=>{n=p(n,t)}),s=kI(n),vl&&AI(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let p=+c[3];p>0;p--){let m=s.firstChild;for(;m&&m.nodeType!=1;)m=m.nextSibling;if(!m)break;s=m}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||Or.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(m){return m.nodeName=="BR"&&!m.nextSibling&&m.parentNode&&!EI.test(m.parentNode.nodeName)?{ignore:!0}:null}})),c)l=II(Ig(l,+c[1],+c[2]),c[4]);else if(l=W.maxOpen(TI(l.content,i),!0),l.openStart||l.openEnd){let p=0,m=0;for(let g=l.content.firstChild;p<l.openStart&&!g.type.spec.isolating;p++,g=g.firstChild);for(let g=l.content.lastChild;m<l.openEnd&&!g.type.spec.isolating;m++,g=g.lastChild);l=Ig(l,p,m)}return t.someProp("transformPasted",p=>{l=p(l,t,a)}),l}const EI=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function TI(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),o,s=[];if(t.forEach(l=>{if(!s)return;let a=i.findWrapping(l.type),u;if(!a)return s=null;if(u=s.length&&o.length&&gw(a,o,l,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=yw(s[s.length-1],o.length));let c=mw(l,a);s.push(c),i=i.matchType(c.type),o=a}}),s)return P.from(s)}return t}function mw(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,P.from(t));return t}function gw(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let o=gw(t,e,n,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(P.from(mw(n,t,i+1))))}}function yw(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,yw(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(P.empty,!0);return t.copy(n.append(r))}function ff(t,e,n,r,i,o){let s=e<0?t.firstChild:t.lastChild,l=s.content;return t.childCount>1&&(o=0),i<r-1&&(l=ff(l,e,n,r,i+1,o)),i>=n&&(l=e<0?s.contentMatchAt(0).fillBefore(l,o<=i).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(P.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(l))}function Ig(t,e,n){return e<t.openStart&&(t=new W(ff(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new W(ff(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const vw={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Mg=null;function xw(){return Mg||(Mg=document.implementation.createHTMLDocument("title"))}let Bc=null;function NI(t){let e=window.trustedTypes;return e?(Bc||(Bc=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Bc.createHTML(t)):t}function kI(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=xw().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&vw[r[1].toLowerCase()])&&(t=i.map(o=>"<"+o+">").join("")+t+i.map(o=>"</"+o+">").reverse().join("")),n.innerHTML=NI(t),i)for(let o=0;o<i.length;o++)n=n.querySelector(i[o])||n;return n}function AI(t){let e=t.querySelectorAll(je?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function II(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:o,openEnd:s}=t;for(let l=r.length-2;l>=0;l-=2){let a=n.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=P.from(a.create(r[l+1],i)),o++,s++}return new W(i,o,s)}const wt={},St={},MI={touchstart:!0,touchmove:!0};class bI{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function _I(t){for(let e in wt){let n=wt[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{DI(t,r)&&!Gp(t,r)&&(t.editable||!(r.type in St))&&n(t,r)},MI[e]?{passive:!0}:void 0)}pt&&t.dom.addEventListener("input",()=>null),pf(t)}function Nr(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function RI(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function pf(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Gp(t,r))})}function Gp(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function DI(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function PI(t,e){!Gp(t,e)&&wt[e.type]&&(t.editable||!(e.type in St))&&wt[e.type](t,e)}St.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!Sw(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Wn&&je&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Po&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,oi(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||CI(t,n)?n.preventDefault():Nr(t,"key")};St.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};St.keypress=(t,e)=>{let n=e;if(Sw(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Kt&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof le)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode),o=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",s=>s(t,r.$from.pos,r.$to.pos,i,o))&&t.dispatch(o()),n.preventDefault()}};function Vu(t){return{left:t.clientX,top:t.clientY}}function LI(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function qp(t,e,n,r,i){if(r==-1)return!1;let o=t.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(t.someProp(e,l=>s>o.depth?l(t,n,o.nodeAfter,o.before(s),i,!0):l(t,n,o.node(s),o.before(s),i,!1)))return!0;return!1}function So(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function OI(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&ne.isSelectable(r)?(So(t,new ne(n)),!0):!1}function FI(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof ne&&(r=n.node);let o=t.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let l=s>o.depth?o.nodeAfter:o.node(s);if(ne.isSelectable(l)){r&&n.$from.depth>0&&s>=n.$from.depth&&o.before(n.$from.depth+1)==n.$from.pos?i=o.before(n.$from.depth):i=o.before(s);break}}return i!=null?(So(t,ne.create(t.state.doc,i)),!0):!1}function VI(t,e,n,r,i){return qp(t,"handleClickOn",e,n,r)||t.someProp("handleClick",o=>o(t,e,r))||(i?FI(t,n):OI(t,n))}function BI(t,e,n,r){return qp(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function UI(t,e,n,r){return qp(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||zI(t,n,r)}function zI(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(So(t,le.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),l=i.before(o);if(s.inlineContent)So(t,le.create(r,l+1,l+1+s.content.size));else if(ne.isSelectable(s))So(t,ne.create(r,l));else continue;return!0}}function Wp(t){return eu(t)}const ww=Kt?"metaKey":"ctrlKey";wt.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Wp(t),i=Date.now(),o="singleClick";i-t.input.lastClick.time<500&&LI(n,t.input.lastClick)&&!n[ww]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?o="doubleClick":t.input.lastClick.type=="doubleClick"&&(o="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:o,button:n.button};let s=t.posAtCoords(Vu(n));s&&(o=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new HI(t,s,n,!!r)):(o=="doubleClick"?BI:UI)(t,s.pos,s.inside,n)?n.preventDefault():Nr(t,"pointer"))};class HI{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[ww],this.allowDefault=r.shiftKey;let o,s;if(n.inside>-1)o=e.state.doc.nodeAt(n.inside),s=n.inside;else{let c=e.state.doc.resolve(n.pos);o=c.parent,s=c.depth?c.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.nodeDOM.nodeType==1?a.nodeDOM:null;let{selection:u}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||u instanceof ne&&u.from<=s&&u.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&nn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Nr(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Yn(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Vu(e))),this.updateAllowDefault(e),this.allowDefault||!n?Nr(this.view,"pointer"):VI(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||pt&&this.mightDrag&&!this.mightDrag.node.isAtom||je&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(So(this.view,ae.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):Nr(this.view,"pointer")}move(e){this.updateAllowDefault(e),Nr(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}wt.touchstart=t=>{t.input.lastTouch=Date.now(),Wp(t),Nr(t,"pointer")};wt.touchmove=t=>{t.input.lastTouch=Date.now(),Nr(t,"pointer")};wt.contextmenu=t=>Wp(t);function Sw(t,e){return t.composing?!0:pt&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const $I=Wn?5e3:-1;St.compositionstart=St.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof le&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||je&&Q1&&GI(t)))t.markCursor=t.state.storedMarks||n.marks(),eu(t,!0),t.markCursor=null;else if(eu(t,!e.selection.empty),nn&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let l=t.domSelection();l&&l.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}t.input.composing=!0}Cw(t,$I)};function GI(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}St.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Cw(t,20))};function Cw(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>eu(t),e))}function Ew(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=WI());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function qI(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=FA(e.focusNode,e.focusOffset),r=VA(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let s=n.pmViewDesc;if(!(!s||!s.isText(n.nodeValue)))return r}}return n||r}function WI(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function eu(t,e=!1){if(!(Wn&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Ew(t),e||t.docView&&t.docView.dirty){let n=zp(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function jI(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const tl=_t&&Fr<15||Po&&HA<604;wt.copy=St.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let o=tl?null:n.clipboardData,s=r.content(),{dom:l,text:a}=$p(t,s);o?(n.preventDefault(),o.clearData(),o.setData("text/html",l.innerHTML),o.setData("text/plain",a)):jI(t,l),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function JI(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function KI(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?nl(t,r.value,null,i,e):nl(t,r.textContent,r.innerHTML,i,e)},50)}function nl(t,e,n,r,i){let o=hw(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",a=>a(t,i,o||W.empty)))return!0;if(!o)return!1;let s=JI(o),l=s?t.state.tr.replaceSelectionWith(s,r):t.state.tr.replaceSelection(o);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Tw(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}St.paste=(t,e)=>{let n=e;if(t.composing&&!Wn)return;let r=tl?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&nl(t,Tw(r),r.getData("text/html"),i,n)?n.preventDefault():KI(t,n)};class Nw{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const YI=Kt?"altKey":"ctrlKey";function kw(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[YI]}wt.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,o=i.empty?null:t.posAtCoords(Vu(n)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof ne?i.to-1:i.to))){if(r&&r.mightDrag)s=ne.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let p=t.docView.nearestDesc(n.target,!0);p&&p.node.type.spec.draggable&&p!=t.docView&&(s=ne.create(t.state.doc,p.posBefore))}}let l=(s||t.state.selection).content(),{dom:a,text:u,slice:c}=$p(t,l);(!n.dataTransfer.files.length||!je||X1>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(tl?"Text":"text/html",a.innerHTML),n.dataTransfer.effectAllowed="copyMove",tl||n.dataTransfer.setData("text/plain",u),t.dragging=new Nw(c,kw(t,n),s)};wt.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};St.dragover=St.dragenter=(t,e)=>e.preventDefault();St.drop=(t,e)=>{try{XI(t,e,t.dragging)}finally{t.dragging=null}};function XI(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(Vu(e));if(!r)return;let i=t.state.doc.resolve(r.pos),o=n&&n.slice;o?t.someProp("transformPasted",g=>{o=g(o,t,!1)}):o=hw(t,Tw(e.dataTransfer),tl?null:e.dataTransfer.getData("text/html"),!1,i);let s=!!(n&&kw(t,e));if(t.someProp("handleDrop",g=>g(t,e,o||W.empty,s))){e.preventDefault();return}if(!o)return;e.preventDefault();let l=o?$1(t.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let a=t.state.tr;if(s){let{node:g}=n;g?g.replace(a):a.deleteSelection()}let u=a.mapping.map(l),c=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,p=a.doc;if(c?a.replaceRangeWith(u,u,o.content.firstChild):a.replaceRange(u,u,o),a.doc.eq(p))return;let m=a.doc.resolve(u);if(c&&ne.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))a.setSelection(new ne(m));else{let g=a.mapping.map(l);a.mapping.maps[a.mapping.maps.length-1].forEach((y,v,w,x)=>g=x),a.setSelection(Hp(t,m,a.doc.resolve(g)))}t.focus(),t.dispatch(a.setMeta("uiEvent","drop"))}wt.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Yn(t)},20))};wt.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};wt.beforeinput=(t,e)=>{if(je&&Wn&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",o=>o(t,oi(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in St)wt[t]=St[t];function rl(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class tu{constructor(e,n){this.toDOM=e,this.spec=n||gi,this.side=this.spec.side||0}map(e,n,r,i){let{pos:o,deleted:s}=e.mapResult(n.from+i,this.side<0?-1:1);return s?null:new At(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof tu&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&rl(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Br{constructor(e,n){this.attrs=e,this.spec=n||gi}map(e,n,r,i){let o=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new At(o,s,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Br&&rl(this.attrs,e.attrs)&&rl(this.spec,e.spec)}static is(e){return e.type instanceof Br}destroy(){}}class jp{constructor(e,n){this.attrs=e,this.spec=n||gi}map(e,n,r,i){let o=e.mapResult(n.from+i,1);if(o.deleted)return null;let s=e.mapResult(n.to+i,-1);return s.deleted||s.pos<=o.pos?null:new At(o.pos-r,s.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),o;return i==n.from&&!(o=e.child(r)).isText&&i+o.nodeSize==n.to}eq(e){return this==e||e instanceof jp&&rl(this.attrs,e.attrs)&&rl(this.spec,e.spec)}destroy(){}}class At{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new At(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new At(e,e,new tu(n,r))}static inline(e,n,r,i){return new At(e,n,new Br(r,i))}static node(e,n,r,i){return new At(e,n,new jp(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Br}get widget(){return this.type instanceof tu}}const Ji=[],gi={};class Ve{constructor(e,n){this.local=e.length?e:Ji,this.children=n.length?n:Ji}static create(e,n){return n.length?nu(n,e,0,gi):ut}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,o){for(let s=0;s<this.local.length;s++){let l=this.local[s];l.from<=n&&l.to>=e&&(!o||o(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<n&&this.children[s+1]>e){let l=this.children[s]+1;this.children[s+2].findInner(e-l,n-l,r,i+l,o)}}map(e,n,r){return this==ut||e.maps.length==0?this:this.mapInner(e,n,0,0,r||gi)}mapInner(e,n,r,i,o){let s;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(n,a)?(s||(s=[])).push(a):o.onRemove&&o.onRemove(this.local[l].spec)}return this.children.length?QI(this.children,s||[],e,n,r,i,o):s?new Ve(s.sort(yi),Ji):ut}add(e,n){return n.length?this==ut?Ve.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,o=0;e.forEach((l,a)=>{let u=a+r,c;if(c=Iw(n,l,u)){for(i||(i=this.children.slice());o<i.length&&i[o]<a;)o+=3;i[o]==a?i[o+2]=i[o+2].addInner(l,c,u+1):i.splice(o,0,a,a+l.nodeSize,nu(c,l,u+1,gi)),o+=3}});let s=Aw(o?Mw(n):n,-r);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||s.splice(l--,1);return new Ve(s.length?this.local.concat(s).sort(yi):this.local,i||this.children)}remove(e){return e.length==0||this==ut?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,l=r[o]+n,a=r[o+1]+n;for(let c=0,p;c<e.length;c++)(p=e[c])&&p.from>l&&p.to<a&&(e[c]=null,(s||(s=[])).push(p));if(!s)continue;r==this.children&&(r=this.children.slice());let u=r[o+2].removeInner(s,l+1);u!=ut?r[o+2]=u:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let l=0;l<i.length;l++)i[l].eq(s,n)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Ve(i,r):ut}forChild(e,n){if(this==ut)return this;if(n.isLeaf)return Ve.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let o=e+1,s=o+n.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<s&&a.to>o&&a.type instanceof Br){let u=Math.max(o,a.from)-o,c=Math.min(s,a.to)-o;u<c&&(i||(i=[])).push(a.copy(u,c))}}if(i){let l=new Ve(i.sort(yi),Ji);return r?new wr([l,r]):l}return r||ut}eq(e){if(this==e)return!0;if(!(e instanceof Ve)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Jp(this.localsInner(e))}localsInner(e){if(this==ut)return Ji;if(e.inlineContent||!this.local.some(Br.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Br||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Ve.empty=new Ve([],[]);Ve.removeOverlap=Jp;const ut=Ve.empty;class wr{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,gi));return wr.from(r)}forChild(e,n){if(n.isLeaf)return Ve.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,n);o!=ut&&(o instanceof wr?r=r.concat(o.members):r.push(o))}return wr.from(r)}eq(e){if(!(e instanceof wr)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!n)n=o;else{r&&(n=n.slice(),r=!1);for(let s=0;s<o.length;s++)n.push(o[s])}}return n?Jp(r?n:n.sort(yi)):Ji}static from(e){switch(e.length){case 0:return ut;case 1:return e[0];default:return new wr(e.every(n=>n instanceof Ve)?e:e.reduce((n,r)=>n.concat(r instanceof Ve?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function QI(t,e,n,r,i,o,s){let l=t.slice();for(let u=0,c=o;u<n.maps.length;u++){let p=0;n.maps[u].forEach((m,g,y,v)=>{let w=v-y-(g-m);for(let x=0;x<l.length;x+=3){let E=l[x+1];if(E<0||m>E+c-p)continue;let C=l[x]+c-p;g>=C?l[x+1]=m<=C?-2:-1:m>=c&&w&&(l[x]+=w,l[x+1]+=w)}p+=w}),c=n.maps[u].map(c,-1)}let a=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){a=!0,l[u+1]=-1;continue}let c=n.map(t[u]+o),p=c-i;if(p<0||p>=r.content.size){a=!0;continue}let m=n.map(t[u+1]+o,-1),g=m-i,{index:y,offset:v}=r.content.findIndex(p),w=r.maybeChild(y);if(w&&v==p&&v+w.nodeSize==g){let x=l[u+2].mapInner(n,w,c+1,t[u]+o+1,s);x!=ut?(l[u]=p,l[u+1]=g,l[u+2]=x):(l[u+1]=-2,a=!0)}else a=!0}if(a){let u=ZI(l,t,e,n,i,o,s),c=nu(u,r,0,s);e=c.local;for(let p=0;p<l.length;p+=3)l[p+1]<0&&(l.splice(p,3),p-=3);for(let p=0,m=0;p<c.children.length;p+=3){let g=c.children[p];for(;m<l.length&&l[m]<g;)m+=3;l.splice(m,0,c.children[p],c.children[p+1],c.children[p+2])}}return new Ve(e.sort(yi),l)}function Aw(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new At(i.from+e,i.to+e,i.type))}return n}function ZI(t,e,n,r,i,o,s){function l(a,u){for(let c=0;c<a.local.length;c++){let p=a.local[c].map(r,i,u);p?n.push(p):s.onRemove&&s.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+u+1)}for(let a=0;a<t.length;a+=3)t[a+1]==-1&&l(t[a+2],e[a]+o+1);return n}function Iw(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let o=0,s;o<t.length;o++)(s=t[o])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),t[o]=null);return i}function Mw(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function nu(t,e,n,r){let i=[],o=!1;e.forEach((l,a)=>{let u=Iw(t,l,a+n);if(u){o=!0;let c=nu(u,l,n+a+1,r);c!=ut&&i.push(a,a+l.nodeSize,c)}});let s=Aw(o?Mw(t):t,-n).sort(yi);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||(r.onRemove&&r.onRemove(s[l].spec),s.splice(l--,1));return s.length||i.length?new Ve(s,i):ut}function yi(t,e){return t.from-e.from||t.to-e.to}function Jp(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==t&&(e=t.slice()),e[i]=o.copy(o.from,r.to),bg(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,o.from),bg(e,i,r.copy(o.from,r.to)));break}}}return e}function bg(t,e,n){for(;e<t.length&&yi(n,t[e])>0;)e++;t.splice(e,0,n)}function Uc(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=ut&&e.push(r)}),t.cursorWrapper&&e.push(Ve.create(t.state.doc,[t.cursorWrapper.deco])),wr.from(e)}const eM={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},tM=_t&&Fr<=11;class nM{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class rM{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new nM,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);_t&&Fr<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),tM&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,eM)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Cg(this.view)){if(this.suppressingSelectionUpdates)return Yn(this.view);if(_t&&Fr<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Mi(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let o=e.focusNode;o;o=Do(o))n.add(o);for(let o=e.anchorNode;o;o=Do(o))if(n.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Cg(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,l=!1,a=[];if(e.editable)for(let c=0;c<n.length;c++){let p=this.registerMutation(n[c],a);p&&(o=o<0?p.from:Math.min(p.from,o),s=s<0?p.to:Math.max(p.to,s),p.typeOver&&(l=!0))}if(nn&&a.length){let c=a.filter(p=>p.nodeName=="BR");if(c.length==2){let[p,m]=c;p.parentNode&&p.parentNode.parentNode==m.parentNode?m.remove():p.remove()}else{let{focusNode:p}=this.currentSelection;for(let m of c){let g=m.parentNode;g&&g.nodeName=="LI"&&(!p||sM(e,p)!=g)&&m.remove()}}}else if((je||pt)&&a.some(c=>c.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let c of a)if(c.nodeName=="BR"&&c.parentNode){let p=c.nextSibling;p&&p.nodeType==1&&p.contentEditable=="false"&&c.parentNode.removeChild(c)}}let u=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Ou(r)&&(u=zp(e))&&u.eq(ae.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Yn(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),iM(e)),this.handleDOMChange(o,s,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Yn(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let p=e.addedNodes[c];n.push(p),p.nodeType==3&&(this.lastChangedTextNode=p)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(_t&&Fr<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:p,nextSibling:m}=e.addedNodes[c];(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(i=p),(!m||Array.prototype.indexOf.call(e.addedNodes,m)<0)&&(o=m)}let s=i&&i.parentNode==e.target?tt(i)+1:0,l=r.localPosFromDOM(e.target,s,-1),a=o&&o.parentNode==e.target?tt(o):e.target.childNodes.length,u=r.localPosFromDOM(e.target,a,1);return{from:l,to:u}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let _g=new WeakMap,Rg=!1;function iM(t){if(!_g.has(t)&&(_g.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=nn,Rg)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Rg=!0}}function Dg(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return Mi(s.node,s.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}function oM(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return Dg(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?Dg(t,n):null}function sM(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function lM(t,e,n){let{node:r,fromOffset:i,toOffset:o,from:s,to:l}=t.docView.parseRange(e,n),a=t.domSelectionRange(),u,c=a.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:a.anchorOffset}],Ou(a)||u.push({node:a.focusNode,offset:a.focusOffset})),je&&t.input.lastKeyCode===8)for(let w=o;w>i;w--){let x=r.childNodes[w-1],E=x.pmViewDesc;if(x.nodeName=="BR"&&!E){o=w;break}if(!E||E.size)break}let p=t.state.doc,m=t.someProp("domParser")||Or.fromSchema(t.state.schema),g=p.resolve(s),y=null,v=m.parse(r,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:o,preserveWhitespace:g.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:aM,context:g});if(u&&u[0].pos!=null){let w=u[0].pos,x=u[1]&&u[1].pos;x==null&&(x=w),y={anchor:w+s,head:x+s}}return{doc:v,sel:y,from:s,to:l}}function aM(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(pt&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||pt&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const uM=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function cM(t,e,n,r,i){let o=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let k=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,I=zp(t,k);if(I&&!t.state.selection.eq(I)){if(je&&Wn&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",M=>M(t,oi(13,"Enter"))))return;let R=t.state.tr.setSelection(I);k=="pointer"?R.setMeta("pointer",!0):k=="key"&&R.scrollIntoView(),o&&R.setMeta("composition",o),t.dispatch(R)}return}let s=t.state.doc.resolve(e),l=s.sharedDepth(n);e=s.before(l+1),n=t.state.doc.resolve(n).after(l+1);let a=t.state.selection,u=lM(t,e,n),c=t.state.doc,p=c.slice(u.from,u.to),m,g;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(m=t.state.selection.to,g="end"):(m=t.state.selection.from,g="start"),t.input.lastKeyCode=null;let y=pM(p.content,u.doc.content,u.from,m,g);if(y&&t.input.domChangeCount++,(Po&&t.input.lastIOSEnter>Date.now()-225||Wn)&&i.some(k=>k.nodeType==1&&!uM.test(k.nodeName))&&(!y||y.endA>=y.endB)&&t.someProp("handleKeyDown",k=>k(t,oi(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!y)if(r&&a instanceof le&&!a.empty&&a.$head.sameParent(a.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))y={start:a.from,endA:a.to,endB:a.to};else{if(u.sel){let k=Pg(t,t.state.doc,u.sel);if(k&&!k.eq(t.state.selection)){let I=t.state.tr.setSelection(k);o&&I.setMeta("composition",o),t.dispatch(I)}}return}t.state.selection.from<t.state.selection.to&&y.start==y.endB&&t.state.selection instanceof le&&(y.start>t.state.selection.from&&y.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?y.start=t.state.selection.from:y.endA<t.state.selection.to&&y.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(y.endB+=t.state.selection.to-y.endA,y.endA=t.state.selection.to)),_t&&Fr<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>u.from&&u.doc.textBetween(y.start-u.from-1,y.start-u.from+1)==" "&&(y.start--,y.endA--,y.endB--);let v=u.doc.resolveNoCache(y.start-u.from),w=u.doc.resolveNoCache(y.endB-u.from),x=c.resolve(y.start),E=v.sameParent(w)&&v.parent.inlineContent&&x.end()>=y.endA;if((Po&&t.input.lastIOSEnter>Date.now()-225&&(!E||i.some(k=>k.nodeName=="DIV"||k.nodeName=="P"))||!E&&v.pos<u.doc.content.size&&(!v.sameParent(w)||!v.parent.inlineContent)&&v.pos<w.pos&&!/\S/.test(u.doc.textBetween(v.pos,w.pos,"","")))&&t.someProp("handleKeyDown",k=>k(t,oi(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>y.start&&fM(c,y.start,y.endA,v,w)&&t.someProp("handleKeyDown",k=>k(t,oi(8,"Backspace")))){Wn&&je&&t.domObserver.suppressSelectionUpdates();return}je&&y.endB==y.start&&(t.input.lastChromeDelete=Date.now()),Wn&&!E&&v.start()!=w.start()&&w.parentOffset==0&&v.depth==w.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==y.endA&&(y.endB-=2,w=u.doc.resolveNoCache(y.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(k){return k(t,oi(13,"Enter"))})},20));let C=y.start,S=y.endA,N=k=>{let I=k||t.state.tr.replace(C,S,u.doc.slice(y.start-u.from,y.endB-u.from));if(u.sel){let R=Pg(t,I.doc,u.sel);R&&!(je&&t.composing&&R.empty&&(y.start!=y.endB||t.input.lastChromeDelete<Date.now()-100)&&(R.head==C||R.head==I.mapping.map(S)-1)||_t&&R.empty&&R.head==C)&&I.setSelection(R)}return o&&I.setMeta("composition",o),I.scrollIntoView()},T;if(E)if(v.pos==w.pos){_t&&Fr<=11&&v.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Yn(t),20));let k=N(t.state.tr.delete(C,S)),I=c.resolve(y.start).marksAcross(c.resolve(y.endA));I&&k.ensureMarks(I),t.dispatch(k)}else if(y.endA==y.endB&&(T=dM(v.parent.content.cut(v.parentOffset,w.parentOffset),x.parent.content.cut(x.parentOffset,y.endA-x.start())))){let k=N(t.state.tr);T.type=="add"?k.addMark(C,S,T.mark):k.removeMark(C,S,T.mark),t.dispatch(k)}else if(v.parent.child(v.index()).isText&&v.index()==w.index()-(w.textOffset?0:1)){let k=v.parent.textBetween(v.parentOffset,w.parentOffset),I=()=>N(t.state.tr.insertText(k,C,S));t.someProp("handleTextInput",R=>R(t,C,S,k,I))||t.dispatch(I())}else t.dispatch(N());else t.dispatch(N())}function Pg(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Hp(t,e.resolve(n.anchor),e.resolve(n.head))}function dM(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,o=r,s,l,a;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<n.length;c++)o=n[c].removeFromSet(o);if(i.length==1&&o.length==0)l=i[0],s="add",a=c=>c.mark(l.addToSet(c.marks));else if(i.length==0&&o.length==1)l=o[0],s="remove",a=c=>c.mark(l.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(a(e.child(c)));if(P.from(u).eq(t))return{mark:l,type:s}}function fM(t,e,n,r,i){if(n-e<=i.pos-r.pos||zc(r,!0,!1)<i.pos)return!1;let o=t.resolve(e);if(!r.parent.isTextblock){let l=o.nodeAfter;return l!=null&&n==e+l.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=t.resolve(zc(o,!0,!0));return!s.parent.isTextblock||s.pos>n||zc(s,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function zc(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let o=t.node(r).maybeChild(t.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function pM(t,e,n,r,i){let o=t.findDiffStart(e,n);if(o==null)return null;let{a:s,b:l}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let a=Math.max(0,o-Math.min(s,l));r-=s+a-o}if(s<o&&t.size<e.size){let a=r<=o&&r>=s?o-r:0;o-=a,o&&o<e.size&&Lg(e.textBetween(o-1,o+1))&&(o+=a?1:-1),l=o+(l-s),s=o}else if(l<o){let a=r<=o&&r>=l?o-r:0;o-=a,o&&o<t.size&&Lg(t.textBetween(o-1,o+1))&&(o+=a?1:-1),s=o+(s-l),l=o}return{start:o,endA:s,endB:l}}function Lg(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class bw{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new bI,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Ug),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Vg(this),Fg(this),this.nodeViews=Bg(this),this.docView=gg(this.state.doc,Og(this),Uc(this),this.dom,this),this.domObserver=new rM(this,(r,i,o,s)=>cM(this,r,i,o,s)),this.domObserver.start(),_I(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&pf(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Ug),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(Ew(this),s=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let g=Bg(this);mM(g,this.nodeViews)&&(this.nodeViews=g,o=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&pf(this),this.editable=Vg(this),Fg(this);let a=Uc(this),u=Og(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",p=o||!this.docView.matchesNode(e.doc,u,a);(p||!e.selection.eq(i.selection))&&(s=!0);let m=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&qA(this);if(s){this.domObserver.stop();let g=p&&(_t||je)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&hM(i.selection,e.selection);if(p){let y=je?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=qI(this)),(o||!this.docView.update(e.doc,u,a,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=gg(e.doc,u,a,this.dom,this)),y&&!this.trackWrites&&(g=!0)}g||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&mI(this))?Yn(this,g):(dw(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():m&&WA(m)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof ne){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&cg(this,n.getBoundingClientRect(),e)}else cg(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-n.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new Nw(e.slice,e.move,i<0?void 0:ne.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let l=this.directPlugins[s].props[e];if(l!=null&&(i=n?n(l):l))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let l=o[s].props[e];if(l!=null&&(i=n?n(l):l))return i}}hasFocus(){if(_t){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&jA(this.dom),Yn(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return QA(this,e)}coordsAtPos(e,n=1){return rw(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return rI(this,n||this.state,e)}pasteHTML(e,n){return nl(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return nl(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return $p(this,e)}destroy(){this.docView&&(RI(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Uc(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,LA())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return PI(this,e)}domSelectionRange(){let e=this.domSelection();return e?pt&&this.root.nodeType===11&&UA(this.dom.ownerDocument)==this.dom&&oM(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}bw.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function Og(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[At.node(0,t.state.doc.content.size,e)]}function Fg(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:At.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function Vg(t){return!t.someProp("editable",e=>e(t.state)===!1)}function hM(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function Bg(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function mM(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function Ug(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var $r={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},ru={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},gM=typeof navigator<"u"&&/Mac/.test(navigator.platform),yM=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var nt=0;nt<10;nt++)$r[48+nt]=$r[96+nt]=String(nt);for(var nt=1;nt<=24;nt++)$r[nt+111]="F"+nt;for(var nt=65;nt<=90;nt++)$r[nt]=String.fromCharCode(nt+32),ru[nt]=String.fromCharCode(nt);for(var Hc in $r)ru.hasOwnProperty(Hc)||(ru[Hc]=$r[Hc]);function vM(t){var e=gM&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||yM&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?ru:$r)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const xM=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),wM=typeof navigator<"u"&&/Win/.test(navigator.platform);function SM(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))xM?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),s&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function CM(t){let e=Object.create(null);for(let n in t)e[SM(n)]=t[n];return e}function $c(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function EM(t){return new Qe({props:{handleKeyDown:_w(t)}})}function _w(t){let e=CM(t);return function(n,r){let i=vM(r),o,s=e[$c(i,r)];if(s&&s(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[$c(i,r,!1)];if(l&&l(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(wM&&r.ctrlKey&&r.altKey)&&(o=$r[r.keyCode])&&o!=i){let l=e[$c(o,r)];if(l&&l(n.state,n.dispatch,n))return!0}}return!1}}const Kp=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function Rw(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const Dw=(t,e,n)=>{let r=Rw(t,n);if(!r)return!1;let i=Yp(r);if(!i){let s=r.blockRange(),l=s&&qo(s);return l==null?!1:(e&&e(t.tr.lift(s,l).scrollIntoView()),!0)}let o=i.nodeBefore;if(Hw(t,i,e,-1))return!0;if(r.parent.content.size==0&&(Lo(o,"end")||ne.isSelectable(o)))for(let s=r.depth;;s--){let l=Pu(t.doc,r.before(s),r.after(s),W.empty);if(l&&l.slice.size<l.to-l.from){if(e){let a=t.tr.step(l);a.setSelection(Lo(o,"end")?ae.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):ne.create(a.doc,i.pos-o.nodeSize)),e(a.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},TM=(t,e,n)=>{let r=Rw(t,n);if(!r)return!1;let i=Yp(r);return i?Pw(t,i,e):!1},NM=(t,e,n)=>{let r=Ow(t,n);if(!r)return!1;let i=Xp(r);return i?Pw(t,i,e):!1};function Pw(t,e,n){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let c=i.lastChild;if(!c)return!1;i=c}let s=e.nodeAfter,l=s,a=e.pos+1;for(;!l.isTextblock;a++){if(l.type.spec.isolating)return!1;let c=l.firstChild;if(!c)return!1;l=c}let u=Pu(t.doc,o,a,W.empty);if(!u||u.from!=o||u instanceof We&&u.slice.size>=a-o)return!1;if(n){let c=t.tr.step(u);c.setSelection(le.create(c.doc,o)),n(c.scrollIntoView())}return!0}function Lo(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const Lw=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;o=Yp(r)}let s=o&&o.nodeBefore;return!s||!ne.isSelectable(s)?!1:(e&&e(t.tr.setSelection(ne.create(t.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function Yp(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function Ow(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const Fw=(t,e,n)=>{let r=Ow(t,n);if(!r)return!1;let i=Xp(r);if(!i)return!1;let o=i.nodeAfter;if(Hw(t,i,e,1))return!0;if(r.parent.content.size==0&&(Lo(o,"start")||ne.isSelectable(o))){let s=Pu(t.doc,r.before(),r.after(),W.empty);if(s&&s.slice.size<s.to-s.from){if(e){let l=t.tr.step(s);l.setSelection(Lo(o,"start")?ae.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):ne.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},Vw=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;o=Xp(r)}let s=o&&o.nodeAfter;return!s||!ne.isSelectable(s)?!1:(e&&e(t.tr.setSelection(ne.create(t.doc,o.pos)).scrollIntoView()),!0)};function Xp(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const kM=(t,e)=>{let n=t.selection,r=n instanceof ne,i;if(r){if(n.node.isTextblock||!jr(t.doc,n.from))return!1;i=n.from}else if(i=Du(t.doc,n.from,-1),i==null)return!1;if(e){let o=t.tr.join(i);r&&o.setSelection(ne.create(o.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},AM=(t,e)=>{let n=t.selection,r;if(n instanceof ne){if(n.node.isTextblock||!jr(t.doc,n.to))return!1;r=n.to}else if(r=Du(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},IM=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),o=i&&qo(i);return o==null?!1:(e&&e(t.tr.lift(i,o).scrollIntoView()),!0)},Bw=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function Qp(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const MM=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),o=n.indexAfter(-1),s=Qp(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let l=n.after(),a=t.tr.replaceWith(l,l,s.createAndFill());a.setSelection(ae.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},Uw=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof Ut||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=Qp(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=t.tr.insert(s,o.createAndFill());l.setSelection(le.create(l.doc,s+1)),e(l.scrollIntoView())}return!0},zw=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(Kn(t.doc,o))return e&&e(t.tr.split(o).scrollIntoView()),!0}let r=n.blockRange(),i=r&&qo(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function bM(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof ne&&e.selection.node.isBlock)return!r.parentOffset||!Kn(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let o=[],s,l,a=!1,u=!1;for(let g=r.depth;;g--)if(r.node(g).isBlock){a=r.end(g)==r.pos+(r.depth-g),u=r.start(g)==r.pos-(r.depth-g),l=Qp(r.node(g-1).contentMatchAt(r.indexAfter(g-1))),o.unshift(a&&l?{type:l}:null),s=g;break}else{if(g==1)return!1;o.unshift(null)}let c=e.tr;(e.selection instanceof le||e.selection instanceof Ut)&&c.deleteSelection();let p=c.mapping.map(r.pos),m=Kn(c.doc,p,o.length,o);if(m||(o[0]=l?{type:l}:null,m=Kn(c.doc,p,o.length,o)),!m)return!1;if(c.split(p,o.length,o),!a&&u&&r.node(s).type!=l){let g=c.mapping.map(r.before(s)),y=c.doc.resolve(g);l&&r.node(s-1).canReplaceWith(y.index(),y.index()+1,l)&&c.setNodeMarkup(c.mapping.map(r.before(s)),l)}return n&&n(c.scrollIntoView()),!0}}const _M=bM(),RM=(t,e)=>{let{$from:n,to:r}=t.selection,i,o=n.sharedDepth(r);return o==0?!1:(i=n.before(o),e&&e(t.tr.setSelection(ne.create(t.doc,i))),!0)};function DM(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||jr(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function Hw(t,e,n,r){let i=e.nodeBefore,o=e.nodeAfter,s,l,a=i.type.spec.isolating||o.type.spec.isolating;if(!a&&DM(t,e,n))return!0;let u=!a&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(s=(l=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&l.matchType(s[0]||o.type).validEnd){if(n){let g=e.pos+o.nodeSize,y=P.empty;for(let x=s.length-1;x>=0;x--)y=P.from(s[x].create(null,y));y=P.from(i.copy(y));let v=t.tr.step(new Ke(e.pos-1,g,e.pos,g,new W(y,1,0),s.length,!0)),w=v.doc.resolve(g+2*s.length);w.nodeAfter&&w.nodeAfter.type==i.type&&jr(v.doc,w.pos)&&v.join(w.pos),n(v.scrollIntoView())}return!0}let c=o.type.spec.isolating||r>0&&a?null:ae.findFrom(e,1),p=c&&c.$from.blockRange(c.$to),m=p&&qo(p);if(m!=null&&m>=e.depth)return n&&n(t.tr.lift(p,m).scrollIntoView()),!0;if(u&&Lo(o,"start",!0)&&Lo(i,"end")){let g=i,y=[];for(;y.push(g),!g.isTextblock;)g=g.lastChild;let v=o,w=1;for(;!v.isTextblock;v=v.firstChild)w++;if(g.canReplace(g.childCount,g.childCount,v.content)){if(n){let x=P.empty;for(let C=y.length-1;C>=0;C--)x=P.from(y[C].copy(x));let E=t.tr.step(new Ke(e.pos-y.length,e.pos+o.nodeSize,e.pos+w,e.pos+o.nodeSize-w,new W(x,y.length,0),0,!0));n(E.scrollIntoView())}return!0}}return!1}function $w(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(n&&n(e.tr.setSelection(le.create(e.doc,t<0?i.start(o):i.end(o)))),!0):!1}}const PM=$w(-1),LM=$w(1);function OM(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o),l=s&&Vp(s,t,e);return l?(r&&r(n.tr.wrap(s,l).scrollIntoView()),!0):!1}}function zg(t,e=null){return function(n,r){let i=!1;for(let o=0;o<n.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:l}}=n.selection.ranges[o];n.doc.nodesBetween(s,l,(a,u)=>{if(i)return!1;if(!(!a.isTextblock||a.hasMarkup(t,e)))if(a.type==t)i=!0;else{let c=n.doc.resolve(u),p=c.index();i=c.parent.canReplaceWith(p,p+1,t)}})}if(!i)return!1;if(r){let o=n.tr;for(let s=0;s<n.selection.ranges.length;s++){let{$from:{pos:l},$to:{pos:a}}=n.selection.ranges[s];o.setBlockType(l,a,t,e)}r(o.scrollIntoView())}return!0}}function Zp(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}Zp(Kp,Dw,Lw);Zp(Kp,Fw,Vw);Zp(Bw,Uw,zw,_M);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function FM(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o);if(!s)return!1;let l=r?n.tr:null;return VM(l,s,t,e)?(r&&r(l.scrollIntoView()),!0):!1}}function VM(t,e,n,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let a=s.resolve(e.start-2);o=new Ya(a,a,e.depth),e.endIndex<e.parent.childCount&&(e=new Ya(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let l=Vp(o,n,r,e);return l?(t&&BM(t,e,l,i,n),!0):!1}function BM(t,e,n,r,i){let o=P.empty;for(let c=n.length-1;c>=0;c--)o=P.from(n[c].type.create(n[c].attrs,o));t.step(new Ke(e.start-(r?2:0),e.end,e.start,e.end,new W(o,0,0),n.length,!0));let s=0;for(let c=0;c<n.length;c++)n[c].type==i&&(s=c+1);let l=n.length-s,a=e.start+n.length-(r?2:0),u=e.parent;for(let c=e.startIndex,p=e.endIndex,m=!0;c<p;c++,m=!1)!m&&Kn(t.doc,a,l)&&(t.split(a,l),a+=2*l),a+=u.child(c).nodeSize;return t}function UM(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return o?n?r.node(o.depth-1).type==t?zM(e,n,t,o):HM(e,n,o):!0:!1}}function zM(t,e,n,r){let i=t.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new Ke(o-1,s,o,s,new W(P.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Ya(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const l=qo(r);if(l==null)return!1;i.lift(r,l);let a=i.doc.resolve(i.mapping.map(o,-1)-1);return jr(i.doc,a.pos)&&a.nodeBefore.type==a.nodeAfter.type&&i.join(a.pos),e(i.scrollIntoView()),!0}function HM(t,e,n){let r=t.tr,i=n.parent;for(let g=n.end,y=n.endIndex-1,v=n.startIndex;y>v;y--)g-=i.child(y).nodeSize,r.delete(g-1,g+1);let o=r.doc.resolve(n.start),s=o.nodeAfter;if(r.mapping.map(n.end)!=n.start+o.nodeAfter.nodeSize)return!1;let l=n.startIndex==0,a=n.endIndex==i.childCount,u=o.node(-1),c=o.index(-1);if(!u.canReplace(c+(l?0:1),c+1,s.content.append(a?P.empty:P.from(i))))return!1;let p=o.pos,m=p+s.nodeSize;return r.step(new Ke(p-(l?1:0),m+(a?1:0),p+1,m-1,new W((l?P.empty:P.from(i.copy(P.empty))).append(a?P.empty:P.from(i.copy(P.empty))),l?0:1,a?0:1),l?0:1)),e(r.scrollIntoView()),!0}function $M(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let l=o.parent,a=l.child(s-1);if(a.type!=t)return!1;if(n){let u=a.lastChild&&a.lastChild.type==l.type,c=P.from(u?t.create():null),p=new W(P.from(t.create(null,P.from(l.type.create(null,c)))),u?3:1,0),m=o.start,g=o.end;n(e.tr.step(new Ke(m-(u?3:1),g,m,g,p,1,!0)).scrollIntoView())}return!0}}function Bu(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}class Uu{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:i}=n,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([l,a])=>[l,(...c)=>{const p=a(...c)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),p}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,l=[],a=!!e,u=e||o.tr,c=()=>(!a&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(u),l.every(m=>m===!0)),p={...Object.fromEntries(Object.entries(r).map(([m,g])=>[m,(...v)=>{const w=this.buildProps(u,n),x=g(...v)(w);return l.push(x),p}])),run:c};return p}createCan(e){const{rawCommands:n,state:r}=this,i=!1,o=e||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(n).map(([a,u])=>[a,(...c)=>u(...c)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,l={tr:e,editor:i,view:s,state:Bu({state:o,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([a,u])=>[a,(...c)=>u(...c)(l)]))}};return l}}class GM{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(i=>i!==n):delete this.callbacks[e]),this}once(e,n){const r=(...i)=>{this.off(e,r),n.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function Q(t,e,n){return t.config[e]===void 0&&t.parent?Q(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?Q(t.parent,e,n):null}):t.config[e]}function zu(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function Gw(t){const e=[],{nodeExtensions:n,markExtensions:r}=zu(t),i=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const l={name:s.name,options:s.options,storage:s.storage,extensions:i},a=Q(s,"addGlobalAttributes",l);if(!a)return;a().forEach(c=>{c.types.forEach(p=>{Object.entries(c.attributes).forEach(([m,g])=>{e.push({type:p,name:m,attribute:{...o,...g}})})})})}),i.forEach(s=>{const l={name:s.name,options:s.options,storage:s.storage},a=Q(s,"addAttributes",l);if(!a)return;const u=a();Object.entries(u).forEach(([c,p])=>{const m={...o,...p};typeof(m==null?void 0:m.default)=="function"&&(m.default=m.default()),m!=null&&m.isRequired&&(m==null?void 0:m.default)===void 0&&delete m.default,e.push({type:s.name,name:c,attribute:m})})}),e}function Xe(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function ht(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const l=o?String(o).split(" "):[],a=r[i]?r[i].split(" "):[],u=l.filter(c=>!a.includes(c));r[i]=[...a,...u].join(" ")}else if(i==="style"){const l=o?o.split(";").map(c=>c.trim()).filter(Boolean):[],a=r[i]?r[i].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;a.forEach(c=>{const[p,m]=c.split(":").map(g=>g.trim());u.set(p,m)}),l.forEach(c=>{const[p,m]=c.split(":").map(g=>g.trim());u.set(p,m)}),r[i]=Array.from(u.entries()).map(([c,p])=>`${c}: ${p}`).join("; ")}else r[i]=o}),r},{})}function hf(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>ht(n,r),{})}function qw(t){return typeof t=="function"}function ue(t,e=void 0,...n){return qw(t)?e?t.bind(e)(...n):t(...n):t}function qM(t={}){return Object.keys(t).length===0&&t.constructor===Object}function WM(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Hg(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const l=s.attribute.parseHTML?s.attribute.parseHTML(n):WM(n.getAttribute(s.name));return l==null?o:{...o,[s.name]:l}},{});return{...r,...i}}}}function $g(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&qM(n)?!1:n!=null))}function jM(t,e){var n;const r=Gw(t),{nodeExtensions:i,markExtensions:o}=zu(t),s=(n=i.find(u=>Q(u,"topNode")))===null||n===void 0?void 0:n.name,l=Object.fromEntries(i.map(u=>{const c=r.filter(x=>x.type===u.name),p={name:u.name,options:u.options,storage:u.storage,editor:e},m=t.reduce((x,E)=>{const C=Q(E,"extendNodeSchema",p);return{...x,...C?C(u):{}}},{}),g=$g({...m,content:ue(Q(u,"content",p)),marks:ue(Q(u,"marks",p)),group:ue(Q(u,"group",p)),inline:ue(Q(u,"inline",p)),atom:ue(Q(u,"atom",p)),selectable:ue(Q(u,"selectable",p)),draggable:ue(Q(u,"draggable",p)),code:ue(Q(u,"code",p)),whitespace:ue(Q(u,"whitespace",p)),linebreakReplacement:ue(Q(u,"linebreakReplacement",p)),defining:ue(Q(u,"defining",p)),isolating:ue(Q(u,"isolating",p)),attrs:Object.fromEntries(c.map(x=>{var E;return[x.name,{default:(E=x==null?void 0:x.attribute)===null||E===void 0?void 0:E.default}]}))}),y=ue(Q(u,"parseHTML",p));y&&(g.parseDOM=y.map(x=>Hg(x,c)));const v=Q(u,"renderHTML",p);v&&(g.toDOM=x=>v({node:x,HTMLAttributes:hf(x,c)}));const w=Q(u,"renderText",p);return w&&(g.toText=w),[u.name,g]})),a=Object.fromEntries(o.map(u=>{const c=r.filter(w=>w.type===u.name),p={name:u.name,options:u.options,storage:u.storage,editor:e},m=t.reduce((w,x)=>{const E=Q(x,"extendMarkSchema",p);return{...w,...E?E(u):{}}},{}),g=$g({...m,inclusive:ue(Q(u,"inclusive",p)),excludes:ue(Q(u,"excludes",p)),group:ue(Q(u,"group",p)),spanning:ue(Q(u,"spanning",p)),code:ue(Q(u,"code",p)),attrs:Object.fromEntries(c.map(w=>{var x;return[w.name,{default:(x=w==null?void 0:w.attribute)===null||x===void 0?void 0:x.default}]}))}),y=ue(Q(u,"parseHTML",p));y&&(g.parseDOM=y.map(w=>Hg(w,c)));const v=Q(u,"renderHTML",p);return v&&(g.toDOM=w=>v({mark:w,HTMLAttributes:hf(w,c)})),[u.name,g]}));return new R1({topNode:s,nodes:l,marks:a})}function Gc(t,e){return e.nodes[t]||e.marks[t]||null}function Gg(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function eh(t,e){const n=Li.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}const JM=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,l)=>{var a,u;const c=((u=(a=i.type.spec).toText)===null||u===void 0?void 0:u.call(a,{node:i,pos:o,parent:s,index:l}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?c:c.slice(0,Math.max(0,r-o))}),n};function th(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Hu{constructor(e){this.find=e.find,this.handler=e.handler}}const KM=(t,e)=>{if(th(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Wl(t){var e;const{editor:n,from:r,to:i,text:o,rules:s,plugin:l}=t,{view:a}=n;if(a.composing)return!1;const u=a.state.doc.resolve(r);if(u.parent.type.spec.code||!((e=u.nodeBefore||u.nodeAfter)===null||e===void 0)&&e.marks.find(m=>m.type.spec.code))return!1;let c=!1;const p=JM(u)+o;return s.forEach(m=>{if(c)return;const g=KM(p,m.find);if(!g)return;const y=a.state.tr,v=Bu({state:a.state,transaction:y}),w={from:r-(g[0].length-o.length),to:i},{commands:x,chain:E,can:C}=new Uu({editor:n,state:v});m.handler({state:v,range:w,match:g,commands:x,chain:E,can:C})===null||!y.steps.length||(y.setMeta(l,{transform:y,from:r,to:i,text:o}),a.dispatch(y),c=!0)}),c}function YM(t){const{editor:e,rules:n}=t,r=new Qe({state:{init(){return null},apply(i,o,s){const l=i.getMeta(r);if(l)return l;const a=i.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:c}=a;typeof c=="string"?c=c:c=eh(P.from(c),s.schema);const{from:p}=a,m=p+c.length;Wl({editor:e,from:p,to:m,text:c,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,l){return Wl({editor:e,from:o,to:s,text:l,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&Wl({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?Wl({editor:e,from:s.pos,to:s.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function XM(t){return Object.prototype.toString.call(t).slice(8,-1)}function jl(t){return XM(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function $u(t,e){const n={...t};return jl(t)&&jl(e)&&Object.keys(e).forEach(r=>{jl(e[r])&&jl(t[r])?n[r]=$u(t[r],e[r]):n[r]=e[r]}),n}class rr{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ue(Q(this,"addOptions",{name:this.name}))),this.storage=ue(Q(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new rr(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>$u(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new rr(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ue(Q(n,"addOptions",{name:n.name})),n.storage=ue(Q(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const a=s.find(u=>(u==null?void 0:u.type.name)===n.name);return a&&r.removeStoredMark(a),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}function QM(t){return typeof t=="number"}class ZM{constructor(e){this.find=e.find,this.handler=e.handler}}const eb=(t,e,n)=>{if(th(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=t,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function tb(t){const{editor:e,state:n,from:r,to:i,rule:o,pasteEvent:s,dropEvent:l}=t,{commands:a,chain:u,can:c}=new Uu({editor:e,state:n}),p=[];return n.doc.nodesBetween(r,i,(g,y)=>{if(!g.isTextblock||g.type.spec.code)return;const v=Math.max(r,y),w=Math.min(i,y+g.content.size),x=g.textBetween(v-y,w-y,void 0,"");eb(x,o.find,s).forEach(C=>{if(C.index===void 0)return;const S=v+C.index+1,N=S+C[0].length,T={from:n.tr.mapping.map(S),to:n.tr.mapping.map(N)},k=o.handler({state:n,range:T,match:C,commands:a,chain:u,can:c,pasteEvent:s,dropEvent:l});p.push(k)})}),p.every(g=>g!==null)}let Jl=null;const nb=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function rb(t){const{editor:e,rules:n}=t;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const a=({state:c,from:p,to:m,rule:g,pasteEvt:y})=>{const v=c.tr,w=Bu({state:c,transaction:v});if(!(!tb({editor:e,state:w,from:Math.max(p-1,0),to:m.b-1,rule:g,pasteEvent:y,dropEvent:l})||!v.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,v}};return n.map(c=>new Qe({view(p){const m=y=>{var v;r=!((v=p.dom.parentElement)===null||v===void 0)&&v.contains(y.target)?p.dom.parentElement:null,r&&(Jl=e)},g=()=>{Jl&&(Jl=null)};return window.addEventListener("dragstart",m),window.addEventListener("dragend",g),{destroy(){window.removeEventListener("dragstart",m),window.removeEventListener("dragend",g)}}},props:{handleDOMEvents:{drop:(p,m)=>{if(o=r===p.dom.parentElement,l=m,!o){const g=Jl;g!=null&&g.isEditable&&setTimeout(()=>{const y=g.state.selection;y&&g.commands.deleteRange({from:y.from,to:y.to})},10)}return!1},paste:(p,m)=>{var g;const y=(g=m.clipboardData)===null||g===void 0?void 0:g.getData("text/html");return s=m,i=!!(y!=null&&y.includes("data-pm-slice")),!1}}},appendTransaction:(p,m,g)=>{const y=p[0],v=y.getMeta("uiEvent")==="paste"&&!i,w=y.getMeta("uiEvent")==="drop"&&!o,x=y.getMeta("applyPasteRules"),E=!!x;if(!v&&!w&&!E)return;if(E){let{text:N}=x;typeof N=="string"?N=N:N=eh(P.from(N),g.schema);const{from:T}=x,k=T+N.length,I=nb(N);return a({rule:c,state:g,from:T,to:{b:k},pasteEvt:I})}const C=m.doc.content.findDiffStart(g.doc.content),S=m.doc.content.findDiffEnd(g.doc.content);if(!(!QM(C)||!S||C===S.b))return a({rule:c,state:g,from:C,to:S,pasteEvt:s})}}))}function ib(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class uo{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=uo.resolve(e),this.schema=jM(this.extensions,n),this.setupExtensions()}static resolve(e){const n=uo.sort(uo.flatten(e)),r=ib(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},i=Q(n,"addExtensions",r);return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(e){return e.sort((r,i)=>{const o=Q(r,"priority")||100,s=Q(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:Gc(n.name,this.schema)},i=Q(n,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,n=uo.sort([...this.extensions].reverse()),r=[],i=[],o=n.map(s=>{const l={name:s.name,options:s.options,storage:s.storage,editor:e,type:Gc(s.name,this.schema)},a=[],u=Q(s,"addKeyboardShortcuts",l);let c={};if(s.type==="mark"&&Q(s,"exitable",l)&&(c.ArrowRight=()=>rr.handleExit({editor:e,mark:s})),u){const v=Object.fromEntries(Object.entries(u()).map(([w,x])=>[w,()=>x({editor:e})]));c={...c,...v}}const p=EM(c);a.push(p);const m=Q(s,"addInputRules",l);Gg(s,e.options.enableInputRules)&&m&&r.push(...m());const g=Q(s,"addPasteRules",l);Gg(s,e.options.enablePasteRules)&&g&&i.push(...g());const y=Q(s,"addProseMirrorPlugins",l);if(y){const v=y();a.push(...v)}return a}).flat();return[YM({editor:e,rules:r}),...rb({editor:e,rules:i}),...o]}get attributes(){return Gw(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=zu(this.extensions);return Object.fromEntries(n.filter(r=>!!Q(r,"addNodeView")).map(r=>{const i=this.attributes.filter(a=>a.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:Xe(r.name,this.schema)},s=Q(r,"addNodeView",o);if(!s)return[];const l=(a,u,c,p,m)=>{const g=hf(a,i);return s()({node:a,view:u,getPos:c,decorations:p,innerDecorations:m,editor:e,extension:r,HTMLAttributes:g})};return[r.name,l]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Gc(e.name,this.schema)};e.type==="mark"&&(!((n=ue(Q(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const i=Q(e,"onBeforeCreate",r),o=Q(e,"onCreate",r),s=Q(e,"onUpdate",r),l=Q(e,"onSelectionUpdate",r),a=Q(e,"onTransaction",r),u=Q(e,"onFocus",r),c=Q(e,"onBlur",r),p=Q(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),l&&this.editor.on("selectionUpdate",l),a&&this.editor.on("transaction",a),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),p&&this.editor.on("destroy",p)})}}class Ge{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ue(Q(this,"addOptions",{name:this.name}))),this.storage=ue(Q(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ge(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>$u(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Ge({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ue(Q(n,"addOptions",{name:n.name})),n.storage=ue(Q(n,"addStorage",{name:n.name,options:n.options})),n}}function Ww(t,e,n){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=n||{};let l="";return t.nodesBetween(r,i,(a,u,c,p)=>{var m;a.isBlock&&u>r&&(l+=o);const g=s==null?void 0:s[a.type.name];if(g)return c&&(l+=g({node:a,pos:u,parent:c,index:p,range:e})),!1;a.isText&&(l+=(m=a==null?void 0:a.text)===null||m===void 0?void 0:m.slice(Math.max(r,u)-u,i-u))}),l}function nh(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const ob=Ge.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Qe({key:new Lt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(c=>c.$from.pos)),l=Math.max(...o.map(c=>c.$to.pos)),a=nh(n);return Ww(r,{from:s,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:a})}}})]}}),sb=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),lb=(t=!1)=>({commands:e})=>e.setContent("",t),ab=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:o,$to:s})=>{t.doc.nodesBetween(o.pos,s.pos,(l,a)=>{if(l.type.isText)return;const{doc:u,mapping:c}=e,p=u.resolve(c.map(a)),m=u.resolve(c.map(a+l.nodeSize)),g=p.blockRange(m);if(!g)return;const y=qo(g);if(l.type.isTextblock){const{defaultType:v}=p.parent.contentMatchAt(p.index());e.setNodeMarkup(g.start,v)}(y||y===0)&&e.lift(g,y)})}),!0},ub=t=>e=>t(e),cb=()=>({state:t,dispatch:e})=>Uw(t,e),db=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,o=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new le(r.doc.resolve(Math.max(s-1,0)))),!0},fb=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const l=i.before(o),a=i.after(o);t.delete(l,a).scrollIntoView()}return!0}return!1},pb=t=>({tr:e,state:n,dispatch:r})=>{const i=Xe(t,n.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const a=o.before(s),u=o.after(s);e.delete(a,u).scrollIntoView()}return!0}return!1},hb=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},mb=()=>({state:t,dispatch:e})=>Kp(t,e),gb=()=>({commands:t})=>t.keyboardShortcut("Enter"),yb=()=>({state:t,dispatch:e})=>MM(t,e);function iu(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:th(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function jw(t,e,n={}){return t.find(r=>r.type===e&&iu(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function qg(t,e,n={}){return!!jw(t,e,n)}function rh(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(c=>c.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(c=>c.type===e)||(n=n||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!jw([...i.node.marks],e,n)))return;let s=i.index,l=t.start()+i.offset,a=s+1,u=l+i.node.nodeSize;for(;s>0&&qg([...t.parent.child(s-1).marks],e,n);)s-=1,l-=t.parent.child(s).nodeSize;for(;a<t.parent.childCount&&qg([...t.parent.child(a).marks],e,n);)u+=t.parent.child(a).nodeSize,a+=1;return{from:l,to:u}}function Kr(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const vb=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const o=Kr(t,r.schema),{doc:s,selection:l}=n,{$from:a,from:u,to:c}=l;if(i){const p=rh(a,o,e);if(p&&p.from<=u&&p.to>=c){const m=le.create(s,p.from,p.to);n.setSelection(m)}}return!0},xb=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function ih(t){return t instanceof le}function jn(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Jw(t,e=null){if(!e)return null;const n=ae.atStart(t),r=ae.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,o=r.to;return e==="all"?le.create(t,jn(0,i,o),jn(t.content.size,i,o)):le.create(t,jn(e,i,o),jn(e,i,o))}function wb(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function oh(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Sb=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(oh()||wb())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!ih(n.state.selection))return s(),!0;const l=Jw(i.doc,t)||n.state.selection,a=n.state.selection.eq(l);return o&&(a||i.setSelection(l),a&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},Cb=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),Eb=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),Kw=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&Kw(r)}return t};function Kl(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return Kw(n)}function il(t,e,n){if(t instanceof Lr||t instanceof P)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return P.fromArray(t.map(l=>e.nodeFromJSON(l)));const s=e.nodeFromJSON(t);return n.errorOnInvalidContent&&s.check(),s}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),il("",e,n)}if(i){if(n.errorOnInvalidContent){let s=!1,l="";const a=new R1({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(s=!0,l=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?Or.fromSchema(a).parseSlice(Kl(t),n.parseOptions):Or.fromSchema(a).parse(Kl(t),n.parseOptions),n.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const o=Or.fromSchema(e);return n.slice?o.parseSlice(Kl(t),n.parseOptions).content:o.parse(Kl(t),n.parseOptions)}return il("",e,n)}function Tb(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof We||i instanceof Ke))return;const o=t.mapping.maps[r];let s=0;o.forEach((l,a,u,c)=>{s===0&&(s=c)}),t.setSelection(ae.near(t.doc.resolve(s),n))}const Nb=t=>!("type"in t),kb=(t,e,n)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l;const a=w=>{o.emit("contentError",{editor:o,error:w,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{il(e,o.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(w){a(w)}try{l=il(e,o.schema,{parseOptions:u,errorOnInvalidContent:(s=n.errorOnInvalidContent)!==null&&s!==void 0?s:o.options.enableContentCheck})}catch(w){return a(w),!1}let{from:c,to:p}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},m=!0,g=!0;if((Nb(l)?l:[l]).forEach(w=>{w.check(),m=m?w.isText&&w.marks.length===0:!1,g=g?w.isBlock:!1}),c===p&&g){const{parent:w}=r.doc.resolve(c);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(c-=1,p+=1)}let v;if(m){if(Array.isArray(e))v=e.map(w=>w.text||"").join("");else if(e instanceof P){let w="";e.forEach(x=>{x.text&&(w+=x.text)}),v=w}else typeof e=="object"&&e&&e.text?v=e.text:v=e;r.insertText(v,c,p)}else v=l,r.replaceWith(c,p,v);n.updateSelection&&Tb(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:c,text:v}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:c,text:v})}return!0},Ab=()=>({state:t,dispatch:e})=>kM(t,e),Ib=()=>({state:t,dispatch:e})=>AM(t,e),Mb=()=>({state:t,dispatch:e})=>Dw(t,e),bb=()=>({state:t,dispatch:e})=>Fw(t,e),_b=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Du(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},Rb=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Du(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},Db=()=>({state:t,dispatch:e})=>TM(t,e),Pb=()=>({state:t,dispatch:e})=>NM(t,e);function Yw(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Lb(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,o,s;for(let l=0;l<e.length-1;l+=1){const a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))oh()||Yw()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),s&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const Ob=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const o=Lb(t).split(/-(?!$)/),s=o.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),l=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),a=e.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,l))});return a==null||a.steps.forEach(u=>{const c=u.map(r.mapping);c&&i&&r.maybeStep(c)}),!0};function ol(t,e,n={}){const{from:r,to:i,empty:o}=t.selection,s=e?Xe(e,t.schema):null,l=[];t.doc.nodesBetween(r,i,(p,m)=>{if(p.isText)return;const g=Math.max(r,m),y=Math.min(i,m+p.nodeSize);l.push({node:p,from:g,to:y})});const a=i-r,u=l.filter(p=>s?s.name===p.node.type.name:!0).filter(p=>iu(p.node.attrs,n,{strict:!1}));return o?!!u.length:u.reduce((p,m)=>p+m.to-m.from,0)>=a}const Fb=(t,e={})=>({state:n,dispatch:r})=>{const i=Xe(t,n.schema);return ol(n,i,e)?IM(n,r):!1},Vb=()=>({state:t,dispatch:e})=>zw(t,e),Bb=t=>({state:e,dispatch:n})=>{const r=Xe(t,e.schema);return UM(r)(e,n)},Ub=()=>({state:t,dispatch:e})=>Bw(t,e);function Gu(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Wg(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}const zb=(t,e)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const l=Gu(typeof t=="string"?t:t.name,r.schema);return l?(l==="node"&&(o=Xe(t,r.schema)),l==="mark"&&(s=Kr(t,r.schema)),i&&n.selection.ranges.forEach(a=>{r.doc.nodesBetween(a.$from.pos,a.$to.pos,(u,c)=>{o&&o===u.type&&n.setNodeMarkup(c,void 0,Wg(u.attrs,e)),s&&u.marks.length&&u.marks.forEach(p=>{s===p.type&&n.addMark(c,c+u.nodeSize,s.create(Wg(p.attrs,e)))})})}),!0):!1},Hb=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),$b=()=>({tr:t,dispatch:e})=>{if(e){const n=new Ut(t.doc);t.setSelection(n)}return!0},Gb=()=>({state:t,dispatch:e})=>Lw(t,e),qb=()=>({state:t,dispatch:e})=>Vw(t,e),Wb=()=>({state:t,dispatch:e})=>RM(t,e),jb=()=>({state:t,dispatch:e})=>LM(t,e),Jb=()=>({state:t,dispatch:e})=>PM(t,e);function mf(t,e,n={},r={}){return il(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const Kb=(t,e=!1,n={},r={})=>({editor:i,tr:o,dispatch:s,commands:l})=>{var a,u;const{doc:c}=o;if(n.preserveWhitespace!=="full"){const p=mf(t,i.schema,n,{errorOnInvalidContent:(a=r.errorOnInvalidContent)!==null&&a!==void 0?a:i.options.enableContentCheck});return s&&o.replaceWith(0,c.content.size,p).setMeta("preventUpdate",!e),!0}return s&&o.setMeta("preventUpdate",!e),l.insertContentAt({from:0,to:c.content.size},t,{parseOptions:n,errorOnInvalidContent:(u=r.errorOnInvalidContent)!==null&&u!==void 0?u:i.options.enableContentCheck})};function Xw(t,e){const n=Kr(e,t.schema),{from:r,to:i,empty:o}=t.selection,s=[];o?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,a=>{s.push(...a.marks)});const l=s.find(a=>a.type.name===n.name);return l?{...l.attrs}:{}}function Yb(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Xb(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function sh(t){return e=>Xb(e.$from,t)}function Qw(t,e){const n={from:0,to:t.content.size};return Ww(t,n,e)}function Qb(t,e){const n=Xe(e,t.schema),{from:r,to:i}=t.selection,o=[];t.doc.nodesBetween(r,i,l=>{o.push(l)});const s=o.reverse().find(l=>l.type.name===n.name);return s?{...s.attrs}:{}}function Zb(t,e){const n=Gu(typeof e=="string"?e:e.name,t.schema);return n==="node"?Qb(t,e):n==="mark"?Xw(t,e):{}}function Zw(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const o=n.resolve(t),s=rh(o,i.type);s&&r.push({mark:i,...s})}):n.nodesBetween(t,e,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function ma(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function gf(t,e,n={}){const{empty:r,ranges:i}=t.selection,o=e?Kr(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(p=>o?o.name===p.type.name:!0).find(p=>iu(p.attrs,n,{strict:!1}));let s=0;const l=[];if(i.forEach(({$from:p,$to:m})=>{const g=p.pos,y=m.pos;t.doc.nodesBetween(g,y,(v,w)=>{if(!v.isText&&!v.marks.length)return;const x=Math.max(g,w),E=Math.min(y,w+v.nodeSize),C=E-x;s+=C,l.push(...v.marks.map(S=>({mark:S,from:x,to:E})))})}),s===0)return!1;const a=l.filter(p=>o?o.name===p.mark.type.name:!0).filter(p=>iu(p.mark.attrs,n,{strict:!1})).reduce((p,m)=>p+m.to-m.from,0),u=l.filter(p=>o?p.mark.type!==o&&p.mark.type.excludes(o):!0).reduce((p,m)=>p+m.to-m.from,0);return(a>0?a+u:a)>=s}function e_(t,e,n={}){if(!e)return ol(t,null,n)||gf(t,null,n);const r=Gu(e,t.schema);return r==="node"?ol(t,e,n):r==="mark"?gf(t,e,n):!1}function jg(t,e){const{nodeExtensions:n}=zu(e),r=n.find(s=>s.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=ue(Q(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function qu(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(o=>{i!==!1&&(qu(o,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function eS(t){return t instanceof ne}function tS(t,e,n){const i=t.state.doc.content.size,o=jn(e,0,i),s=jn(n,0,i),l=t.coordsAtPos(o),a=t.coordsAtPos(s,-1),u=Math.min(l.top,a.top),c=Math.max(l.bottom,a.bottom),p=Math.min(l.left,a.left),m=Math.max(l.right,a.right),g=m-p,y=c-u,x={top:u,bottom:c,left:p,right:m,width:g,height:y,x:p,y:u};return{...x,toJSON:()=>x}}function t_(t,e,n){var r;const{selection:i}=e;let o=null;if(ih(i)&&(o=i.$cursor),o){const l=(r=t.storedMarks)!==null&&r!==void 0?r:o.marks();return!!n.isInSet(l)||!l.some(a=>a.type.excludes(n))}const{ranges:s}=i;return s.some(({$from:l,$to:a})=>{let u=l.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(l.pos,a.pos,(c,p,m)=>{if(u)return!1;if(c.isInline){const g=!m||m.type.allowsMarkType(n),y=!!n.isInSet(c.marks)||!c.marks.some(v=>v.type.excludes(n));u=g&&y}return!u}),u})}const n_=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=n,{empty:s,ranges:l}=o,a=Kr(t,r.schema);if(i)if(s){const u=Xw(r,a);n.addStoredMark(a.create({...u,...e}))}else l.forEach(u=>{const c=u.$from.pos,p=u.$to.pos;r.doc.nodesBetween(c,p,(m,g)=>{const y=Math.max(g,c),v=Math.min(g+m.nodeSize,p);m.marks.find(x=>x.type===a)?m.marks.forEach(x=>{a===x.type&&n.addMark(y,v,a.create({...x.attrs,...e}))}):n.addMark(y,v,a.create(e))})});return t_(r,n,a)},r_=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),i_=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const o=Xe(t,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:l})=>zg(o,{...s,...e})(n)?!0:l.clearNodes()).command(({state:l})=>zg(o,{...s,...e})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},o_=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=jn(t,0,r.content.size),o=ne.create(r,i);e.setSelection(o)}return!0},s_=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:o}=typeof t=="number"?{from:t,to:t}:t,s=le.atStart(r).from,l=le.atEnd(r).to,a=jn(i,s,l),u=jn(o,s,l),c=le.create(r,a,u);e.setSelection(c)}return!0},l_=t=>({state:e,dispatch:n})=>{const r=Xe(t,e.schema);return $M(r)(e,n)};function Jg(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(r)}}const a_=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:l,$to:a}=o,u=i.extensionManager.attributes,c=ma(u,l.node().type.name,l.node().attrs);if(o instanceof ne&&o.node.isBlock)return!l.parentOffset||!Kn(s,l.pos)?!1:(r&&(t&&Jg(n,i.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const p=a.parentOffset===a.parent.content.size,m=l.depth===0?void 0:Yb(l.node(-1).contentMatchAt(l.indexAfter(-1)));let g=p&&m?[{type:m,attrs:c}]:void 0,y=Kn(e.doc,e.mapping.map(l.pos),1,g);if(!g&&!y&&Kn(e.doc,e.mapping.map(l.pos),1,m?[{type:m}]:void 0)&&(y=!0,g=m?[{type:m,attrs:c}]:void 0),r){if(y&&(o instanceof le&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,g),m&&!p&&!l.parentOffset&&l.parent.type!==m)){const v=e.mapping.map(l.before()),w=e.doc.resolve(v);l.node(-1).canReplaceWith(w.index(),w.index()+1,m)&&e.setNodeMarkup(e.mapping.map(l.before()),m)}t&&Jg(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return y},u_=(t,e={})=>({tr:n,state:r,dispatch:i,editor:o})=>{var s;const l=Xe(t,r.schema),{$from:a,$to:u}=r.selection,c=r.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(u))return!1;const p=a.node(-1);if(p.type!==l)return!1;const m=o.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==l||a.index(-2)!==a.node(-2).childCount-1)return!1;if(i){let x=P.empty;const E=a.index(-1)?1:a.index(-2)?2:3;for(let I=a.depth-E;I>=a.depth-3;I-=1)x=P.from(a.node(I).copy(x));const C=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,S={...ma(m,a.node().type.name,a.node().attrs),...e},N=((s=l.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(S))||void 0;x=x.append(P.from(l.createAndFill(null,N)||void 0));const T=a.before(a.depth-(E-1));n.replace(T,a.after(-C),new W(x,4-E,0));let k=-1;n.doc.nodesBetween(T,n.doc.content.size,(I,R)=>{if(k>-1)return!1;I.isTextblock&&I.content.size===0&&(k=R+1)}),k>-1&&n.setSelection(le.near(n.doc.resolve(k))),n.scrollIntoView()}return!0}const g=u.pos===a.end()?p.contentMatchAt(0).defaultType:null,y={...ma(m,p.type.name,p.attrs),...e},v={...ma(m,a.node().type.name,a.node().attrs),...e};n.delete(a.pos,u.pos);const w=g?[{type:l,attrs:y},{type:g,attrs:v}]:[{type:l,attrs:y}];if(!Kn(n.doc,a.pos,2))return!1;if(i){const{selection:x,storedMarks:E}=r,{splittableMarks:C}=o.extensionManager,S=E||x.$to.parentOffset&&x.$from.marks();if(n.split(a.pos,2,w).scrollIntoView(),!S||!i)return!0;const N=S.filter(T=>C.includes(T.type.name));n.ensureMarks(N)}return!0},qc=(t,e)=>{const n=sh(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&jr(t.doc,n.pos)&&t.join(n.pos),!0},Wc=(t,e)=>{const n=sh(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&jr(t.doc,r)&&t.join(r),!0},c_=(t,e,n,r={})=>({editor:i,tr:o,state:s,dispatch:l,chain:a,commands:u,can:c})=>{const{extensions:p,splittableMarks:m}=i.extensionManager,g=Xe(t,s.schema),y=Xe(e,s.schema),{selection:v,storedMarks:w}=s,{$from:x,$to:E}=v,C=x.blockRange(E),S=w||v.$to.parentOffset&&v.$from.marks();if(!C)return!1;const N=sh(T=>jg(T.type.name,p))(v);if(C.depth>=1&&N&&C.depth-N.depth<=1){if(N.node.type===g)return u.liftListItem(y);if(jg(N.node.type.name,p)&&g.validContent(N.node.content)&&l)return a().command(()=>(o.setNodeMarkup(N.pos,g),!0)).command(()=>qc(o,g)).command(()=>Wc(o,g)).run()}return!n||!S||!l?a().command(()=>c().wrapInList(g,r)?!0:u.clearNodes()).wrapInList(g,r).command(()=>qc(o,g)).command(()=>Wc(o,g)).run():a().command(()=>{const T=c().wrapInList(g,r),k=S.filter(I=>m.includes(I.type.name));return o.ensureMarks(k),T?!0:u.clearNodes()}).wrapInList(g,r).command(()=>qc(o,g)).command(()=>Wc(o,g)).run()},d_=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=n,s=Kr(t,r.schema);return gf(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},f_=(t,e,n={})=>({state:r,commands:i})=>{const o=Xe(t,r.schema),s=Xe(e,r.schema),l=ol(r,o,n);let a;return r.selection.$anchor.sameParent(r.selection.$head)&&(a=r.selection.$anchor.parent.attrs),l?i.setNode(s,a):i.setNode(o,{...a,...n})},p_=(t,e={})=>({state:n,commands:r})=>{const i=Xe(t,n.schema);return ol(n,i,e)?r.lift(i):r.wrapIn(i,e)},h_=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(e){const s=t.tr,l=o.transform;for(let a=l.steps.length-1;a>=0;a-=1)s.step(l.steps[a].invert(l.docs[a]));if(o.text){const a=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,t.schema.text(o.text,a))}else s.delete(o.from,o.to)}return!0}}return!1},m_=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},g_=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:l}=n,a=Kr(t,r.schema),{$from:u,empty:c,ranges:p}=l;if(!i)return!0;if(c&&s){let{from:m,to:g}=l;const y=(o=u.marks().find(w=>w.type===a))===null||o===void 0?void 0:o.attrs,v=rh(u,a,y);v&&(m=v.from,g=v.to),n.removeMark(m,g,a)}else p.forEach(m=>{n.removeMark(m.$from.pos,m.$to.pos,a)});return n.removeStoredMark(a),!0},y_=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const l=Gu(typeof t=="string"?t:t.name,r.schema);return l?(l==="node"&&(o=Xe(t,r.schema)),l==="mark"&&(s=Kr(t,r.schema)),i&&n.selection.ranges.forEach(a=>{const u=a.$from.pos,c=a.$to.pos;let p,m,g,y;n.selection.empty?r.doc.nodesBetween(u,c,(v,w)=>{o&&o===v.type&&(g=Math.max(w,u),y=Math.min(w+v.nodeSize,c),p=w,m=v)}):r.doc.nodesBetween(u,c,(v,w)=>{w<u&&o&&o===v.type&&(g=Math.max(w,u),y=Math.min(w+v.nodeSize,c),p=w,m=v),w>=u&&w<=c&&(o&&o===v.type&&n.setNodeMarkup(w,void 0,{...v.attrs,...e}),s&&v.marks.length&&v.marks.forEach(x=>{if(s===x.type){const E=Math.max(w,u),C=Math.min(w+v.nodeSize,c);n.addMark(E,C,s.create({...x.attrs,...e}))}}))}),m&&(p!==void 0&&n.setNodeMarkup(p,void 0,{...m.attrs,...e}),s&&m.marks.length&&m.marks.forEach(v=>{s===v.type&&n.addMark(g,y,s.create({...v.attrs,...e}))}))}),!0):!1},v_=(t,e={})=>({state:n,dispatch:r})=>{const i=Xe(t,n.schema);return OM(i,e)(n,r)},x_=(t,e={})=>({state:n,dispatch:r})=>{const i=Xe(t,n.schema);return FM(i,e)(n,r)};var w_=Object.freeze({__proto__:null,blur:sb,clearContent:lb,clearNodes:ab,command:ub,createParagraphNear:cb,cut:db,deleteCurrentNode:fb,deleteNode:pb,deleteRange:hb,deleteSelection:mb,enter:gb,exitCode:yb,extendMarkRange:vb,first:xb,focus:Sb,forEach:Cb,insertContent:Eb,insertContentAt:kb,joinBackward:Mb,joinDown:Ib,joinForward:bb,joinItemBackward:_b,joinItemForward:Rb,joinTextblockBackward:Db,joinTextblockForward:Pb,joinUp:Ab,keyboardShortcut:Ob,lift:Fb,liftEmptyBlock:Vb,liftListItem:Bb,newlineInCode:Ub,resetAttributes:zb,scrollIntoView:Hb,selectAll:$b,selectNodeBackward:Gb,selectNodeForward:qb,selectParentNode:Wb,selectTextblockEnd:jb,selectTextblockStart:Jb,setContent:Kb,setMark:n_,setMeta:r_,setNode:i_,setNodeSelection:o_,setTextSelection:s_,sinkListItem:l_,splitBlock:a_,splitListItem:u_,toggleList:c_,toggleMark:d_,toggleNode:f_,toggleWrap:p_,undoInputRule:h_,unsetAllMarks:m_,unsetMark:g_,updateAttributes:y_,wrapIn:v_,wrapInList:x_});const S_=Ge.create({name:"commands",addCommands(){return{...w_}}}),C_=Ge.create({name:"drop",addProseMirrorPlugins(){return[new Qe({key:new Lt("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),E_=Ge.create({name:"editable",addProseMirrorPlugins(){return[new Qe({key:new Lt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),T_=new Lt("focusEvents"),N_=Ge.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Qe({key:T_,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),k_=Ge.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:l})=>{const{selection:a,doc:u}=l,{empty:c,$anchor:p}=a,{pos:m,parent:g}=p,y=p.parent.isTextblock&&m>0?l.doc.resolve(m-1):p,v=y.parent.type.spec.isolating,w=p.pos-p.parentOffset,x=v&&y.parent.childCount===1?w===p.pos:ae.atStart(u).from===m;return!c||!g.type.isTextblock||g.textContent.length||!x||x&&p.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return oh()||Yw()?o:i},addProseMirrorPlugins(){return[new Qe({key:new Lt("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(v=>v.getMeta("composition")))return;const r=t.some(v=>v.docChanged)&&!e.doc.eq(n.doc),i=t.some(v=>v.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:l}=e.selection,a=ae.atStart(e.doc).from,u=ae.atEnd(e.doc).to;if(o||!(s===a&&l===u)||!qu(n.doc))return;const m=n.tr,g=Bu({state:n,transaction:m}),{commands:y}=new Uu({editor:this.editor,state:g});if(y.clearNodes(),!!m.steps.length)return m}})]}}),A_=Ge.create({name:"paste",addProseMirrorPlugins(){return[new Qe({key:new Lt("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),I_=Ge.create({name:"tabindex",addProseMirrorPlugins(){return[new Qe({key:new Lt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class si{get name(){return this.node.type.name}constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new si(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new si(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new si(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,s=this.pos+r+(o?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(s);if(!i&&l.depth<=this.depth)return;const a=new si(l,this.editor,i,i?n:null);i&&(a.actualDepth=this.depth+1),e.push(new si(l,this.editor,i,i?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const o=i.node.attrs,s=Object.keys(n);for(let l=0;l<s.length;l+=1){const a=s[l];if(o[a]!==n[a])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(n);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(a=>n[a]===s.node.attrs[a])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const M_=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function b_(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}class __ extends GM{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:i})=>this.options.onDrop(n,r,i)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=b_(M_,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=qw(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(o=>{const s=typeof o=="string"?`${o}$`:o.key;r=r.filter(l=>!l.key.startsWith(s))}),n.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,n;const i=[...this.options.enableCoreExtensions?[E_,ob.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),S_,N_,k_,I_,C_,A_].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new uo(i,this)}createCommandManager(){this.commandManager=new Uu({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=mf(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(s){if(!(s instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(s.message))throw s;this.emit("contentError",{editor:this,error:s,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(l=>l.name!=="collaboration"),this.createExtensionManager()}}),n=mf(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=Jw(n,this.options.autofocus);this.view=new bw(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:ao.create({doc:n,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var l;return(l=this.capturedTransaction)===null||l===void 0?void 0:l.step(s)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),o=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return Zb(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,i=typeof e=="string"?n:e;return e_(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return eh(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return Qw(this.state.doc,{blockSeparator:n,textSerializers:{...nh(this.schema),...r}})}get isEmpty(){return qu(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new si(n,this)}get $doc(){return this.$pos(0)}}function Oo(t){return new Hu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=ue(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],l=r[0];if(s){const a=l.search(/\S/),u=n.from+l.indexOf(s),c=u+s.length;if(Zw(n.from,n.to,e.doc).filter(g=>g.mark.type.excluded.find(v=>v===t.type&&v!==g.mark.type)).filter(g=>g.to>u).length)return null;c<n.to&&o.delete(c,n.to),u>n.from&&o.delete(n.from+a,u);const m=n.from+a+s.length;o.addMark(n.from+a,m,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}function R_(t){return new Hu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=ue(t.getAttributes,void 0,r)||{},{tr:o}=e,s=n.from;let l=n.to;const a=t.type.create(i);if(r[1]){const u=r[0].lastIndexOf(r[1]);let c=s+u;c>l?c=l:l=c+r[1].length;const p=r[0][r[0].length-1];o.insertText(p,s+r[0].length-1),o.replaceWith(c,l,a)}else if(r[0]){const u=t.type.isInline?s:s-1;o.insert(u,t.type.create(i)).delete(o.mapping.map(s),o.mapping.map(l))}o.scrollIntoView()}})}function yf(t){return new Hu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),o=ue(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)}})}function sl(t){return new Hu({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const o=ue(t.getAttributes,void 0,r)||{},s=e.tr.delete(n.from,n.to),a=s.doc.resolve(n.from).blockRange(),u=a&&Vp(a,t.type,o);if(!u)return null;if(s.wrap(a,u),t.keepMarks&&t.editor){const{selection:p,storedMarks:m}=e,{splittableMarks:g}=t.editor.extensionManager,y=m||p.$to.parentOffset&&p.$from.marks();if(y){const v=y.filter(w=>g.includes(w.type.name));s.ensureMarks(v)}}if(t.keepAttributes){const p=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(p,o).run()}const c=s.doc.resolve(n.from-1).nodeBefore;c&&c.type===t.type&&jr(s.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,c))&&s.join(n.from-1)}})}class Pt{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ue(Q(this,"addOptions",{name:this.name}))),this.storage=ue(Q(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Pt(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>$u(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Pt(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ue(Q(n,"addOptions",{name:n.name})),n.storage=ue(Q(n,"addStorage",{name:n.name,options:n.options})),n}}function Fo(t){return new ZM({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const o=ue(t.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,l=r[r.length-1],a=r[0];let u=n.to;if(l){const c=a.search(/\S/),p=n.from+a.indexOf(l),m=p+l.length;if(Zw(n.from,n.to,e.doc).filter(y=>y.mark.type.excluded.find(w=>w===t.type&&w!==y.mark.type)).filter(y=>y.to>p).length)return null;m<n.to&&s.delete(m,n.to),p>n.from&&s.delete(n.from+c,p),u=n.from+c+l.length,s.addMark(n.from+c,u,t.type.create(o||{})),s.removeStoredMark(t.type)}}})}function D_(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof ne){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let i=r.depth;for(;i>=0;){const o=r.index(i);if(r.node(i).contentMatchAt(o).matchType(e))return!0;i-=1}return!1}function P_(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var Rt="top",un="bottom",cn="right",Dt="left",lh="auto",wl=[Rt,un,cn,Dt],Vo="start",ll="end",L_="clippingParents",nS="viewport",ss="popper",O_="reference",Kg=wl.reduce(function(t,e){return t.concat([e+"-"+Vo,e+"-"+ll])},[]),rS=[].concat(wl,[lh]).reduce(function(t,e){return t.concat([e,e+"-"+Vo,e+"-"+ll])},[]),F_="beforeRead",V_="read",B_="afterRead",U_="beforeMain",z_="main",H_="afterMain",$_="beforeWrite",G_="write",q_="afterWrite",W_=[F_,V_,B_,U_,z_,H_,$_,G_,q_];function Vn(t){return t?(t.nodeName||"").toLowerCase():null}function Ht(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function _i(t){var e=Ht(t).Element;return t instanceof e||t instanceof Element}function on(t){var e=Ht(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function ah(t){if(typeof ShadowRoot>"u")return!1;var e=Ht(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function j_(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},o=e.elements[n];!on(o)||!Vn(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var l=i[s];l===!1?o.removeAttribute(s):o.setAttribute(s,l===!0?"":l)}))})}function J_(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),l=s.reduce(function(a,u){return a[u]="",a},{});!on(i)||!Vn(i)||(Object.assign(i.style,l),Object.keys(o).forEach(function(a){i.removeAttribute(a)}))})}}const iS={name:"applyStyles",enabled:!0,phase:"write",fn:j_,effect:J_,requires:["computeStyles"]};function Ln(t){return t.split("-")[0]}var vi=Math.max,ou=Math.min,Bo=Math.round;function vf(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function oS(){return!/^((?!chrome|android).)*safari/i.test(vf())}function Uo(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,o=1;e&&on(t)&&(i=t.offsetWidth>0&&Bo(r.width)/t.offsetWidth||1,o=t.offsetHeight>0&&Bo(r.height)/t.offsetHeight||1);var s=_i(t)?Ht(t):window,l=s.visualViewport,a=!oS()&&n,u=(r.left+(a&&l?l.offsetLeft:0))/i,c=(r.top+(a&&l?l.offsetTop:0))/o,p=r.width/i,m=r.height/o;return{width:p,height:m,top:c,right:u+p,bottom:c+m,left:u,x:u,y:c}}function uh(t){var e=Uo(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function sS(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&ah(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function ir(t){return Ht(t).getComputedStyle(t)}function K_(t){return["table","td","th"].indexOf(Vn(t))>=0}function Yr(t){return((_i(t)?t.ownerDocument:t.document)||window.document).documentElement}function Wu(t){return Vn(t)==="html"?t:t.assignedSlot||t.parentNode||(ah(t)?t.host:null)||Yr(t)}function Yg(t){return!on(t)||ir(t).position==="fixed"?null:t.offsetParent}function Y_(t){var e=/firefox/i.test(vf()),n=/Trident/i.test(vf());if(n&&on(t)){var r=ir(t);if(r.position==="fixed")return null}var i=Wu(t);for(ah(i)&&(i=i.host);on(i)&&["html","body"].indexOf(Vn(i))<0;){var o=ir(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function Sl(t){for(var e=Ht(t),n=Yg(t);n&&K_(n)&&ir(n).position==="static";)n=Yg(n);return n&&(Vn(n)==="html"||Vn(n)==="body"&&ir(n).position==="static")?e:n||Y_(t)||e}function ch(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Ms(t,e,n){return vi(t,ou(e,n))}function X_(t,e,n){var r=Ms(t,e,n);return r>n?n:r}function lS(){return{top:0,right:0,bottom:0,left:0}}function aS(t){return Object.assign({},lS(),t)}function uS(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var Q_=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,aS(typeof e!="number"?e:uS(e,wl))};function Z_(t){var e,n=t.state,r=t.name,i=t.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,l=Ln(n.placement),a=ch(l),u=[Dt,cn].indexOf(l)>=0,c=u?"height":"width";if(!(!o||!s)){var p=Q_(i.padding,n),m=uh(o),g=a==="y"?Rt:Dt,y=a==="y"?un:cn,v=n.rects.reference[c]+n.rects.reference[a]-s[a]-n.rects.popper[c],w=s[a]-n.rects.reference[a],x=Sl(o),E=x?a==="y"?x.clientHeight||0:x.clientWidth||0:0,C=v/2-w/2,S=p[g],N=E-m[c]-p[y],T=E/2-m[c]/2+C,k=Ms(S,T,N),I=a;n.modifiersData[r]=(e={},e[I]=k,e.centerOffset=k-T,e)}}function eR(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||sS(e.elements.popper,i)&&(e.elements.arrow=i))}const tR={name:"arrow",enabled:!0,phase:"main",fn:Z_,effect:eR,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function zo(t){return t.split("-")[1]}var nR={top:"auto",right:"auto",bottom:"auto",left:"auto"};function rR(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:Bo(n*i)/i||0,y:Bo(r*i)/i||0}}function Xg(t){var e,n=t.popper,r=t.popperRect,i=t.placement,o=t.variation,s=t.offsets,l=t.position,a=t.gpuAcceleration,u=t.adaptive,c=t.roundOffsets,p=t.isFixed,m=s.x,g=m===void 0?0:m,y=s.y,v=y===void 0?0:y,w=typeof c=="function"?c({x:g,y:v}):{x:g,y:v};g=w.x,v=w.y;var x=s.hasOwnProperty("x"),E=s.hasOwnProperty("y"),C=Dt,S=Rt,N=window;if(u){var T=Sl(n),k="clientHeight",I="clientWidth";if(T===Ht(n)&&(T=Yr(n),ir(T).position!=="static"&&l==="absolute"&&(k="scrollHeight",I="scrollWidth")),T=T,i===Rt||(i===Dt||i===cn)&&o===ll){S=un;var R=p&&T===N&&N.visualViewport?N.visualViewport.height:T[k];v-=R-r.height,v*=a?1:-1}if(i===Dt||(i===Rt||i===un)&&o===ll){C=cn;var M=p&&T===N&&N.visualViewport?N.visualViewport.width:T[I];g-=M-r.width,g*=a?1:-1}}var q=Object.assign({position:l},u&&nR),$=c===!0?rR({x:g,y:v},Ht(n)):{x:g,y:v};if(g=$.x,v=$.y,a){var F;return Object.assign({},q,(F={},F[S]=E?"0":"",F[C]=x?"0":"",F.transform=(N.devicePixelRatio||1)<=1?"translate("+g+"px, "+v+"px)":"translate3d("+g+"px, "+v+"px, 0)",F))}return Object.assign({},q,(e={},e[S]=E?v+"px":"",e[C]=x?g+"px":"",e.transform="",e))}function iR(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,o=n.adaptive,s=o===void 0?!0:o,l=n.roundOffsets,a=l===void 0?!0:l,u={placement:Ln(e.placement),variation:zo(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Xg(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:a})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Xg(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:a})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const oR={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:iR,data:{}};var Yl={passive:!0};function sR(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,o=i===void 0?!0:i,s=r.resize,l=s===void 0?!0:s,a=Ht(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&u.forEach(function(c){c.addEventListener("scroll",n.update,Yl)}),l&&a.addEventListener("resize",n.update,Yl),function(){o&&u.forEach(function(c){c.removeEventListener("scroll",n.update,Yl)}),l&&a.removeEventListener("resize",n.update,Yl)}}const lR={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:sR,data:{}};var aR={left:"right",right:"left",bottom:"top",top:"bottom"};function ga(t){return t.replace(/left|right|bottom|top/g,function(e){return aR[e]})}var uR={start:"end",end:"start"};function Qg(t){return t.replace(/start|end/g,function(e){return uR[e]})}function dh(t){var e=Ht(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function fh(t){return Uo(Yr(t)).left+dh(t).scrollLeft}function cR(t,e){var n=Ht(t),r=Yr(t),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,l=0,a=0;if(i){o=i.width,s=i.height;var u=oS();(u||!u&&e==="fixed")&&(l=i.offsetLeft,a=i.offsetTop)}return{width:o,height:s,x:l+fh(t),y:a}}function dR(t){var e,n=Yr(t),r=dh(t),i=(e=t.ownerDocument)==null?void 0:e.body,o=vi(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=vi(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-r.scrollLeft+fh(t),a=-r.scrollTop;return ir(i||n).direction==="rtl"&&(l+=vi(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:l,y:a}}function ph(t){var e=ir(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function cS(t){return["html","body","#document"].indexOf(Vn(t))>=0?t.ownerDocument.body:on(t)&&ph(t)?t:cS(Wu(t))}function bs(t,e){var n;e===void 0&&(e=[]);var r=cS(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),o=Ht(r),s=i?[o].concat(o.visualViewport||[],ph(r)?r:[]):r,l=e.concat(s);return i?l:l.concat(bs(Wu(s)))}function xf(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function fR(t,e){var n=Uo(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function Zg(t,e,n){return e===nS?xf(cR(t,n)):_i(e)?fR(e,n):xf(dR(Yr(t)))}function pR(t){var e=bs(Wu(t)),n=["absolute","fixed"].indexOf(ir(t).position)>=0,r=n&&on(t)?Sl(t):t;return _i(r)?e.filter(function(i){return _i(i)&&sS(i,r)&&Vn(i)!=="body"}):[]}function hR(t,e,n,r){var i=e==="clippingParents"?pR(t):[].concat(e),o=[].concat(i,[n]),s=o[0],l=o.reduce(function(a,u){var c=Zg(t,u,r);return a.top=vi(c.top,a.top),a.right=ou(c.right,a.right),a.bottom=ou(c.bottom,a.bottom),a.left=vi(c.left,a.left),a},Zg(t,s,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function dS(t){var e=t.reference,n=t.element,r=t.placement,i=r?Ln(r):null,o=r?zo(r):null,s=e.x+e.width/2-n.width/2,l=e.y+e.height/2-n.height/2,a;switch(i){case Rt:a={x:s,y:e.y-n.height};break;case un:a={x:s,y:e.y+e.height};break;case cn:a={x:e.x+e.width,y:l};break;case Dt:a={x:e.x-n.width,y:l};break;default:a={x:e.x,y:e.y}}var u=i?ch(i):null;if(u!=null){var c=u==="y"?"height":"width";switch(o){case Vo:a[u]=a[u]-(e[c]/2-n[c]/2);break;case ll:a[u]=a[u]+(e[c]/2-n[c]/2);break}}return a}function al(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,o=n.strategy,s=o===void 0?t.strategy:o,l=n.boundary,a=l===void 0?L_:l,u=n.rootBoundary,c=u===void 0?nS:u,p=n.elementContext,m=p===void 0?ss:p,g=n.altBoundary,y=g===void 0?!1:g,v=n.padding,w=v===void 0?0:v,x=aS(typeof w!="number"?w:uS(w,wl)),E=m===ss?O_:ss,C=t.rects.popper,S=t.elements[y?E:m],N=hR(_i(S)?S:S.contextElement||Yr(t.elements.popper),a,c,s),T=Uo(t.elements.reference),k=dS({reference:T,element:C,placement:i}),I=xf(Object.assign({},C,k)),R=m===ss?I:T,M={top:N.top-R.top+x.top,bottom:R.bottom-N.bottom+x.bottom,left:N.left-R.left+x.left,right:R.right-N.right+x.right},q=t.modifiersData.offset;if(m===ss&&q){var $=q[i];Object.keys(M).forEach(function(F){var z=[cn,un].indexOf(F)>=0?1:-1,ie=[Rt,un].indexOf(F)>=0?"y":"x";M[F]+=$[ie]*z})}return M}function mR(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,o=n.rootBoundary,s=n.padding,l=n.flipVariations,a=n.allowedAutoPlacements,u=a===void 0?rS:a,c=zo(r),p=c?l?Kg:Kg.filter(function(y){return zo(y)===c}):wl,m=p.filter(function(y){return u.indexOf(y)>=0});m.length===0&&(m=p);var g=m.reduce(function(y,v){return y[v]=al(t,{placement:v,boundary:i,rootBoundary:o,padding:s})[Ln(v)],y},{});return Object.keys(g).sort(function(y,v){return g[y]-g[v]})}function gR(t){if(Ln(t)===lh)return[];var e=ga(t);return[Qg(t),e,Qg(e)]}function yR(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,l=s===void 0?!0:s,a=n.fallbackPlacements,u=n.padding,c=n.boundary,p=n.rootBoundary,m=n.altBoundary,g=n.flipVariations,y=g===void 0?!0:g,v=n.allowedAutoPlacements,w=e.options.placement,x=Ln(w),E=x===w,C=a||(E||!y?[ga(w)]:gR(w)),S=[w].concat(C).reduce(function(ce,be){return ce.concat(Ln(be)===lh?mR(e,{placement:be,boundary:c,rootBoundary:p,padding:u,flipVariations:y,allowedAutoPlacements:v}):be)},[]),N=e.rects.reference,T=e.rects.popper,k=new Map,I=!0,R=S[0],M=0;M<S.length;M++){var q=S[M],$=Ln(q),F=zo(q)===Vo,z=[Rt,un].indexOf($)>=0,ie=z?"width":"height",Y=al(e,{placement:q,boundary:c,rootBoundary:p,altBoundary:m,padding:u}),se=z?F?cn:Dt:F?un:Rt;N[ie]>T[ie]&&(se=ga(se));var L=ga(se),X=[];if(o&&X.push(Y[$]<=0),l&&X.push(Y[se]<=0,Y[L]<=0),X.every(function(ce){return ce})){R=q,I=!1;break}k.set(q,X)}if(I)for(var Z=y?3:1,oe=function(be){var Le=S.find(function(ot){var V=k.get(ot);if(V)return V.slice(0,be).every(function(dn){return dn})});if(Le)return R=Le,"break"},te=Z;te>0;te--){var he=oe(te);if(he==="break")break}e.placement!==R&&(e.modifiersData[r]._skip=!0,e.placement=R,e.reset=!0)}}const vR={name:"flip",enabled:!0,phase:"main",fn:yR,requiresIfExists:["offset"],data:{_skip:!1}};function ey(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function ty(t){return[Rt,cn,un,Dt].some(function(e){return t[e]>=0})}function xR(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,s=al(e,{elementContext:"reference"}),l=al(e,{altBoundary:!0}),a=ey(s,r),u=ey(l,i,o),c=ty(a),p=ty(u);e.modifiersData[n]={referenceClippingOffsets:a,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:p},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":p})}const wR={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:xR};function SR(t,e,n){var r=Ln(t),i=[Dt,Rt].indexOf(r)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,s=o[0],l=o[1];return s=s||0,l=(l||0)*i,[Dt,cn].indexOf(r)>=0?{x:l,y:s}:{x:s,y:l}}function CR(t){var e=t.state,n=t.options,r=t.name,i=n.offset,o=i===void 0?[0,0]:i,s=rS.reduce(function(c,p){return c[p]=SR(p,e.rects,o),c},{}),l=s[e.placement],a=l.x,u=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=a,e.modifiersData.popperOffsets.y+=u),e.modifiersData[r]=s}const ER={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:CR};function TR(t){var e=t.state,n=t.name;e.modifiersData[n]=dS({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const NR={name:"popperOffsets",enabled:!0,phase:"read",fn:TR,data:{}};function kR(t){return t==="x"?"y":"x"}function AR(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,l=s===void 0?!1:s,a=n.boundary,u=n.rootBoundary,c=n.altBoundary,p=n.padding,m=n.tether,g=m===void 0?!0:m,y=n.tetherOffset,v=y===void 0?0:y,w=al(e,{boundary:a,rootBoundary:u,padding:p,altBoundary:c}),x=Ln(e.placement),E=zo(e.placement),C=!E,S=ch(x),N=kR(S),T=e.modifiersData.popperOffsets,k=e.rects.reference,I=e.rects.popper,R=typeof v=="function"?v(Object.assign({},e.rects,{placement:e.placement})):v,M=typeof R=="number"?{mainAxis:R,altAxis:R}:Object.assign({mainAxis:0,altAxis:0},R),q=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,$={x:0,y:0};if(T){if(o){var F,z=S==="y"?Rt:Dt,ie=S==="y"?un:cn,Y=S==="y"?"height":"width",se=T[S],L=se+w[z],X=se-w[ie],Z=g?-I[Y]/2:0,oe=E===Vo?k[Y]:I[Y],te=E===Vo?-I[Y]:-k[Y],he=e.elements.arrow,ce=g&&he?uh(he):{width:0,height:0},be=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:lS(),Le=be[z],ot=be[ie],V=Ms(0,k[Y],ce[Y]),dn=C?k[Y]/2-Z-V-Le-M.mainAxis:oe-V-Le-M.mainAxis,qt=C?-k[Y]/2+Z+V+ot+M.mainAxis:te+V+ot+M.mainAxis,Wt=e.elements.arrow&&Sl(e.elements.arrow),Vi=Wt?S==="y"?Wt.clientTop||0:Wt.clientLeft||0:0,Nn=(F=q==null?void 0:q[S])!=null?F:0,Bi=se+dn-Nn-Vi,Ui=se+qt-Nn,Qr=Ms(g?ou(L,Bi):L,se,g?vi(X,Ui):X);T[S]=Qr,$[S]=Qr-se}if(l){var ur,fn=S==="x"?Rt:Dt,zi=S==="x"?un:cn,pn=T[N],kn=N==="y"?"height":"width",cr=pn+w[fn],Bn=pn-w[zi],Zr=[Rt,Dt].indexOf(x)!==-1,A=(ur=q==null?void 0:q[N])!=null?ur:0,H=Zr?cr:pn-k[kn]-I[kn]-A+M.altAxis,j=Zr?pn+k[kn]+I[kn]-A-M.altAxis:Bn,B=g&&Zr?X_(H,pn,j):Ms(g?H:cr,pn,g?j:Bn);T[N]=B,$[N]=B-pn}e.modifiersData[r]=$}}const IR={name:"preventOverflow",enabled:!0,phase:"main",fn:AR,requiresIfExists:["offset"]};function MR(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function bR(t){return t===Ht(t)||!on(t)?dh(t):MR(t)}function _R(t){var e=t.getBoundingClientRect(),n=Bo(e.width)/t.offsetWidth||1,r=Bo(e.height)/t.offsetHeight||1;return n!==1||r!==1}function RR(t,e,n){n===void 0&&(n=!1);var r=on(e),i=on(e)&&_R(e),o=Yr(e),s=Uo(t,i,n),l={scrollLeft:0,scrollTop:0},a={x:0,y:0};return(r||!r&&!n)&&((Vn(e)!=="body"||ph(o))&&(l=bR(e)),on(e)?(a=Uo(e,!0),a.x+=e.clientLeft,a.y+=e.clientTop):o&&(a.x=fh(o))),{x:s.left+l.scrollLeft-a.x,y:s.top+l.scrollTop-a.y,width:s.width,height:s.height}}function DR(t){var e=new Map,n=new Set,r=[];t.forEach(function(o){e.set(o.name,o)});function i(o){n.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(l){if(!n.has(l)){var a=e.get(l);a&&i(a)}}),r.push(o)}return t.forEach(function(o){n.has(o.name)||i(o)}),r}function PR(t){var e=DR(t);return W_.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function LR(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function OR(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var ny={placement:"bottom",modifiers:[],strategy:"absolute"};function ry(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function FR(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,o=i===void 0?ny:i;return function(l,a,u){u===void 0&&(u=o);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},ny,o),modifiersData:{},elements:{reference:l,popper:a},attributes:{},styles:{}},p=[],m=!1,g={state:c,setOptions:function(x){var E=typeof x=="function"?x(c.options):x;v(),c.options=Object.assign({},o,c.options,E),c.scrollParents={reference:_i(l)?bs(l):l.contextElement?bs(l.contextElement):[],popper:bs(a)};var C=PR(OR([].concat(r,c.options.modifiers)));return c.orderedModifiers=C.filter(function(S){return S.enabled}),y(),g.update()},forceUpdate:function(){if(!m){var x=c.elements,E=x.reference,C=x.popper;if(ry(E,C)){c.rects={reference:RR(E,Sl(C),c.options.strategy==="fixed"),popper:uh(C)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(M){return c.modifiersData[M.name]=Object.assign({},M.data)});for(var S=0;S<c.orderedModifiers.length;S++){if(c.reset===!0){c.reset=!1,S=-1;continue}var N=c.orderedModifiers[S],T=N.fn,k=N.options,I=k===void 0?{}:k,R=N.name;typeof T=="function"&&(c=T({state:c,options:I,name:R,instance:g})||c)}}}},update:LR(function(){return new Promise(function(w){g.forceUpdate(),w(c)})}),destroy:function(){v(),m=!0}};if(!ry(l,a))return g;g.setOptions(u).then(function(w){!m&&u.onFirstUpdate&&u.onFirstUpdate(w)});function y(){c.orderedModifiers.forEach(function(w){var x=w.name,E=w.options,C=E===void 0?{}:E,S=w.effect;if(typeof S=="function"){var N=S({state:c,name:x,instance:g,options:C}),T=function(){};p.push(N||T)}})}function v(){p.forEach(function(w){return w()}),p=[]}return g}}var VR=[lR,NR,oR,iS,ER,vR,IR,tR,wR],BR=FR({defaultModifiers:VR}),UR="tippy-box",fS="tippy-content",zR="tippy-backdrop",pS="tippy-arrow",hS="tippy-svg-arrow",ii={passive:!0,capture:!0},mS=function(){return document.body};function jc(t,e,n){if(Array.isArray(t)){var r=t[e];return r??(Array.isArray(n)?n[e]:n)}return t}function hh(t,e){var n={}.toString.call(t);return n.indexOf("[object")===0&&n.indexOf(e+"]")>-1}function gS(t,e){return typeof t=="function"?t.apply(void 0,e):t}function iy(t,e){if(e===0)return t;var n;return function(r){clearTimeout(n),n=setTimeout(function(){t(r)},e)}}function HR(t){return t.split(/\s+/).filter(Boolean)}function Ki(t){return[].concat(t)}function oy(t,e){t.indexOf(e)===-1&&t.push(e)}function $R(t){return t.filter(function(e,n){return t.indexOf(e)===n})}function GR(t){return t.split("-")[0]}function su(t){return[].slice.call(t)}function sy(t){return Object.keys(t).reduce(function(e,n){return t[n]!==void 0&&(e[n]=t[n]),e},{})}function _s(){return document.createElement("div")}function ju(t){return["Element","Fragment"].some(function(e){return hh(t,e)})}function qR(t){return hh(t,"NodeList")}function WR(t){return hh(t,"MouseEvent")}function jR(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function JR(t){return ju(t)?[t]:qR(t)?su(t):Array.isArray(t)?t:su(document.querySelectorAll(t))}function Jc(t,e){t.forEach(function(n){n&&(n.style.transitionDuration=e+"ms")})}function ly(t,e){t.forEach(function(n){n&&n.setAttribute("data-state",e)})}function KR(t){var e,n=Ki(t),r=n[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function YR(t,e){var n=e.clientX,r=e.clientY;return t.every(function(i){var o=i.popperRect,s=i.popperState,l=i.props,a=l.interactiveBorder,u=GR(s.placement),c=s.modifiersData.offset;if(!c)return!0;var p=u==="bottom"?c.top.y:0,m=u==="top"?c.bottom.y:0,g=u==="right"?c.left.x:0,y=u==="left"?c.right.x:0,v=o.top-r+p>a,w=r-o.bottom-m>a,x=o.left-n+g>a,E=n-o.right-y>a;return v||w||x||E})}function Kc(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[r](i,n)})}function ay(t,e){for(var n=e;n;){var r;if(t.contains(n))return!0;n=n.getRootNode==null||(r=n.getRootNode())==null?void 0:r.host}return!1}var bn={isTouch:!1},uy=0;function XR(){bn.isTouch||(bn.isTouch=!0,window.performance&&document.addEventListener("mousemove",yS))}function yS(){var t=performance.now();t-uy<20&&(bn.isTouch=!1,document.removeEventListener("mousemove",yS)),uy=t}function QR(){var t=document.activeElement;if(jR(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function ZR(){document.addEventListener("touchstart",XR,ii),window.addEventListener("blur",QR)}var eD=typeof window<"u"&&typeof document<"u",tD=eD?!!window.msCrypto:!1,nD={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},rD={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},xn=Object.assign({appendTo:mS,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},nD,rD),iD=Object.keys(xn),oD=function(e){var n=Object.keys(e);n.forEach(function(r){xn[r]=e[r]})};function vS(t){var e=t.plugins||[],n=e.reduce(function(r,i){var o=i.name,s=i.defaultValue;if(o){var l;r[o]=t[o]!==void 0?t[o]:(l=xn[o])!=null?l:s}return r},{});return Object.assign({},t,n)}function sD(t,e){var n=e?Object.keys(vS(Object.assign({},xn,{plugins:e}))):iD,r=n.reduce(function(i,o){var s=(t.getAttribute("data-tippy-"+o)||"").trim();if(!s)return i;if(o==="content")i[o]=s;else try{i[o]=JSON.parse(s)}catch{i[o]=s}return i},{});return r}function cy(t,e){var n=Object.assign({},e,{content:gS(e.content,[t])},e.ignoreAttributes?{}:sD(t,e.plugins));return n.aria=Object.assign({},xn.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?e.interactive:n.aria.expanded,content:n.aria.content==="auto"?e.interactive?null:"describedby":n.aria.content},n}var lD=function(){return"innerHTML"};function wf(t,e){t[lD()]=e}function dy(t){var e=_s();return t===!0?e.className=pS:(e.className=hS,ju(t)?e.appendChild(t):wf(e,t)),e}function fy(t,e){ju(e.content)?(wf(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?wf(t,e.content):t.textContent=e.content)}function Sf(t){var e=t.firstElementChild,n=su(e.children);return{box:e,content:n.find(function(r){return r.classList.contains(fS)}),arrow:n.find(function(r){return r.classList.contains(pS)||r.classList.contains(hS)}),backdrop:n.find(function(r){return r.classList.contains(zR)})}}function xS(t){var e=_s(),n=_s();n.className=UR,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=_s();r.className=fS,r.setAttribute("data-state","hidden"),fy(r,t.props),e.appendChild(n),n.appendChild(r),i(t.props,t.props);function i(o,s){var l=Sf(e),a=l.box,u=l.content,c=l.arrow;s.theme?a.setAttribute("data-theme",s.theme):a.removeAttribute("data-theme"),typeof s.animation=="string"?a.setAttribute("data-animation",s.animation):a.removeAttribute("data-animation"),s.inertia?a.setAttribute("data-inertia",""):a.removeAttribute("data-inertia"),a.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?a.setAttribute("role",s.role):a.removeAttribute("role"),(o.content!==s.content||o.allowHTML!==s.allowHTML)&&fy(u,t.props),s.arrow?c?o.arrow!==s.arrow&&(a.removeChild(c),a.appendChild(dy(s.arrow))):a.appendChild(dy(s.arrow)):c&&a.removeChild(c)}return{popper:e,onUpdate:i}}xS.$$tippy=!0;var aD=1,Xl=[],Yc=[];function uD(t,e){var n=cy(t,Object.assign({},xn,vS(sy(e)))),r,i,o,s=!1,l=!1,a=!1,u=!1,c,p,m,g=[],y=iy(Bi,n.interactiveDebounce),v,w=aD++,x=null,E=$R(n.plugins),C={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},S={id:w,reference:t,popper:_s(),popperInstance:x,props:n,state:C,plugins:E,clearDelayTimeouts:H,setProps:j,setContent:B,show:ee,hide:ye,hideWithInteractivity:ve,enable:Zr,disable:A,unmount:fe,destroy:Tt};if(!n.render)return S;var N=n.render(S),T=N.popper,k=N.onUpdate;T.setAttribute("data-tippy-root",""),T.id="tippy-"+S.id,S.popper=T,t._tippy=S,T._tippy=S;var I=E.map(function(b){return b.fn(S)}),R=t.hasAttribute("aria-expanded");return Wt(),Z(),se(),L("onCreate",[S]),n.showOnCreate&&cr(),T.addEventListener("mouseenter",function(){S.props.interactive&&S.state.isVisible&&S.clearDelayTimeouts()}),T.addEventListener("mouseleave",function(){S.props.interactive&&S.props.trigger.indexOf("mouseenter")>=0&&z().addEventListener("mousemove",y)}),S;function M(){var b=S.props.touch;return Array.isArray(b)?b:[b,0]}function q(){return M()[0]==="hold"}function $(){var b;return!!((b=S.props.render)!=null&&b.$$tippy)}function F(){return v||t}function z(){var b=F().parentNode;return b?KR(b):document}function ie(){return Sf(T)}function Y(b){return S.state.isMounted&&!S.state.isVisible||bn.isTouch||c&&c.type==="focus"?0:jc(S.props.delay,b?0:1,xn.delay)}function se(b){b===void 0&&(b=!1),T.style.pointerEvents=S.props.interactive&&!b?"":"none",T.style.zIndex=""+S.props.zIndex}function L(b,U,re){if(re===void 0&&(re=!0),I.forEach(function(me){me[b]&&me[b].apply(me,U)}),re){var ge;(ge=S.props)[b].apply(ge,U)}}function X(){var b=S.props.aria;if(b.content){var U="aria-"+b.content,re=T.id,ge=Ki(S.props.triggerTarget||t);ge.forEach(function(me){var gt=me.getAttribute(U);if(S.state.isVisible)me.setAttribute(U,gt?gt+" "+re:re);else{var jt=gt&&gt.replace(re,"").trim();jt?me.setAttribute(U,jt):me.removeAttribute(U)}})}}function Z(){if(!(R||!S.props.aria.expanded)){var b=Ki(S.props.triggerTarget||t);b.forEach(function(U){S.props.interactive?U.setAttribute("aria-expanded",S.state.isVisible&&U===F()?"true":"false"):U.removeAttribute("aria-expanded")})}}function oe(){z().removeEventListener("mousemove",y),Xl=Xl.filter(function(b){return b!==y})}function te(b){if(!(bn.isTouch&&(a||b.type==="mousedown"))){var U=b.composedPath&&b.composedPath()[0]||b.target;if(!(S.props.interactive&&ay(T,U))){if(Ki(S.props.triggerTarget||t).some(function(re){return ay(re,U)})){if(bn.isTouch||S.state.isVisible&&S.props.trigger.indexOf("click")>=0)return}else L("onClickOutside",[S,b]);S.props.hideOnClick===!0&&(S.clearDelayTimeouts(),S.hide(),l=!0,setTimeout(function(){l=!1}),S.state.isMounted||Le())}}}function he(){a=!0}function ce(){a=!1}function be(){var b=z();b.addEventListener("mousedown",te,!0),b.addEventListener("touchend",te,ii),b.addEventListener("touchstart",ce,ii),b.addEventListener("touchmove",he,ii)}function Le(){var b=z();b.removeEventListener("mousedown",te,!0),b.removeEventListener("touchend",te,ii),b.removeEventListener("touchstart",ce,ii),b.removeEventListener("touchmove",he,ii)}function ot(b,U){dn(b,function(){!S.state.isVisible&&T.parentNode&&T.parentNode.contains(T)&&U()})}function V(b,U){dn(b,U)}function dn(b,U){var re=ie().box;function ge(me){me.target===re&&(Kc(re,"remove",ge),U())}if(b===0)return U();Kc(re,"remove",p),Kc(re,"add",ge),p=ge}function qt(b,U,re){re===void 0&&(re=!1);var ge=Ki(S.props.triggerTarget||t);ge.forEach(function(me){me.addEventListener(b,U,re),g.push({node:me,eventType:b,handler:U,options:re})})}function Wt(){q()&&(qt("touchstart",Nn,{passive:!0}),qt("touchend",Ui,{passive:!0})),HR(S.props.trigger).forEach(function(b){if(b!=="manual")switch(qt(b,Nn),b){case"mouseenter":qt("mouseleave",Ui);break;case"focus":qt(tD?"focusout":"blur",Qr);break;case"focusin":qt("focusout",Qr);break}})}function Vi(){g.forEach(function(b){var U=b.node,re=b.eventType,ge=b.handler,me=b.options;U.removeEventListener(re,ge,me)}),g=[]}function Nn(b){var U,re=!1;if(!(!S.state.isEnabled||ur(b)||l)){var ge=((U=c)==null?void 0:U.type)==="focus";c=b,v=b.currentTarget,Z(),!S.state.isVisible&&WR(b)&&Xl.forEach(function(me){return me(b)}),b.type==="click"&&(S.props.trigger.indexOf("mouseenter")<0||s)&&S.props.hideOnClick!==!1&&S.state.isVisible?re=!0:cr(b),b.type==="click"&&(s=!re),re&&!ge&&Bn(b)}}function Bi(b){var U=b.target,re=F().contains(U)||T.contains(U);if(!(b.type==="mousemove"&&re)){var ge=kn().concat(T).map(function(me){var gt,jt=me._tippy,Hi=(gt=jt.popperInstance)==null?void 0:gt.state;return Hi?{popperRect:me.getBoundingClientRect(),popperState:Hi,props:n}:null}).filter(Boolean);YR(ge,b)&&(oe(),Bn(b))}}function Ui(b){var U=ur(b)||S.props.trigger.indexOf("click")>=0&&s;if(!U){if(S.props.interactive){S.hideWithInteractivity(b);return}Bn(b)}}function Qr(b){S.props.trigger.indexOf("focusin")<0&&b.target!==F()||S.props.interactive&&b.relatedTarget&&T.contains(b.relatedTarget)||Bn(b)}function ur(b){return bn.isTouch?q()!==b.type.indexOf("touch")>=0:!1}function fn(){zi();var b=S.props,U=b.popperOptions,re=b.placement,ge=b.offset,me=b.getReferenceClientRect,gt=b.moveTransition,jt=$()?Sf(T).arrow:null,Hi=me?{getBoundingClientRect:me,contextElement:me.contextElement||F()}:t,kh={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Cl){var $i=Cl.state;if($()){var lC=ie(),Zu=lC.box;["placement","reference-hidden","escaped"].forEach(function(El){El==="placement"?Zu.setAttribute("data-placement",$i.placement):$i.attributes.popper["data-popper-"+El]?Zu.setAttribute("data-"+El,""):Zu.removeAttribute("data-"+El)}),$i.attributes.popper={}}}},ei=[{name:"offset",options:{offset:ge}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!gt}},kh];$()&&jt&&ei.push({name:"arrow",options:{element:jt,padding:3}}),ei.push.apply(ei,(U==null?void 0:U.modifiers)||[]),S.popperInstance=BR(Hi,T,Object.assign({},U,{placement:re,onFirstUpdate:m,modifiers:ei}))}function zi(){S.popperInstance&&(S.popperInstance.destroy(),S.popperInstance=null)}function pn(){var b=S.props.appendTo,U,re=F();S.props.interactive&&b===mS||b==="parent"?U=re.parentNode:U=gS(b,[re]),U.contains(T)||U.appendChild(T),S.state.isMounted=!0,fn()}function kn(){return su(T.querySelectorAll("[data-tippy-root]"))}function cr(b){S.clearDelayTimeouts(),b&&L("onTrigger",[S,b]),be();var U=Y(!0),re=M(),ge=re[0],me=re[1];bn.isTouch&&ge==="hold"&&me&&(U=me),U?r=setTimeout(function(){S.show()},U):S.show()}function Bn(b){if(S.clearDelayTimeouts(),L("onUntrigger",[S,b]),!S.state.isVisible){Le();return}if(!(S.props.trigger.indexOf("mouseenter")>=0&&S.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(b.type)>=0&&s)){var U=Y(!1);U?i=setTimeout(function(){S.state.isVisible&&S.hide()},U):o=requestAnimationFrame(function(){S.hide()})}}function Zr(){S.state.isEnabled=!0}function A(){S.hide(),S.state.isEnabled=!1}function H(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)}function j(b){if(!S.state.isDestroyed){L("onBeforeUpdate",[S,b]),Vi();var U=S.props,re=cy(t,Object.assign({},U,sy(b),{ignoreAttributes:!0}));S.props=re,Wt(),U.interactiveDebounce!==re.interactiveDebounce&&(oe(),y=iy(Bi,re.interactiveDebounce)),U.triggerTarget&&!re.triggerTarget?Ki(U.triggerTarget).forEach(function(ge){ge.removeAttribute("aria-expanded")}):re.triggerTarget&&t.removeAttribute("aria-expanded"),Z(),se(),k&&k(U,re),S.popperInstance&&(fn(),kn().forEach(function(ge){requestAnimationFrame(ge._tippy.popperInstance.forceUpdate)})),L("onAfterUpdate",[S,b])}}function B(b){S.setProps({content:b})}function ee(){var b=S.state.isVisible,U=S.state.isDestroyed,re=!S.state.isEnabled,ge=bn.isTouch&&!S.props.touch,me=jc(S.props.duration,0,xn.duration);if(!(b||U||re||ge)&&!F().hasAttribute("disabled")&&(L("onShow",[S],!1),S.props.onShow(S)!==!1)){if(S.state.isVisible=!0,$()&&(T.style.visibility="visible"),se(),be(),S.state.isMounted||(T.style.transition="none"),$()){var gt=ie(),jt=gt.box,Hi=gt.content;Jc([jt,Hi],0)}m=function(){var ei;if(!(!S.state.isVisible||u)){if(u=!0,T.offsetHeight,T.style.transition=S.props.moveTransition,$()&&S.props.animation){var Qu=ie(),Cl=Qu.box,$i=Qu.content;Jc([Cl,$i],me),ly([Cl,$i],"visible")}X(),Z(),oy(Yc,S),(ei=S.popperInstance)==null||ei.forceUpdate(),L("onMount",[S]),S.props.animation&&$()&&V(me,function(){S.state.isShown=!0,L("onShown",[S])})}},pn()}}function ye(){var b=!S.state.isVisible,U=S.state.isDestroyed,re=!S.state.isEnabled,ge=jc(S.props.duration,1,xn.duration);if(!(b||U||re)&&(L("onHide",[S],!1),S.props.onHide(S)!==!1)){if(S.state.isVisible=!1,S.state.isShown=!1,u=!1,s=!1,$()&&(T.style.visibility="hidden"),oe(),Le(),se(!0),$()){var me=ie(),gt=me.box,jt=me.content;S.props.animation&&(Jc([gt,jt],ge),ly([gt,jt],"hidden"))}X(),Z(),S.props.animation?$()&&ot(ge,S.unmount):S.unmount()}}function ve(b){z().addEventListener("mousemove",y),oy(Xl,y),y(b)}function fe(){S.state.isVisible&&S.hide(),S.state.isMounted&&(zi(),kn().forEach(function(b){b._tippy.unmount()}),T.parentNode&&T.parentNode.removeChild(T),Yc=Yc.filter(function(b){return b!==S}),S.state.isMounted=!1,L("onHidden",[S]))}function Tt(){S.state.isDestroyed||(S.clearDelayTimeouts(),S.unmount(),Vi(),delete t._tippy,S.state.isDestroyed=!0,L("onDestroy",[S]))}}function Oi(t,e){e===void 0&&(e={});var n=xn.plugins.concat(e.plugins||[]);ZR();var r=Object.assign({},e,{plugins:n}),i=JR(t),o=i.reduce(function(s,l){var a=l&&uD(l,r);return a&&s.push(a),s},[]);return ju(t)?o[0]:o}Oi.defaultProps=xn;Oi.setDefaultProps=oD;Oi.currentInput=bn;Object.assign({},iS,{effect:function(e){var n=e.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}});Oi.setDefaultProps({render:xS});class cD{constructor({editor:e,element:n,view:r,tippyOptions:i={},updateDelay:o=250,shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:l,state:a,from:u,to:c})=>{const{doc:p,selection:m}=a,{empty:g}=m,y=!p.textBetween(u,c).length&&ih(a.selection),v=this.element.contains(document.activeElement);return!(!(l.hasFocus()||v)||g||y||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:l})=>{var a;if(this.preventHide){this.preventHide=!1;return}l!=null&&l.relatedTarget&&(!((a=this.element.parentNode)===null||a===void 0)&&a.contains(l.relatedTarget))||(l==null?void 0:l.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=l=>{this.blurHandler({event:l})},this.handleDebouncedUpdate=(l,a)=>{const u=!(a!=null&&a.selection.eq(l.state.selection)),c=!(a!=null&&a.doc.eq(l.state.doc));!u&&!c||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(l,u,c,a)},this.updateDelay))},this.updateHandler=(l,a,u,c)=>{var p,m,g;const{state:y,composing:v}=l,{selection:w}=y;if(v||!a&&!u)return;this.createTooltip();const{ranges:E}=w,C=Math.min(...E.map(T=>T.$from.pos)),S=Math.max(...E.map(T=>T.$to.pos));if(!((p=this.shouldShow)===null||p===void 0?void 0:p.call(this,{editor:this.editor,element:this.element,view:l,state:y,oldState:c,from:C,to:S}))){this.hide();return}(m=this.tippy)===null||m===void 0||m.setProps({getReferenceClientRect:((g=this.tippyOptions)===null||g===void 0?void 0:g.getReferenceClientRect)||(()=>{if(eS(y.selection)){let T=l.nodeDOM(C);if(T){const k=T.dataset.nodeViewWrapper?T:T.querySelector("[data-node-view-wrapper]");if(k&&(T=k.firstChild),T)return T.getBoundingClientRect()}}return tS(l,C,S)})}),this.show()},this.editor=e,this.element=n,this.view=r,this.updateDelay=o,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,n=!!e.parentElement;this.element.tabIndex=0,!(this.tippy||!n)&&(this.tippy=Oi(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,n){const{state:r}=e,i=r.selection.from!==r.selection.to;if(this.updateDelay>0&&i){this.handleDebouncedUpdate(e,n);return}const o=!(n!=null&&n.selection.eq(e.state.selection)),s=!(n!=null&&n.doc.eq(e.state.doc));this.updateHandler(e,o,s,n)}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,n;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const wS=t=>new Qe({key:typeof t.pluginKey=="string"?new Lt(t.pluginKey):t.pluginKey,view:e=>new cD({view:e,...t})});Ge.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[wS({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class dD{getTextContent(e){return Qw(e,{textSerializers:nh(this.editor.schema)})}constructor({editor:e,element:n,view:r,tippyOptions:i={},shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:s,state:l})=>{const{selection:a}=l,{$anchor:u,empty:c}=a,p=u.depth===1,m=u.parent.isTextblock&&!u.parent.type.spec.code&&!u.parent.textContent&&u.parent.childCount===0&&!this.getTextContent(u.parent);return!(!s.hasFocus()||!c||!p||!m||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:s})=>{var l;if(this.preventHide){this.preventHide=!1;return}s!=null&&s.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(s.relatedTarget))||(s==null?void 0:s.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=s=>{this.blurHandler({event:s})},this.editor=e,this.element=n,this.view=r,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,n=!!e.parentElement;this.element.tabIndex=0,!(this.tippy||!n)&&(this.tippy=Oi(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,n){var r,i,o;const{state:s}=e,{doc:l,selection:a}=s,{from:u,to:c}=a;if(n&&n.doc.eq(l)&&n.selection.eq(a))return;if(this.createTooltip(),!((r=this.shouldShow)===null||r===void 0?void 0:r.call(this,{editor:this.editor,view:e,state:s,oldState:n}))){this.hide();return}(i=this.tippy)===null||i===void 0||i.setProps({getReferenceClientRect:((o=this.tippyOptions)===null||o===void 0?void 0:o.getReferenceClientRect)||(()=>tS(e,u,c))}),this.show()}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,n;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const SS=t=>new Qe({key:typeof t.pluginKey=="string"?new Lt(t.pluginKey):t.pluginKey,view:e=>new dD({view:e,...t})});Ge.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[SS({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});function fD(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var CS={exports:{}},Xc={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var py;function pD(){if(py)return Xc;py=1;var t=Se;function e(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,o=t.useLayoutEffect,s=t.useDebugValue;function l(p,m){var g=m(),y=r({inst:{value:g,getSnapshot:m}}),v=y[0].inst,w=y[1];return o(function(){v.value=g,v.getSnapshot=m,a(v)&&w({inst:v})},[p,g,m]),i(function(){return a(v)&&w({inst:v}),p(function(){a(v)&&w({inst:v})})},[p]),s(g),g}function a(p){var m=p.getSnapshot;p=p.value;try{var g=m();return!n(p,g)}catch{return!0}}function u(p,m){return m()}var c=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return Xc.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:c,Xc}CS.exports=pD();var mh=CS.exports;const hD=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},mD=({contentComponent:t})=>{const e=mh.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return Se.createElement(Se.Fragment,null,Object.values(e))};function gD(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:DT.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}class yD extends Se.Component{constructor(e){var n;super(e),this.editorContentRef=Se.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=gD(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return Se.createElement(Se.Fragment,null,Se.createElement("div",{ref:hD(n,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&Se.createElement(mD,{contentComponent:e.contentComponent}))}}const vD=_.forwardRef((t,e)=>{const n=Se.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return Se.createElement(yD,{key:n,innerRef:e,...t})}),xD=Se.memo(vD);var wD=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],n.get(i[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(e[i]!==n[i])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!(s==="_owner"&&e.$$typeof)&&!t(e[s],n[s]))return!1}return!0}return e!==e&&n!==n},SD=fD(wD),ES={exports:{}},Qc={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy;function CD(){if(hy)return Qc;hy=1;var t=Se,e=mh;function n(u,c){return u===c&&(u!==0||1/u===1/c)||u!==u&&c!==c}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,o=t.useRef,s=t.useEffect,l=t.useMemo,a=t.useDebugValue;return Qc.useSyncExternalStoreWithSelector=function(u,c,p,m,g){var y=o(null);if(y.current===null){var v={hasValue:!1,value:null};y.current=v}else v=y.current;y=l(function(){function x(T){if(!E){if(E=!0,C=T,T=m(T),g!==void 0&&v.hasValue){var k=v.value;if(g(k,T))return S=k}return S=T}if(k=S,r(C,T))return k;var I=m(T);return g!==void 0&&g(k,I)?k:(C=T,S=I)}var E=!1,C,S,N=p===void 0?null:p;return[function(){return x(c())},N===null?void 0:function(){return x(N())}]},[c,p,m,g]);var w=i(u,y[0],y[1]);return s(function(){v.hasValue=!0,v.value=w},[w]),a(w),w},Qc}ES.exports=CD();var ED=ES.exports;const TD=typeof window<"u"?_.useLayoutEffect:_.useEffect;class ND{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function kD(t){var e;const[n]=_.useState(()=>new ND(t.editor)),r=ED.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:SD);return TD(()=>n.watch(t.editor),[t.editor,n]),_.useDebugValue(r),r}const AD=!1,Cf=typeof window>"u",ID=Cf||!!(typeof window<"u"&&window.next);class gh{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Cf||ID?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)===null||o===void 0?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)===null||o===void 0?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)===null||o===void 0?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)===null||o===void 0?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)===null||o===void 0?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)===null||o===void 0?void 0:o.call(i,...r)}};return new __(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,o)=>{var s;return i===((s=n.extensions)===null||s===void 0?void 0:s[o])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?gh.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function MD(t={},e=[]){const n=_.useRef(t);n.current=t;const[r]=_.useState(()=>new gh(n)),i=mh.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return _.useDebugValue(i),_.useEffect(r.onRender(e)),kD({editor:i,selector:({transactionNumber:o})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&o===0?0:o+1}),i}const TS=_.createContext({editor:null});TS.Consumer;const NS=()=>_.useContext(TS),bD=t=>{const[e,n]=_.useState(null),{editor:r}=NS();return _.useEffect(()=>{var i;if(!e||!((i=t.editor)===null||i===void 0)&&i.isDestroyed||r!=null&&r.isDestroyed)return;const{pluginKey:o="bubbleMenu",editor:s,tippyOptions:l={},updateDelay:a,shouldShow:u=null}=t,c=s||r;if(!c){console.warn("BubbleMenu component is not rendered inside of an editor component or does not have editor prop.");return}const p=wS({updateDelay:a,editor:c,element:e,pluginKey:o,shouldShow:u,tippyOptions:l});return c.registerPlugin(p),()=>{c.unregisterPlugin(o)}},[t.editor,r,e]),Se.createElement("div",{ref:n,className:t.className,style:{visibility:"hidden"}},t.children)},_D=t=>{const[e,n]=_.useState(null),{editor:r}=NS();return _.useEffect(()=>{var i;if(!e||!((i=t.editor)===null||i===void 0)&&i.isDestroyed||r!=null&&r.isDestroyed)return;const{pluginKey:o="floatingMenu",editor:s,tippyOptions:l={},shouldShow:a=null}=t,u=s||r;if(!u){console.warn("FloatingMenu component is not rendered inside of an editor component or does not have editor prop.");return}const c=SS({pluginKey:o,editor:u,element:e,tippyOptions:l,shouldShow:a});return u.registerPlugin(c),()=>{u.unregisterPlugin(o)}},[t.editor,r,e]),Se.createElement("div",{ref:n,className:t.className,style:{visibility:"hidden"}},t.children)},RD=_.createContext({onDragStart:void 0}),DD=()=>_.useContext(RD);Se.forwardRef((t,e)=>{const{onDragStart:n}=DD(),r=t.as||"div";return Se.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});function my(t){return!!(typeof t=="function"&&t.prototype&&t.prototype.isReactComponent)}function gy(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.forward_ref)"||t.$$typeof.description==="react.forward_ref"))}function PD(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.memo)"||t.$$typeof.description==="react.memo"))}function LD(t){if(my(t)||gy(t))return!0;if(PD(t)){const e=t.type;if(e)return my(e)||gy(e)}return!1}function OD(){try{if(_.version)return parseInt(_.version.split(".")[0],10)>=19}catch{}return!1}class FD{constructor(e,{editor:n,props:r={},as:i="div",className:o=""}){this.ref=null,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=e,this.editor=n,this.props=r,this.element=document.createElement(i),this.element.classList.add("react-renderer"),o&&this.element.classList.add(...o.split(" ")),this.editor.isInitialized?Iu.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.render()})}render(){var e;const n=this.component,r=this.props,i=this.editor,o=OD(),s=LD(n),l={...r};l.ref&&!(o||s)&&delete l.ref,!l.ref&&(o||s)&&(l.ref=a=>{this.ref=a}),this.reactElement=Se.createElement(n,{...l}),(e=i==null?void 0:i.contentComponent)===null||e===void 0||e.setRenderer(this.id,this)}updateProps(e={}){this.props={...this.props,...e},this.render()}destroy(){var e;const n=this.editor;(e=n==null?void 0:n.contentComponent)===null||e===void 0||e.removeRenderer(this.id)}updateAttributes(e){Object.keys(e).forEach(n=>{this.element.setAttribute(n,e[n])})}}const VD=/^\s*>\s$/,BD=Pt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",ht(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[sl({find:VD,type:this.type})]}}),UD=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,zD=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,HD=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,$D=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,GD=rr.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",ht(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Oo({find:UD,type:this.type}),Oo({find:HD,type:this.type})]},addPasteRules(){return[Fo({find:zD,type:this.type}),Fo({find:$D,type:this.type})]}}),qD="listItem",yy="textStyle",vy=/^\s*([-+*])\s$/,WD=Pt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",ht(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(qD,this.editor.getAttributes(yy)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=sl({find:vy,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=sl({find:vy,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(yy),editor:this.editor})),[t]}}),jD=/(^|[^`])`([^`]+)`(?!`)/,JD=/(^|[^`])`([^`]+)`(?!`)/g,KD=rr.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",ht(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Oo({find:jD,type:this.type})]},addPasteRules(){return[Fo({find:JD,type:this.type})]}}),YD=/^```([a-z]+)?[\s\n]$/,XD=/^~~~([a-z]+)?[\s\n]$/,QD=Pt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,o=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(n)).map(s=>s.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",ht(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:t.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const l=i.after();return l===void 0?!1:r.nodeAt(l)?t.commands.command(({tr:u})=>(u.setSelection(ae.near(r.resolve(l))),!0)):t.commands.exitCode()}}},addInputRules(){return[yf({find:YD,type:this.type,getAttributes:t=>({language:t[1]})}),yf({find:XD,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Qe({key:new Lt("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i==null?void 0:i.mode;if(!n||!o)return!1;const{tr:s,schema:l}=t.state,a=l.text(n.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},a)),s.selection.$from.parent.type!==this.type&&s.setSelection(le.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),ZD=Pt.create({name:"doc",topNode:!0,content:"block+"});function eP(t={}){return new Qe({view(e){return new tP(e,t)}})}class tP{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,i=this.editorView.dom,o=i.getBoundingClientRect(),s=o.width/i.offsetWidth,l=o.height/i.offsetHeight;if(n){let p=e.nodeBefore,m=e.nodeAfter;if(p||m){let g=this.editorView.nodeDOM(this.cursorPos-(p?p.nodeSize:0));if(g){let y=g.getBoundingClientRect(),v=p?y.bottom:y.top;p&&m&&(v=(v+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*l;r={left:y.left,right:y.right,top:v-w,bottom:v+w}}}}if(!r){let p=this.editorView.coordsAtPos(this.cursorPos),m=this.width/2*s;r={left:p.left-m,right:p.left+m,top:p.top,bottom:p.bottom}}let a=this.editorView.dom.offsetParent;this.element||(this.element=a.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let u,c;if(!a||a==document.body&&getComputedStyle(a).position=="static")u=-pageXOffset,c=-pageYOffset;else{let p=a.getBoundingClientRect(),m=p.width/a.offsetWidth,g=p.height/a.offsetHeight;u=p.left-a.scrollLeft*m,c=p.top-a.scrollTop*g}this.element.style.left=(r.left-u)/s+"px",this.element.style.top=(r.top-c)/l+"px",this.element.style.width=(r.right-r.left)/s+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!o){let s=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=$1(this.editorView.state.doc,s,this.editorView.dragging.slice);l!=null&&(s=l)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const nP=Ge.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[eP(this.options)]}});class Fe extends ae{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Fe.valid(r)?new Fe(r):ae.near(r)}content(){return W.empty}eq(e){return e instanceof Fe&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Fe(e.resolve(n.pos))}getBookmark(){return new yh(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!rP(e)||!iP(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Fe.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let l=e.node(s);if(n>0?e.indexAfter(s)<l.childCount:e.index(s)>0){o=l.child(n>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=n;let a=e.doc.resolve(i);if(Fe.valid(a))return a}for(;;){let s=n>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!ne.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*n),r=!1;continue e}break}o=s,i+=n;let l=e.doc.resolve(i);if(Fe.valid(l))return l}return null}}}Fe.prototype.visible=!1;Fe.findFrom=Fe.findGapCursorFrom;ae.jsonID("gapcursor",Fe);class yh{constructor(e){this.pos=e}map(e){return new yh(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Fe.valid(n)?new Fe(n):ae.near(n)}}function kS(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function rP(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||kS(i.type))return!0;if(i.inlineContent)return!1}}return!0}function iP(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||kS(i.type))return!0;if(i.inlineContent)return!1}}return!0}function oP(){return new Qe({props:{decorations:uP,createSelectionBetween(t,e,n){return e.pos==n.pos&&Fe.valid(n)?new Fe(n):null},handleClick:lP,handleKeyDown:sP,handleDOMEvents:{beforeinput:aP}}})}const sP=_w({ArrowLeft:Ql("horiz",-1),ArrowRight:Ql("horiz",1),ArrowUp:Ql("vert",-1),ArrowDown:Ql("vert",1)});function Ql(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,l=e>0?s.$to:s.$from,a=s.empty;if(s instanceof le){if(!o.endOfTextblock(n)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let u=Fe.findGapCursorFrom(l,e,a);return u?(i&&i(r.tr.setSelection(new Fe(u))),!0):!1}}function lP(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Fe.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&ne.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Fe(r))),!0)}function aP(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Fe))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=P.empty;for(let s=r.length-1;s>=0;s--)i=P.from(r[s].createAndFill(null,i));let o=t.state.tr.replace(n.pos,n.pos,new W(i,0,0));return o.setSelection(le.near(o.doc.resolve(n.pos+1))),t.dispatch(o),!1}function uP(t){if(!(t.selection instanceof Fe))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ve.create(t.doc,[At.widget(t.selection.head,e,{key:"gapcursor"})])}const cP=Ge.create({name:"gapCursor",addProseMirrorPlugins(){return[oP()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=ue(Q(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),dP=Pt.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",ht(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:o}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:l}=r.extensionManager,a=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&a&&s){const p=a.filter(m=>l.includes(m.type.name));u.ensureMarks(p)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),fP=Pt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,ht(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>yf({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var lu=200,Ye=function(){};Ye.prototype.append=function(e){return e.length?(e=Ye.from(e),!this.length&&e||e.length<lu&&this.leafAppend(e)||this.length<lu&&e.leafPrepend(this)||this.appendInner(e)):this};Ye.prototype.prepend=function(e){return e.length?Ye.from(e).append(this):this};Ye.prototype.appendInner=function(e){return new pP(this,e)};Ye.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?Ye.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};Ye.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Ye.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};Ye.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},n,r),i};Ye.from=function(e){return e instanceof Ye?e:e&&e.length?new AS(e):Ye.empty};var AS=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,l){for(var a=o;a<s;a++)if(i(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,l){for(var a=o-1;a>=s;a--)if(i(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=lu)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=lu)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(Ye);Ye.empty=new AS([]);var pP=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(o,l),s)===!1||o>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,o)-l,s+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(o,l)-l,s+l)===!1||o<l&&this.left.forEachInvertedInner(r,Math.min(i,l),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(Ye);const hP=500;class vn{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;n&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,l,a,u=[],c=[];return this.items.forEach((p,m)=>{if(!p.step){i||(i=this.remapping(r,m+1),o=i.maps.length),o--,c.push(p);return}if(i){c.push(new Mn(p.map));let g=p.step.map(i.slice(o)),y;g&&s.maybeStep(g).doc&&(y=s.mapping.maps[s.mapping.maps.length-1],u.push(new Mn(y,void 0,void 0,u.length+c.length))),o--,y&&i.appendMap(y,o)}else s.maybeStep(p.step);if(p.selection)return l=i?p.selection.map(i.slice(o)):p.selection,a=new vn(this.items.slice(0,r).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:s,selection:l}}addTransform(e,n,r,i){let o=[],s=this.eventCount,l=this.items,a=!i&&l.length?l.get(l.length-1):null;for(let c=0;c<e.steps.length;c++){let p=e.steps[c].invert(e.docs[c]),m=new Mn(e.mapping.maps[c],p,n),g;(g=a&&a.merge(m))&&(m=g,c?o.pop():l=l.slice(0,l.length-1)),o.push(m),n&&(s++,n=void 0),i||(a=m)}let u=s-r.depth;return u>gP&&(l=mP(l,u),s-=u),new vn(l.append(o),s)}remapping(e,n){let r=new Zs;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,n),r}addMaps(e){return this.eventCount==0?this:new vn(this.items.append(e.map(n=>new Mn(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),o=e.mapping,s=e.steps.length,l=this.eventCount;this.items.forEach(m=>{m.selection&&l--},i);let a=n;this.items.forEach(m=>{let g=o.getMirror(--a);if(g==null)return;s=Math.min(s,g);let y=o.maps[g];if(m.step){let v=e.steps[g].invert(e.docs[g]),w=m.selection&&m.selection.map(o.slice(a+1,g));w&&l++,r.push(new Mn(y,v,w))}else r.push(new Mn(y))},i);let u=[];for(let m=n;m<s;m++)u.push(new Mn(o.maps[m]));let c=this.items.slice(0,i).append(u).append(r),p=new vn(c,l);return p.emptyItemCount()>hP&&(p=p.compress(this.items.length-r.length)),p}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],o=0;return this.items.forEach((s,l)=>{if(l>=e)i.push(s),s.selection&&o++;else if(s.step){let a=s.step.map(n.slice(r)),u=a&&a.getMap();if(r--,u&&n.appendMap(u,r),a){let c=s.selection&&s.selection.map(n.slice(r));c&&o++;let p=new Mn(u.invert(),a,c),m,g=i.length-1;(m=i.length&&i[g].merge(p))?i[g]=m:i.push(p)}}else s.map&&r--},this.items.length,0),new vn(Ye.from(i.reverse()),o)}}vn.empty=new vn(Ye.empty,0);function mP(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}class Mn{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new Mn(n.getMap().invert(),n,this.selection)}}}class yr{constructor(e,n,r,i,o){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const gP=20;function yP(t,e,n,r){let i=n.getMeta(xi),o;if(i)return i.historyState;n.getMeta(wP)&&(t=new yr(t.done,t.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(s&&s.getMeta(xi))return s.getMeta(xi).redo?new yr(t.done.addTransform(n,void 0,r,ya(e)),t.undone,xy(n.mapping.maps),t.prevTime,t.prevComposition):new yr(t.done,t.undone.addTransform(n,void 0,r,ya(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),a=t.prevTime==0||!s&&t.prevComposition!=l&&(t.prevTime<(n.time||0)-r.newGroupDelay||!vP(n,t.prevRanges)),u=s?Zc(t.prevRanges,n.mapping):xy(n.mapping.maps);return new yr(t.done.addTransform(n,a?e.selection.getBookmark():void 0,r,ya(e)),vn.empty,u,n.time,l??t.prevComposition)}else return(o=n.getMeta("rebased"))?new yr(t.done.rebased(n,o),t.undone.rebased(n,o),Zc(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new yr(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Zc(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function vP(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(n=!0)}),n}function xy(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,o,s)=>e.push(o,s));return e}function Zc(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),o=e.map(t[r+1],-1);i<=o&&n.push(i,o)}return n}function xP(t,e,n){let r=ya(e),i=xi.get(e).spec.config,o=(n?t.undone:t.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),l=(n?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),a=new yr(n?l:o.remaining,n?o.remaining:l,null,0,-1);return o.transform.setSelection(s).setMeta(xi,{redo:n,historyState:a})}let ed=!1,wy=null;function ya(t){let e=t.plugins;if(wy!=e){ed=!1,wy=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){ed=!0;break}}return ed}const xi=new Lt("history"),wP=new Lt("closeHistory");function SP(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Qe({key:xi,state:{init(){return new yr(vn.empty,vn.empty,null,0,-1)},apply(e,n,r){return yP(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?MS:r=="historyRedo"?bS:null;return!i||!e.editable?!1:(n.preventDefault(),i(e.state,e.dispatch))}}}})}function IS(t,e){return(n,r)=>{let i=xi.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let o=xP(i,n,t);o&&r(e?o.scrollIntoView():o)}return!0}}const MS=IS(!1,!0),bS=IS(!0,!0),CP=Ge.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>MS(t,e),redo:()=>({state:t,dispatch:e})=>bS(t,e)}},addProseMirrorPlugins(){return[SP(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),EP=Pt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",ht(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!D_(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$from:r,$to:i}=n,o=t();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):eS(n)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:s,dispatch:l})=>{var a;if(l){const{$to:u}=s.selection,c=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?s.setSelection(le.create(s.doc,u.pos+1)):u.nodeAfter.isBlock?s.setSelection(ne.create(s.doc,u.pos)):s.setSelection(le.create(s.doc,u.pos));else{const p=(a=u.parent.type.contentMatch.defaultType)===null||a===void 0?void 0:a.create();p&&(s.insert(c,p),s.setSelection(le.create(s.doc,c+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[R_({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),TP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,NP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,kP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,AP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,IP=rr.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",ht(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Oo({find:TP,type:this.type}),Oo({find:kP,type:this.type})]},addPasteRules(){return[Fo({find:NP,type:this.type}),Fo({find:AP,type:this.type})]}}),MP=Pt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",ht(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),bP="listItem",Sy="textStyle",Cy=/^(\d+)\.\s$/,_P=Pt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",ht(this.options.HTMLAttributes,n),0]:["ol",ht(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(bP,this.editor.getAttributes(Sy)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=sl({find:Cy,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=sl({find:Cy,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Sy)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),RP=Pt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",ht(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),DP=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,PP=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,LP=rr.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",ht(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Oo({find:DP,type:this.type})]},addPasteRules(){return[Fo({find:PP,type:this.type})]}}),OP=Pt.create({name:"text",group:"inline"}),FP=Ge.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(GD.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(BD.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push(WD.configure(this.options.bulletList)),this.options.code!==!1&&t.push(KD.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(QD.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(ZD.configure(this.options.document)),this.options.dropcursor!==!1&&t.push(nP.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(cP.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push(dP.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(fP.configure(this.options.heading)),this.options.history!==!1&&t.push(CP.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push(EP.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(IP.configure(this.options.italic)),this.options.listItem!==!1&&t.push(MP.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(_P.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(RP.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(LP.configure(this.options.strike)),this.options.text!==!1&&t.push(OP.configure(this.options.text)),t}}),VP=Ge.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Qe({key:new Lt("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!n)return null;const o=this.editor.isEmpty;return t.descendants((s,l)=>{const a=r>=l&&r<=l+s.nodeSize,u=!s.isLeaf&&qu(s);if((a||!this.options.showOnlyCurrent)&&u){const c=[this.options.emptyNodeClass];o&&c.push(this.options.emptyEditorClass);const p=At.node(l,l+s.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:l,hasAnchor:a}):this.options.placeholder});i.push(p)}return this.options.includeChildren}),Ve.create(t,i)}}})]}}),BP=rr.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",ht(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let UP,zP;function HP(){return{geminiUrl:UP,vertexUrl:zP}}function $P(t,e,n,r){var i,o;if(!(t!=null&&t.baseUrl)){const s=HP();return e?(i=s.vertexUrl)!==null&&i!==void 0?i:n:(o=s.geminiUrl)!==null&&o!==void 0?o:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lr{}function G(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const o=e[i];return o!=null?String(o):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function f(t,e,n){for(let o=0;o<e.length-1;o++){const s=e[o];if(s.endsWith("[]")){const l=s.slice(0,-2);if(!(l in t))if(Array.isArray(n))t[l]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(t[l])){const a=t[l];if(Array.isArray(n))for(let u=0;u<a.length;u++){const c=a[u];f(c,e.slice(o+1),n[u])}else for(const u of a)f(u,e.slice(o+1),n)}return}else if(s.endsWith("[0]")){const l=s.slice(0,-3);l in t||(t[l]=[{}]);const a=t[l];f(a[0],e.slice(o+1),n);return}(!t[s]||typeof t[s]!="object")&&(t[s]={}),t=t[s]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function d(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const o=i.slice(0,-2);if(o in t){const s=t[o];return Array.isArray(s)?s.map(l=>d(l,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function GP(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),o=r.split("."),s=new Set;let l=-1;for(let a=0;a<i.length;a++)if(i[a]==="*"){l=a;break}if(l!==-1&&o.length>l)for(let a=l;a<o.length;a++){const u=o[a];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&s.add(u)}Ef(t,i,o,0,s)}}function Ef(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const o=e[r];if(o.endsWith("[]")){const s=o.slice(0,-2),l=t;if(s in l&&Array.isArray(l[s]))for(const a of l[s])Ef(a,e,n,r+1,i)}else if(o==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const s=t,l=Object.keys(s).filter(u=>!u.startsWith("_")&&!i.has(u)),a={};for(const u of l)a[u]=s[u];for(const[u,c]of Object.entries(a)){const p=[];for(const m of n.slice(r))m==="*"?p.push(u):p.push(m);f(s,p,c)}for(const u of l)delete s[u]}}else{const s=t;o in s&&Ef(s[o],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vh(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qP(t){const e={},n=d(t,["operationName"]);n!=null&&f(e,["operationName"],n);const r=d(t,["resourceName"]);return r!=null&&f(e,["_url","resourceName"],r),e}function WP(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const o=d(t,["error"]);o!=null&&f(e,["error"],o);const s=d(t,["response","generateVideoResponse"]);return s!=null&&f(e,["response"],JP(s)),e}function jP(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const o=d(t,["error"]);o!=null&&f(e,["error"],o);const s=d(t,["response"]);return s!=null&&f(e,["response"],KP(s)),e}function JP(t){const e={},n=d(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>YP(s))),f(e,["generatedVideos"],o)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function KP(t){const e={},n=d(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>XP(s))),f(e,["generatedVideos"],o)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function YP(t){const e={},n=d(t,["video"]);return n!=null&&f(e,["video"],r2(n)),e}function XP(t){const e={},n=d(t,["_self"]);return n!=null&&f(e,["video"],i2(n)),e}function QP(t){const e={},n=d(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function ZP(t){const e={},n=d(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function e2(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const o=d(t,["error"]);o!=null&&f(e,["error"],o);const s=d(t,["response"]);return s!=null&&f(e,["response"],t2(s)),e}function t2(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["parent"]);r!=null&&f(e,["parent"],r);const i=d(t,["documentName"]);return i!=null&&f(e,["documentName"],i),e}function _S(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const o=d(t,["error"]);o!=null&&f(e,["error"],o);const s=d(t,["response"]);return s!=null&&f(e,["response"],n2(s)),e}function n2(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["parent"]);r!=null&&f(e,["parent"],r);const i=d(t,["documentName"]);return i!=null&&f(e,["documentName"],i),e}function r2(t){const e={},n=d(t,["uri"]);n!=null&&f(e,["uri"],n);const r=d(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],vh(r));const i=d(t,["encoding"]);return i!=null&&f(e,["mimeType"],i),e}function i2(t){const e={},n=d(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],vh(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ey;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Ey||(Ey={}));var Ty;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Ty||(Ty={}));var Ny;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Ny||(Ny={}));var kr;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(kr||(kr={}));var ky;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(ky||(ky={}));var Ay;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Ay||(Ay={}));var Iy;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Iy||(Iy={}));var My;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(My||(My={}));var by;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(by||(by={}));var _y;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.HIGH="HIGH"})(_y||(_y={}));var Ry;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Ry||(Ry={}));var Dy;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Dy||(Dy={}));var Py;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Py||(Py={}));var Ly;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(Ly||(Ly={}));var Oy;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Oy||(Oy={}));var Fy;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Fy||(Fy={}));var Vy;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Vy||(Vy={}));var By;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(By||(By={}));var Uy;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Uy||(Uy={}));var au;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(au||(au={}));var zy;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(zy||(zy={}));var Hy;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Hy||(Hy={}));var $y;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})($y||($y={}));var Tf;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Tf||(Tf={}));var Gy;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Gy||(Gy={}));var qy;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(qy||(qy={}));var Wy;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Wy||(Wy={}));var jy;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(jy||(jy={}));var Jy;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Jy||(Jy={}));var Ky;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Ky||(Ky={}));var Yy;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Yy||(Yy={}));var Xy;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Xy||(Xy={}));var Qy;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Qy||(Qy={}));var Zy;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Zy||(Zy={}));var e0;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(e0||(e0={}));var t0;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(t0||(t0={}));var n0;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(n0||(n0={}));var r0;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(r0||(r0={}));var i0;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(i0||(i0={}));var o0;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(o0||(o0={}));var s0;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(s0||(s0={}));var l0;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(l0||(l0={}));var a0;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(a0||(a0={}));var u0;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(u0||(u0={}));var c0;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(c0||(c0={}));var d0;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(d0||(d0={}));var f0;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(f0||(f0={}));var p0;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(p0||(p0={}));var h0;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(h0||(h0={}));var m0;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(m0||(m0={}));var g0;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(g0||(g0={}));var y0;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(y0||(y0={}));var v0;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(v0||(v0={}));var x0;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(x0||(x0={}));var co;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(co||(co={}));class Nf{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class ls{get text(){var e,n,r,i,o,s,l,a;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",c=!1;const p=[];for(const m of(a=(l=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||l===void 0?void 0:l.parts)!==null&&a!==void 0?a:[]){for(const[g,y]of Object.entries(m))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(y!==null||y!==void 0)&&p.push(g);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;c=!0,u+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),c?u:void 0}get data(){var e,n,r,i,o,s,l,a;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const c=[];for(const p of(a=(l=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||l===void 0?void 0:l.parts)!==null&&a!==void 0?a:[]){for(const[m,g]of Object.entries(p))m!=="inlineData"&&(g!==null||g!==void 0)&&c.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return c.length>0&&console.warn(`there are non-data parts ${c} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,o,s,l,a;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(a=(l=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||l===void 0?void 0:l.parts)===null||a===void 0?void 0:a.filter(c=>c.functionCall).map(c=>c.functionCall).filter(c=>c!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,o,s,l,a,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const c=(a=(l=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||l===void 0?void 0:l.parts)===null||a===void 0?void 0:a.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((c==null?void 0:c.length)!==0)return(u=c==null?void 0:c[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,o,s,l,a,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const c=(a=(l=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||l===void 0?void 0:l.parts)===null||a===void 0?void 0:a.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((c==null?void 0:c.length)!==0)return(u=c==null?void 0:c[0])===null||u===void 0?void 0:u.output}}class w0{}class S0{}class o2{}class s2{}class l2{}class a2{}class C0{}class E0{}class T0{}class u2{}class uu{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new uu;let i;const o=e;return n?i=jP(o):i=WP(o),Object.assign(r,i),r}}class N0{}class k0{}class A0{}class I0{}class c2{}class d2{}class f2{}class xh{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new xh,o=e2(e);return Object.assign(r,o),r}}class p2{}class h2{}class m2{}class M0{}class g2{get text(){var e,n,r;let i="",o=!1;const s=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,u]of Object.entries(l))a!=="text"&&a!=="thought"&&u!==null&&s.push(a);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;o=!0,i+=l.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?i:void 0}get data(){var e,n,r;let i="";const o=[];for(const s of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,a]of Object.entries(s))l!=="inlineData"&&a!==null&&o.push(l);s.inlineData&&typeof s.inlineData.data=="string"&&(i+=atob(s.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class y2{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class wh{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new wh,o=_S(e);return Object.assign(r,o),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function we(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function RS(t,e){const n=we(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function DS(t){return Array.isArray(t)?t.map(e=>cu(e)):[cu(t)]}function cu(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function PS(t){const e=cu(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function LS(t){const e=cu(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function b0(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function OS(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>b0(e)):[b0(t)]}function kf(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function _0(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function R0(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function dt(t){if(t==null)throw new Error("ContentUnion is required");return kf(t)?t:{role:"user",parts:OS(t)}}function Sh(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=dt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=dt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>dt(n)):[dt(e)]}function sn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(_0(t)||R0(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[dt(t)]}const e=[],n=[],r=kf(t[0]);for(const i of t){const o=kf(i);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(i);else{if(_0(i)||R0(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:OS(n)}),e}function v2(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(kr).includes(n[0].toUpperCase())?n[0].toUpperCase():kr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(kr).includes(r.toUpperCase())?r.toUpperCase():kr.TYPE_UNSPECIFIED})}}function Co(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=t.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,t=o[1]):o[1].type==="null"&&(e.nullable=!0,t=o[0])),t.type instanceof Array&&v2(t.type,e);for(const[s,l]of Object.entries(t))if(l!=null)if(s=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;e.type=Object.values(kr).includes(l.toUpperCase())?l.toUpperCase():kr.TYPE_UNSPECIFIED}else if(n.includes(s))e[s]=Co(l);else if(r.includes(s)){const a=[];for(const u of l){if(u.type=="null"){e.nullable=!0;continue}a.push(Co(u))}e[s]=a}else if(i.includes(s)){const a={};for(const[u,c]of Object.entries(l))a[u]=Co(c);e[s]=a}else{if(s==="additionalProperties")continue;e[s]=l}return e}function Ch(t){return Co(t)}function Eh(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Th(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Wo(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Co(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Co(e.response));return t}function jo(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function x2(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function ar(t,e){if(typeof e!="string")throw new Error("name must be a string");return x2(t,e,"cachedContents")}function FS(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Xr(t){return vh(t)}function w2(t){return t!=null&&typeof t=="object"&&"name"in t}function S2(t){return t!=null&&typeof t=="object"&&"video"in t}function C2(t){return t!=null&&typeof t=="object"&&"uri"in t}function VS(t){var e;let n;if(w2(t)&&(n=t.name),!(C2(t)&&(n=t.uri,n===void 0))&&!(S2(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function BS(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function US(t){for(const e of["models","tunedModels","publisherModels"])if(E2(t,e))return t[e];return[]}function E2(t,e){return t!==null&&typeof t=="object"&&e in t}function T2(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function N2(t,e={}){const n=[],r=new Set;for(const i of t){const o=i.name;if(r.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);r.add(o);const s=T2(i,e);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}function zS(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function k2(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function HS(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let o=!1;for(const s of i){if(typeof s!="object"||s===null)continue;const a=s.response;if(typeof a!="object"||a===null)continue;if(a.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Jo(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function $S(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function A2(t){const e={},n=d(t,["responsesFile"]);n!=null&&f(e,["fileName"],n);const r=d(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>lL(s))),f(e,["inlinedResponses"],o)}const i=d(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),f(e,["inlinedEmbedContentResponses"],o)}return e}function I2(t){const e={},n=d(t,["predictionsFormat"]);n!=null&&f(e,["format"],n);const r=d(t,["gcsDestination","outputUriPrefix"]);r!=null&&f(e,["gcsUri"],r);const i=d(t,["bigqueryDestination","outputUri"]);return i!=null&&f(e,["bigqueryUri"],i),e}function M2(t){const e={},n=d(t,["format"]);n!=null&&f(e,["predictionsFormat"],n);const r=d(t,["gcsUri"]);r!=null&&f(e,["gcsDestination","outputUriPrefix"],r);const i=d(t,["bigqueryUri"]);if(i!=null&&f(e,["bigqueryDestination","outputUri"],i),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function va(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata","displayName"]);r!=null&&f(e,["displayName"],r);const i=d(t,["metadata","state"]);i!=null&&f(e,["state"],$S(i));const o=d(t,["metadata","createTime"]);o!=null&&f(e,["createTime"],o);const s=d(t,["metadata","endTime"]);s!=null&&f(e,["endTime"],s);const l=d(t,["metadata","updateTime"]);l!=null&&f(e,["updateTime"],l);const a=d(t,["metadata","model"]);a!=null&&f(e,["model"],a);const u=d(t,["metadata","output"]);return u!=null&&f(e,["dest"],A2(HS(u))),e}function Af(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["displayName"]);r!=null&&f(e,["displayName"],r);const i=d(t,["state"]);i!=null&&f(e,["state"],$S(i));const o=d(t,["error"]);o!=null&&f(e,["error"],o);const s=d(t,["createTime"]);s!=null&&f(e,["createTime"],s);const l=d(t,["startTime"]);l!=null&&f(e,["startTime"],l);const a=d(t,["endTime"]);a!=null&&f(e,["endTime"],a);const u=d(t,["updateTime"]);u!=null&&f(e,["updateTime"],u);const c=d(t,["model"]);c!=null&&f(e,["model"],c);const p=d(t,["inputConfig"]);p!=null&&f(e,["src"],b2(p));const m=d(t,["outputConfig"]);m!=null&&f(e,["dest"],I2(HS(m)));const g=d(t,["completionStats"]);return g!=null&&f(e,["completionStats"],g),e}function b2(t){const e={},n=d(t,["instancesFormat"]);n!=null&&f(e,["format"],n);const r=d(t,["gcsSource","uris"]);r!=null&&f(e,["gcsUri"],r);const i=d(t,["bigquerySource","inputUri"]);return i!=null&&f(e,["bigqueryUri"],i),e}function _2(t,e){const n={};if(d(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=d(e,["fileName"]);r!=null&&f(n,["fileName"],r);const i=d(e,["inlinedRequests"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>sL(t,s))),f(n,["requests","requests"],o)}return n}function R2(t){const e={},n=d(t,["format"]);n!=null&&f(e,["instancesFormat"],n);const r=d(t,["gcsUri"]);r!=null&&f(e,["gcsSource","uris"],r);const i=d(t,["bigqueryUri"]);if(i!=null&&f(e,["bigquerySource","inputUri"],i),d(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function D2(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function P2(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Jo(t,r)),n}function L2(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Jo(t,r)),n}function O2(t){const e={},n=d(t,["content"]);n!=null&&f(e,["content"],n);const r=d(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],F2(r));const i=d(t,["tokenCount"]);i!=null&&f(e,["tokenCount"],i);const o=d(t,["finishReason"]);o!=null&&f(e,["finishReason"],o);const s=d(t,["avgLogprobs"]);s!=null&&f(e,["avgLogprobs"],s);const l=d(t,["groundingMetadata"]);l!=null&&f(e,["groundingMetadata"],l);const a=d(t,["index"]);a!=null&&f(e,["index"],a);const u=d(t,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const c=d(t,["safetyRatings"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(g=>g)),f(e,["safetyRatings"],m)}const p=d(t,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function F2(t){const e={},n=d(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["citations"],r)}return e}function GS(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>hL(o))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function V2(t,e){const n={},r=d(t,["displayName"]);if(e!==void 0&&r!=null&&f(e,["batch","displayName"],r),d(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function B2(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const i=d(t,["dest"]);return e!==void 0&&i!=null&&f(e,["outputConfig"],M2(k2(i))),n}function D0(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["src"]);i!=null&&f(n,["batch","inputConfig"],_2(t,zS(t,i)));const o=d(e,["config"]);return o!=null&&V2(o,n),n}function U2(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],we(t,r));const i=d(e,["src"]);i!=null&&f(n,["inputConfig"],R2(zS(t,i)));const o=d(e,["config"]);return o!=null&&B2(o,n),n}function z2(t,e){const n={},r=d(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["batch","displayName"],r),n}function H2(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["src"]);i!=null&&f(n,["batch","inputConfig"],K2(t,i));const o=d(e,["config"]);return o!=null&&z2(o,n),n}function $2(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Jo(t,r)),n}function G2(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Jo(t,r)),n}function q2(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const o=d(t,["error"]);return o!=null&&f(e,["error"],o),e}function W2(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const o=d(t,["error"]);return o!=null&&f(e,["error"],o),e}function j2(t,e){const n={},r=d(e,["contents"]);if(r!=null){let o=Sh(t,r);Array.isArray(o)&&(o=o.map(s=>s)),f(n,["requests[]","request","content"],o)}const i=d(e,["config"]);return i!=null&&(f(n,["_self"],J2(i,n)),GP(n,{"requests[].*":"requests[].request.*"})),n}function J2(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&f(e,["requests[]","title"],i);const o=d(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&f(e,["requests[]","outputDimensionality"],o),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function K2(t,e){const n={},r=d(e,["fileName"]);r!=null&&f(n,["file_name"],r);const i=d(e,["inlinedRequests"]);return i!=null&&f(n,["requests"],j2(t,i)),n}function Y2(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function X2(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const i=d(t,["name"]);if(i!=null&&f(e,["name"],i),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Q2(t){const e={},n=d(t,["mode"]);n!=null&&f(e,["mode"],n);const r=d(t,["allowedFunctionNames"]);if(r!=null&&f(e,["allowedFunctionNames"],r),d(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Z2(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],GS(dt(i)));const o=d(e,["temperature"]);o!=null&&f(r,["temperature"],o);const s=d(e,["topP"]);s!=null&&f(r,["topP"],s);const l=d(e,["topK"]);l!=null&&f(r,["topK"],l);const a=d(e,["candidateCount"]);a!=null&&f(r,["candidateCount"],a);const u=d(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const c=d(e,["stopSequences"]);c!=null&&f(r,["stopSequences"],c);const p=d(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=d(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const g=d(e,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const y=d(e,["frequencyPenalty"]);y!=null&&f(r,["frequencyPenalty"],y);const v=d(e,["seed"]);v!=null&&f(r,["seed"],v);const w=d(e,["responseMimeType"]);w!=null&&f(r,["responseMimeType"],w);const x=d(e,["responseSchema"]);x!=null&&f(r,["responseSchema"],Ch(x));const E=d(e,["responseJsonSchema"]);if(E!=null&&f(r,["responseJsonSchema"],E),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=d(e,["safetySettings"]);if(n!==void 0&&C!=null){let F=C;Array.isArray(F)&&(F=F.map(z=>mL(z))),f(n,["safetySettings"],F)}const S=d(e,["tools"]);if(n!==void 0&&S!=null){let F=jo(S);Array.isArray(F)&&(F=F.map(z=>yL(Wo(z)))),f(n,["tools"],F)}const N=d(e,["toolConfig"]);if(n!==void 0&&N!=null&&f(n,["toolConfig"],gL(N)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const T=d(e,["cachedContent"]);n!==void 0&&T!=null&&f(n,["cachedContent"],ar(t,T));const k=d(e,["responseModalities"]);k!=null&&f(r,["responseModalities"],k);const I=d(e,["mediaResolution"]);I!=null&&f(r,["mediaResolution"],I);const R=d(e,["speechConfig"]);if(R!=null&&f(r,["speechConfig"],Eh(R)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const M=d(e,["thinkingConfig"]);M!=null&&f(r,["thinkingConfig"],M);const q=d(e,["imageConfig"]);q!=null&&f(r,["imageConfig"],oL(q));const $=d(e,["enableEnhancedCivicAnswers"]);return $!=null&&f(r,["enableEnhancedCivicAnswers"],$),r}function eL(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>O2(u))),f(e,["candidates"],a)}const i=d(t,["modelVersion"]);i!=null&&f(e,["modelVersion"],i);const o=d(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const s=d(t,["responseId"]);s!=null&&f(e,["responseId"],s);const l=d(t,["usageMetadata"]);return l!=null&&f(e,["usageMetadata"],l),e}function tL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Jo(t,r)),n}function nL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],Jo(t,r)),n}function rL(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function iL(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function oL(t){const e={},n=d(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=d(t,["imageSize"]);if(r!=null&&f(e,["imageSize"],r),d(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function sL(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["request","model"],we(t,r));const i=d(e,["contents"]);if(i!=null){let l=sn(i);Array.isArray(l)&&(l=l.map(a=>GS(a))),f(n,["request","contents"],l)}const o=d(e,["metadata"]);o!=null&&f(n,["metadata"],o);const s=d(e,["config"]);return s!=null&&f(n,["request","generationConfig"],Z2(t,s,d(n,["request"],{}))),n}function lL(t){const e={},n=d(t,["response"]);n!=null&&f(e,["response"],eL(n));const r=d(t,["error"]);return r!=null&&f(e,["error"],r),e}function aL(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);if(e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),d(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function uL(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);e!==void 0&&i!=null&&f(e,["_query","pageToken"],i);const o=d(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),n}function cL(t){const e={},n=d(t,["config"]);return n!=null&&aL(n,e),e}function dL(t){const e={},n=d(t,["config"]);return n!=null&&uL(n,e),e}function fL(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["operations"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>va(s))),f(e,["batchJobs"],o)}return e}function pL(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["batchPredictionJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Af(s))),f(e,["batchJobs"],o)}return e}function hL(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const o=d(t,["fileData"]);o!=null&&f(e,["fileData"],Y2(o));const s=d(t,["functionCall"]);s!=null&&f(e,["functionCall"],X2(s));const l=d(t,["functionResponse"]);l!=null&&f(e,["functionResponse"],l);const a=d(t,["inlineData"]);a!=null&&f(e,["inlineData"],D2(a));const u=d(t,["text"]);u!=null&&f(e,["text"],u);const c=d(t,["thought"]);c!=null&&f(e,["thought"],c);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function mL(t){const e={},n=d(t,["category"]);if(n!=null&&f(e,["category"],n),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function gL(t){const e={},n=d(t,["functionCallingConfig"]);n!=null&&f(e,["functionCallingConfig"],Q2(n));const r=d(t,["retrievalConfig"]);return r!=null&&f(e,["retrievalConfig"],r),e}function yL(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(p=>p)),f(e,["functionDeclarations"],c)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=d(t,["computerUse"]);i!=null&&f(e,["computerUse"],i);const o=d(t,["fileSearch"]);o!=null&&f(e,["fileSearch"],o);const s=d(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=d(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],rL(l));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],iL(a));const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var or;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(or||(or={}));class Fi{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,o;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!r||Object.keys(r).length===0?s={config:{}}:typeof r=="object"?s=Object.assign({},r):s=r,s.config&&(s.config.pageToken=n.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(o=(i=s.config)===null||i===void 0?void 0:i.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vL extends lr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Fi(or.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=D0(this.apiClient,e),r=n._url,i=G("{model}:batchGenerateContent",r),l=n.batch.inputConfig.requests,a=l.requests,u=[];for(const c of a){const p=Object.assign({},c);if(p.systemInstruction){const m=p.systemInstruction;delete p.systemInstruction;const g=p.request;g.systemInstruction=m,p.request=g}u.push(p)}return l.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const o=this.getGcsUri(e),s=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?r.dest=`${o.slice(0,-6)}/dest`:r.dest=`${o}_dest_${i}`;else if(s)r.dest=`${s}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=U2(this.apiClient,e);return l=G("batchPredictionJobs",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>Af(c))}else{const u=D0(this.apiClient,e);return l=G("{model}:batchGenerateContent",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>va(c))}}async createEmbeddingsInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=H2(this.apiClient,e);return o=G("{model}:asyncBatchEmbedContent",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>va(a))}}async get(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=nL(this.apiClient,e);return l=G("batchPredictionJobs/{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>Af(c))}else{const u=tL(this.apiClient,e);return l=G("batches/{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>va(c))}}async cancel(e){var n,r,i,o;let s="",l={};if(this.apiClient.isVertexAI()){const a=L2(this.apiClient,e);s=G("batchPredictionJobs/{name}:cancel",a._url),l=a._query,delete a._url,delete a._query,await this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const a=P2(this.apiClient,e);s=G("batches/{name}:cancel",a._url),l=a._query,delete a._url,delete a._query,await this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=dL(e);return l=G("batchPredictionJobs",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=pL(c),m=new M0;return Object.assign(m,p),m})}else{const u=cL(e);return l=G("batches",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=fL(c),m=new M0;return Object.assign(m,p),m})}}async delete(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=G2(this.apiClient,e);return l=G("batchPredictionJobs/{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>W2(c))}else{const u=$2(this.apiClient,e);return l=G("batches/{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>q2(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xL(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function P0(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>HL(o))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function wL(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);e!==void 0&&i!=null&&f(e,["expireTime"],i);const o=d(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const s=d(t,["contents"]);if(e!==void 0&&s!=null){let c=sn(s);Array.isArray(c)&&(c=c.map(p=>P0(p))),f(e,["contents"],c)}const l=d(t,["systemInstruction"]);e!==void 0&&l!=null&&f(e,["systemInstruction"],P0(dt(l)));const a=d(t,["tools"]);if(e!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(p=>GL(p))),f(e,["tools"],c)}const u=d(t,["toolConfig"]);if(e!==void 0&&u!=null&&f(e,["toolConfig"],$L(u)),d(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function SL(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);e!==void 0&&i!=null&&f(e,["expireTime"],i);const o=d(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const s=d(t,["contents"]);if(e!==void 0&&s!=null){let p=sn(s);Array.isArray(p)&&(p=p.map(m=>m)),f(e,["contents"],p)}const l=d(t,["systemInstruction"]);e!==void 0&&l!=null&&f(e,["systemInstruction"],dt(l));const a=d(t,["tools"]);if(e!==void 0&&a!=null){let p=a;Array.isArray(p)&&(p=p.map(m=>qL(m))),f(e,["tools"],p)}const u=d(t,["toolConfig"]);e!==void 0&&u!=null&&f(e,["toolConfig"],u);const c=d(t,["kmsKeyName"]);return e!==void 0&&c!=null&&f(e,["encryption_spec","kmsKeyName"],c),n}function CL(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],RS(t,r));const i=d(e,["config"]);return i!=null&&wL(i,n),n}function EL(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["model"],RS(t,r));const i=d(e,["config"]);return i!=null&&SL(i,n),n}function TL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],ar(t,r)),n}function NL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],ar(t,r)),n}function kL(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function AL(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function IL(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function ML(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const i=d(t,["name"]);if(i!=null&&f(e,["name"],i),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function bL(t){const e={},n=d(t,["mode"]);n!=null&&f(e,["mode"],n);const r=d(t,["allowedFunctionNames"]);if(r!=null&&f(e,["allowedFunctionNames"],r),d(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function _L(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&f(e,["description"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["parameters"]);i!=null&&f(e,["parameters"],i);const o=d(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const s=d(t,["response"]);s!=null&&f(e,["response"],s);const l=d(t,["responseJsonSchema"]);return l!=null&&f(e,["responseJsonSchema"],l),e}function RL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],ar(t,r)),n}function DL(t,e){const n={},r=d(e,["name"]);return r!=null&&f(n,["_url","name"],ar(t,r)),n}function PL(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function LL(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function OL(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function FL(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function VL(t){const e={},n=d(t,["config"]);return n!=null&&OL(n,e),e}function BL(t){const e={},n=d(t,["config"]);return n!=null&&FL(n,e),e}function UL(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),f(e,["cachedContents"],o)}return e}function zL(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),f(e,["cachedContents"],o)}return e}function HL(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const o=d(t,["fileData"]);o!=null&&f(e,["fileData"],IL(o));const s=d(t,["functionCall"]);s!=null&&f(e,["functionCall"],ML(s));const l=d(t,["functionResponse"]);l!=null&&f(e,["functionResponse"],l);const a=d(t,["inlineData"]);a!=null&&f(e,["inlineData"],xL(a));const u=d(t,["text"]);u!=null&&f(e,["text"],u);const c=d(t,["thought"]);c!=null&&f(e,["thought"],c);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function $L(t){const e={},n=d(t,["functionCallingConfig"]);n!=null&&f(e,["functionCallingConfig"],bL(n));const r=d(t,["retrievalConfig"]);return r!=null&&f(e,["retrievalConfig"],r),e}function GL(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(p=>p)),f(e,["functionDeclarations"],c)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=d(t,["computerUse"]);i!=null&&f(e,["computerUse"],i);const o=d(t,["fileSearch"]);o!=null&&f(e,["fileSearch"],o);const s=d(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=d(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],PL(l));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],LL(a));const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function qL(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>_L(m))),f(e,["functionDeclarations"],p)}const r=d(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const o=d(t,["computerUse"]);if(o!=null&&f(e,["computerUse"],o),d(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=d(t,["codeExecution"]);s!=null&&f(e,["codeExecution"],s);const l=d(t,["enterpriseWebSearch"]);l!=null&&f(e,["enterpriseWebSearch"],l);const a=d(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const u=d(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const c=d(t,["urlContext"]);return c!=null&&f(e,["urlContext"],c),e}function WL(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);return e!==void 0&&i!=null&&f(e,["expireTime"],i),n}function jL(t,e){const n={},r=d(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=d(t,["expireTime"]);return e!==void 0&&i!=null&&f(e,["expireTime"],i),n}function JL(t,e){const n={},r=d(e,["name"]);r!=null&&f(n,["_url","name"],ar(t,r));const i=d(e,["config"]);return i!=null&&WL(i,n),n}function KL(t,e){const n={},r=d(e,["name"]);r!=null&&f(n,["_url","name"],ar(t,r));const i=d(e,["config"]);return i!=null&&jL(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YL extends lr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Fi(or.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=EL(this.apiClient,e);return l=G("cachedContents",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>c)}else{const u=CL(this.apiClient,e);return l=G("cachedContents",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async get(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=DL(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>c)}else{const u=RL(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=NL(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=AL(c),m=new A0;return Object.assign(m,p),m})}else{const u=TL(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=kL(c),m=new A0;return Object.assign(m,p),m})}}async update(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=KL(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>c)}else{const u=JL(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async listInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=BL(e);return l=G("cachedContents",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=zL(c),m=new I0;return Object.assign(m,p),m})}else{const u=VL(e);return l=G("cachedContents",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=UL(c),m=new I0;return Object.assign(m,p),m})}}}function L0(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ie(t){return this instanceof Ie?(this.v=t,this):new Ie(t)}function Eo(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(g){return function(y){return Promise.resolve(y).then(g,p)}}function l(g,y){r[g]&&(i[g]=function(v){return new Promise(function(w,x){o.push([g,v,w,x])>1||a(g,v)})},y&&(i[g]=y(i[g])))}function a(g,y){try{u(r[g](y))}catch(v){m(o[0][3],v)}}function u(g){g.value instanceof Ie?Promise.resolve(g.value.v).then(c,p):m(o[0][2],g)}function c(g){a("next",g)}function p(g){a("throw",g)}function m(g,y){g(y),o.shift(),o.length&&a(o[0][0],o[0][1])}}function Rs(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof L0=="function"?L0(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(l,a){s=t[o](s),i(l,a,s.done,s.value)})}}function i(o,s,l,a){Promise.resolve(a).then(function(u){o({value:u,done:l})},s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XL(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:qS(n)}function qS(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function QL(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function O0(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let o=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),o&&!qS(t[r])&&(o=!1),r++;o?e.push(...i):e.pop()}return e}class ZL{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new eO(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class eO{constructor(e,n,r,i={},o=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=o,this.sendPromise=Promise.resolve(),QL(o)}async sendMessage(e){var n;await this.sendPromise;const r=dt(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,s,l;const a=await i,u=(s=(o=a.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content,c=a.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];c!=null&&(m=(l=c.slice(p))!==null&&l!==void 0?l:[]);const g=u?[u]:[];this.recordHistory(r,g,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=dt(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const o=await i;return this.processStreamResponse(o,r)}getHistory(e=!1){const n=e?O0(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return Eo(this,arguments,function*(){var i,o,s,l,a,u;const c=[];try{for(var p=!0,m=Rs(e),g;g=yield Ie(m.next()),i=g.done,!i;p=!0){l=g.value,p=!1;const y=l;if(XL(y)){const v=(u=(a=y.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content;v!==void 0&&c.push(v)}yield yield Ie(y)}}catch(y){o={error:y}}finally{try{!p&&!i&&(s=m.return)&&(yield Ie(s.call(m)))}finally{if(o)throw o.error}}this.recordHistory(n,c)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(o=>o.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...O0(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ju extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Ju.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tO(t){const e={},n=d(t,["file"]);return n!=null&&f(e,["file"],n),e}function nO(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function rO(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","file"],VS(n)),e}function iO(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function oO(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","file"],VS(n)),e}function sO(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function lO(t){const e={},n=d(t,["config"]);return n!=null&&sO(n,e),e}function aO(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["files"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),f(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uO extends lr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Fi(or.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=lO(e);return o=G("files",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:a.headers},c})),i.then(a=>{const u=aO(a),c=new p2;return Object.assign(c,u),c})}}async createInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=tO(e);return o=G("upload/v1beta/files",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>{const u=nO(a),c=new h2;return Object.assign(c,u),c})}}async get(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=oO(e);return o=G("files/{file}",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>a)}}async delete(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=rO(e);return o=G("files/{file}",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:a.headers},c})),i.then(a=>{const u=iO(a),c=new m2;return Object.assign(c,u),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xa(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function cO(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>kO(o))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function dO(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function fO(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const i=d(t,["name"]);if(i!=null&&f(e,["name"],i),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function pO(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&f(e,["description"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["parameters"]);i!=null&&f(e,["parameters"],i);const o=d(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const s=d(t,["response"]);s!=null&&f(e,["response"],s);const l=d(t,["responseJsonSchema"]);return l!=null&&f(e,["responseJsonSchema"],l),e}function hO(t){const e={},n=d(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=d(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const i=d(t,["audioTimestamp"]);i!=null&&f(e,["audioTimestamp"],i);const o=d(t,["candidateCount"]);o!=null&&f(e,["candidateCount"],o);const s=d(t,["enableAffectiveDialog"]);s!=null&&f(e,["enableAffectiveDialog"],s);const l=d(t,["frequencyPenalty"]);l!=null&&f(e,["frequencyPenalty"],l);const a=d(t,["logprobs"]);a!=null&&f(e,["logprobs"],a);const u=d(t,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const c=d(t,["mediaResolution"]);c!=null&&f(e,["mediaResolution"],c);const p=d(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=d(t,["responseLogprobs"]);m!=null&&f(e,["responseLogprobs"],m);const g=d(t,["responseMimeType"]);g!=null&&f(e,["responseMimeType"],g);const y=d(t,["responseModalities"]);y!=null&&f(e,["responseModalities"],y);const v=d(t,["responseSchema"]);v!=null&&f(e,["responseSchema"],v);const w=d(t,["routingConfig"]);w!=null&&f(e,["routingConfig"],w);const x=d(t,["seed"]);x!=null&&f(e,["seed"],x);const E=d(t,["speechConfig"]);E!=null&&f(e,["speechConfig"],WS(E));const C=d(t,["stopSequences"]);C!=null&&f(e,["stopSequences"],C);const S=d(t,["temperature"]);S!=null&&f(e,["temperature"],S);const N=d(t,["thinkingConfig"]);N!=null&&f(e,["thinkingConfig"],N);const T=d(t,["topK"]);T!=null&&f(e,["topK"],T);const k=d(t,["topP"]);if(k!=null&&f(e,["topP"],k),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function mO(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function gO(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function yO(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const o=d(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const s=d(t,["topP"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","topP"],s);const l=d(t,["topK"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","topK"],l);const a=d(t,["maxOutputTokens"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","maxOutputTokens"],a);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const c=d(t,["seed"]);e!==void 0&&c!=null&&f(e,["setup","generationConfig","seed"],c);const p=d(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],Th(p));const m=d(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=d(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=d(t,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],cO(dt(y)));const v=d(t,["tools"]);if(e!==void 0&&v!=null){let T=jo(v);Array.isArray(T)&&(T=T.map(k=>IO(Wo(k)))),f(e,["setup","tools"],T)}const w=d(t,["sessionResumption"]);e!==void 0&&w!=null&&f(e,["setup","sessionResumption"],AO(w));const x=d(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","inputAudioTranscription"],x);const E=d(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&f(e,["setup","outputAudioTranscription"],E);const C=d(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&f(e,["setup","realtimeInputConfig"],C);const S=d(t,["contextWindowCompression"]);e!==void 0&&S!=null&&f(e,["setup","contextWindowCompression"],S);const N=d(t,["proactivity"]);return e!==void 0&&N!=null&&f(e,["setup","proactivity"],N),n}function vO(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],hO(r));const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const o=d(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const s=d(t,["topP"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","topP"],s);const l=d(t,["topK"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","topK"],l);const a=d(t,["maxOutputTokens"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","maxOutputTokens"],a);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const c=d(t,["seed"]);e!==void 0&&c!=null&&f(e,["setup","generationConfig","seed"],c);const p=d(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],WS(Th(p)));const m=d(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=d(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=d(t,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],dt(y));const v=d(t,["tools"]);if(e!==void 0&&v!=null){let T=jo(v);Array.isArray(T)&&(T=T.map(k=>MO(Wo(k)))),f(e,["setup","tools"],T)}const w=d(t,["sessionResumption"]);e!==void 0&&w!=null&&f(e,["setup","sessionResumption"],w);const x=d(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","inputAudioTranscription"],x);const E=d(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&f(e,["setup","outputAudioTranscription"],E);const C=d(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&f(e,["setup","realtimeInputConfig"],C);const S=d(t,["contextWindowCompression"]);e!==void 0&&S!=null&&f(e,["setup","contextWindowCompression"],S);const N=d(t,["proactivity"]);return e!==void 0&&N!=null&&f(e,["setup","proactivity"],N),n}function xO(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],we(t,r));const i=d(e,["config"]);return i!=null&&f(n,["config"],yO(i,n)),n}function wO(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],we(t,r));const i=d(e,["config"]);return i!=null&&f(n,["config"],vO(i,n)),n}function SO(t){const e={},n=d(t,["musicGenerationConfig"]);return n!=null&&f(e,["musicGenerationConfig"],n),e}function CO(t){const e={},n=d(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["weightedPrompts"],r)}return e}function EO(t){const e={},n=d(t,["media"]);if(n!=null){let u=DS(n);Array.isArray(u)&&(u=u.map(c=>xa(c))),f(e,["mediaChunks"],u)}const r=d(t,["audio"]);r!=null&&f(e,["audio"],xa(LS(r)));const i=d(t,["audioStreamEnd"]);i!=null&&f(e,["audioStreamEnd"],i);const o=d(t,["video"]);o!=null&&f(e,["video"],xa(PS(o)));const s=d(t,["text"]);s!=null&&f(e,["text"],s);const l=d(t,["activityStart"]);l!=null&&f(e,["activityStart"],l);const a=d(t,["activityEnd"]);return a!=null&&f(e,["activityEnd"],a),e}function TO(t){const e={},n=d(t,["media"]);if(n!=null){let u=DS(n);Array.isArray(u)&&(u=u.map(c=>c)),f(e,["mediaChunks"],u)}const r=d(t,["audio"]);r!=null&&f(e,["audio"],LS(r));const i=d(t,["audioStreamEnd"]);i!=null&&f(e,["audioStreamEnd"],i);const o=d(t,["video"]);o!=null&&f(e,["video"],PS(o));const s=d(t,["text"]);s!=null&&f(e,["text"],s);const l=d(t,["activityStart"]);l!=null&&f(e,["activityStart"],l);const a=d(t,["activityEnd"]);return a!=null&&f(e,["activityEnd"],a),e}function NO(t){const e={},n=d(t,["setupComplete"]);n!=null&&f(e,["setupComplete"],n);const r=d(t,["serverContent"]);r!=null&&f(e,["serverContent"],r);const i=d(t,["toolCall"]);i!=null&&f(e,["toolCall"],i);const o=d(t,["toolCallCancellation"]);o!=null&&f(e,["toolCallCancellation"],o);const s=d(t,["usageMetadata"]);s!=null&&f(e,["usageMetadata"],bO(s));const l=d(t,["goAway"]);l!=null&&f(e,["goAway"],l);const a=d(t,["sessionResumptionUpdate"]);return a!=null&&f(e,["sessionResumptionUpdate"],a),e}function kO(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const o=d(t,["fileData"]);o!=null&&f(e,["fileData"],dO(o));const s=d(t,["functionCall"]);s!=null&&f(e,["functionCall"],fO(s));const l=d(t,["functionResponse"]);l!=null&&f(e,["functionResponse"],l);const a=d(t,["inlineData"]);a!=null&&f(e,["inlineData"],xa(a));const u=d(t,["text"]);u!=null&&f(e,["text"],u);const c=d(t,["thought"]);c!=null&&f(e,["thought"],c);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function AO(t){const e={},n=d(t,["handle"]);if(n!=null&&f(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function WS(t){const e={},n=d(t,["voiceConfig"]);n!=null&&f(e,["voiceConfig"],n);const r=d(t,["languageCode"]);if(r!=null&&f(e,["languageCode"],r),d(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function IO(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(p=>p)),f(e,["functionDeclarations"],c)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=d(t,["computerUse"]);i!=null&&f(e,["computerUse"],i);const o=d(t,["fileSearch"]);o!=null&&f(e,["fileSearch"],o);const s=d(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=d(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],mO(l));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],gO(a));const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function MO(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>pO(m))),f(e,["functionDeclarations"],p)}const r=d(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const o=d(t,["computerUse"]);if(o!=null&&f(e,["computerUse"],o),d(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=d(t,["codeExecution"]);s!=null&&f(e,["codeExecution"],s);const l=d(t,["enterpriseWebSearch"]);l!=null&&f(e,["enterpriseWebSearch"],l);const a=d(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const u=d(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const c=d(t,["urlContext"]);return c!=null&&f(e,["urlContext"],c),e}function bO(t){const e={},n=d(t,["promptTokenCount"]);n!=null&&f(e,["promptTokenCount"],n);const r=d(t,["cachedContentTokenCount"]);r!=null&&f(e,["cachedContentTokenCount"],r);const i=d(t,["candidatesTokenCount"]);i!=null&&f(e,["responseTokenCount"],i);const o=d(t,["toolUsePromptTokenCount"]);o!=null&&f(e,["toolUsePromptTokenCount"],o);const s=d(t,["thoughtsTokenCount"]);s!=null&&f(e,["thoughtsTokenCount"],s);const l=d(t,["totalTokenCount"]);l!=null&&f(e,["totalTokenCount"],l);const a=d(t,["promptTokensDetails"]);if(a!=null){let g=a;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["promptTokensDetails"],g)}const u=d(t,["cacheTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["cacheTokensDetails"],g)}const c=d(t,["candidatesTokensDetails"]);if(c!=null){let g=c;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["responseTokensDetails"],g)}const p=d(t,["toolUsePromptTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["toolUsePromptTokensDetails"],g)}const m=d(t,["trafficType"]);return m!=null&&f(e,["trafficType"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _O(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function RO(t){const e={},n=d(t,["content"]);n!=null&&f(e,["content"],n);const r=d(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],DO(r));const i=d(t,["tokenCount"]);i!=null&&f(e,["tokenCount"],i);const o=d(t,["finishReason"]);o!=null&&f(e,["finishReason"],o);const s=d(t,["avgLogprobs"]);s!=null&&f(e,["avgLogprobs"],s);const l=d(t,["groundingMetadata"]);l!=null&&f(e,["groundingMetadata"],l);const a=d(t,["index"]);a!=null&&f(e,["index"],a);const u=d(t,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const c=d(t,["safetyRatings"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(g=>g)),f(e,["safetyRatings"],m)}const p=d(t,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function DO(t){const e={},n=d(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["citations"],r)}return e}function PO(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["contents"]);if(i!=null){let o=sn(i);Array.isArray(o)&&(o=o.map(s=>s)),f(n,["contents"],o)}return n}function LO(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),f(e,["tokensInfo"],i)}return e}function OO(t){const e={},n=d(t,["values"]);n!=null&&f(e,["values"],n);const r=d(t,["statistics"]);return r!=null&&f(e,["statistics"],FO(r)),e}function FO(t){const e={},n=d(t,["truncated"]);n!=null&&f(e,["truncated"],n);const r=d(t,["token_count"]);return r!=null&&f(e,["tokenCount"],r),e}function Ku(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>W4(o))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function VO(t){const e={},n=d(t,["controlType"]);n!=null&&f(e,["controlType"],n);const r=d(t,["enableControlImageComputation"]);return r!=null&&f(e,["computeControl"],r),e}function BO(t){const e={};if(d(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function UO(t,e){const n={},r=d(t,["systemInstruction"]);e!==void 0&&r!=null&&f(e,["systemInstruction"],dt(r));const i=d(t,["tools"]);if(e!==void 0&&i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>XS(l))),f(e,["tools"],s)}const o=d(t,["generationConfig"]);return e!==void 0&&o!=null&&f(e,["generationConfig"],_4(o)),n}function zO(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["contents"]);if(i!=null){let s=sn(i);Array.isArray(s)&&(s=s.map(l=>Ku(l))),f(n,["contents"],s)}const o=d(e,["config"]);return o!=null&&BO(o),n}function HO(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["contents"]);if(i!=null){let s=sn(i);Array.isArray(s)&&(s=s.map(l=>l)),f(n,["contents"],s)}const o=d(e,["config"]);return o!=null&&UO(o,n),n}function $O(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["totalTokens"]);r!=null&&f(e,["totalTokens"],r);const i=d(t,["cachedContentTokenCount"]);return i!=null&&f(e,["cachedContentTokenCount"],i),e}function GO(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["totalTokens"]);return r!=null&&f(e,["totalTokens"],r),e}function qO(t,e){const n={},r=d(e,["model"]);return r!=null&&f(n,["_url","name"],we(t,r)),n}function WO(t,e){const n={},r=d(e,["model"]);return r!=null&&f(n,["_url","name"],we(t,r)),n}function jO(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function JO(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function KO(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const i=d(t,["negativePrompt"]);e!==void 0&&i!=null&&f(e,["parameters","negativePrompt"],i);const o=d(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const s=d(t,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const l=d(t,["guidanceScale"]);e!==void 0&&l!=null&&f(e,["parameters","guidanceScale"],l);const a=d(t,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const u=d(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const c=d(t,["personGeneration"]);e!==void 0&&c!=null&&f(e,["parameters","personGeneration"],c);const p=d(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const m=d(t,["includeRaiReason"]);e!==void 0&&m!=null&&f(e,["parameters","includeRaiReason"],m);const g=d(t,["language"]);e!==void 0&&g!=null&&f(e,["parameters","language"],g);const y=d(t,["outputMimeType"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","mimeType"],y);const v=d(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&f(e,["parameters","outputOptions","compressionQuality"],v);const w=d(t,["addWatermark"]);e!==void 0&&w!=null&&f(e,["parameters","addWatermark"],w);const x=d(t,["labels"]);e!==void 0&&x!=null&&f(e,["labels"],x);const E=d(t,["editMode"]);e!==void 0&&E!=null&&f(e,["parameters","editMode"],E);const C=d(t,["baseSteps"]);return e!==void 0&&C!=null&&f(e,["parameters","editConfig","baseSteps"],C),n}function YO(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const o=d(e,["referenceImages"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>Q4(a))),f(n,["instances[0]","referenceImages"],l)}const s=d(e,["config"]);return s!=null&&KO(s,n),n}function XO(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Yu(o))),f(e,["generatedImages"],i)}return e}function QO(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&f(e,["requests[]","title"],i);const o=d(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&f(e,["requests[]","outputDimensionality"],o),d(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function ZO(t,e){const n={},r=d(t,["taskType"]);e!==void 0&&r!=null&&f(e,["instances[]","task_type"],r);const i=d(t,["title"]);e!==void 0&&i!=null&&f(e,["instances[]","title"],i);const o=d(t,["outputDimensionality"]);e!==void 0&&o!=null&&f(e,["parameters","outputDimensionality"],o);const s=d(t,["mimeType"]);e!==void 0&&s!=null&&f(e,["instances[]","mimeType"],s);const l=d(t,["autoTruncate"]);return e!==void 0&&l!=null&&f(e,["parameters","autoTruncate"],l),n}function e4(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["contents"]);if(i!=null){let l=Sh(t,i);Array.isArray(l)&&(l=l.map(a=>a)),f(n,["requests[]","content"],l)}const o=d(e,["config"]);o!=null&&QO(o,n);const s=d(e,["model"]);return s!==void 0&&f(n,["requests[]","model"],we(t,s)),n}function t4(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["contents"]);if(i!=null){let s=Sh(t,i);Array.isArray(s)&&(s=s.map(l=>l)),f(n,["instances[]","content"],s)}const o=d(e,["config"]);return o!=null&&ZO(o,n),n}function n4(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),f(e,["embeddings"],o)}const i=d(t,["metadata"]);return i!=null&&f(e,["metadata"],i),e}function r4(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>OO(s))),f(e,["embeddings"],o)}const i=d(t,["metadata"]);return i!=null&&f(e,["metadata"],i),e}function i4(t){const e={},n=d(t,["endpoint"]);n!=null&&f(e,["name"],n);const r=d(t,["deployedModelId"]);return r!=null&&f(e,["deployedModelId"],r),e}function o4(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function s4(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const i=d(t,["name"]);if(i!=null&&f(e,["name"],i),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function l4(t){const e={},n=d(t,["mode"]);n!=null&&f(e,["mode"],n);const r=d(t,["allowedFunctionNames"]);if(r!=null&&f(e,["allowedFunctionNames"],r),d(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function a4(t){const e={};if(d(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(t,["description"]);n!=null&&f(e,["description"],n);const r=d(t,["name"]);r!=null&&f(e,["name"],r);const i=d(t,["parameters"]);i!=null&&f(e,["parameters"],i);const o=d(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const s=d(t,["response"]);s!=null&&f(e,["response"],s);const l=d(t,["responseJsonSchema"]);return l!=null&&f(e,["responseJsonSchema"],l),e}function u4(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],Ku(dt(i)));const o=d(e,["temperature"]);o!=null&&f(r,["temperature"],o);const s=d(e,["topP"]);s!=null&&f(r,["topP"],s);const l=d(e,["topK"]);l!=null&&f(r,["topK"],l);const a=d(e,["candidateCount"]);a!=null&&f(r,["candidateCount"],a);const u=d(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const c=d(e,["stopSequences"]);c!=null&&f(r,["stopSequences"],c);const p=d(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=d(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const g=d(e,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const y=d(e,["frequencyPenalty"]);y!=null&&f(r,["frequencyPenalty"],y);const v=d(e,["seed"]);v!=null&&f(r,["seed"],v);const w=d(e,["responseMimeType"]);w!=null&&f(r,["responseMimeType"],w);const x=d(e,["responseSchema"]);x!=null&&f(r,["responseSchema"],Ch(x));const E=d(e,["responseJsonSchema"]);if(E!=null&&f(r,["responseJsonSchema"],E),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=d(e,["safetySettings"]);if(n!==void 0&&C!=null){let F=C;Array.isArray(F)&&(F=F.map(z=>Z4(z))),f(n,["safetySettings"],F)}const S=d(e,["tools"]);if(n!==void 0&&S!=null){let F=jo(S);Array.isArray(F)&&(F=F.map(z=>sF(Wo(z)))),f(n,["tools"],F)}const N=d(e,["toolConfig"]);if(n!==void 0&&N!=null&&f(n,["toolConfig"],oF(N)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const T=d(e,["cachedContent"]);n!==void 0&&T!=null&&f(n,["cachedContent"],ar(t,T));const k=d(e,["responseModalities"]);k!=null&&f(r,["responseModalities"],k);const I=d(e,["mediaResolution"]);I!=null&&f(r,["mediaResolution"],I);const R=d(e,["speechConfig"]);if(R!=null&&f(r,["speechConfig"],Eh(R)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const M=d(e,["thinkingConfig"]);M!=null&&f(r,["thinkingConfig"],M);const q=d(e,["imageConfig"]);q!=null&&f(r,["imageConfig"],O4(q));const $=d(e,["enableEnhancedCivicAnswers"]);return $!=null&&f(r,["enableEnhancedCivicAnswers"],$),r}function c4(t,e,n){const r={},i=d(e,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],dt(i));const o=d(e,["temperature"]);o!=null&&f(r,["temperature"],o);const s=d(e,["topP"]);s!=null&&f(r,["topP"],s);const l=d(e,["topK"]);l!=null&&f(r,["topK"],l);const a=d(e,["candidateCount"]);a!=null&&f(r,["candidateCount"],a);const u=d(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const c=d(e,["stopSequences"]);c!=null&&f(r,["stopSequences"],c);const p=d(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=d(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const g=d(e,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const y=d(e,["frequencyPenalty"]);y!=null&&f(r,["frequencyPenalty"],y);const v=d(e,["seed"]);v!=null&&f(r,["seed"],v);const w=d(e,["responseMimeType"]);w!=null&&f(r,["responseMimeType"],w);const x=d(e,["responseSchema"]);x!=null&&f(r,["responseSchema"],Ch(x));const E=d(e,["responseJsonSchema"]);E!=null&&f(r,["responseJsonSchema"],E);const C=d(e,["routingConfig"]);C!=null&&f(r,["routingConfig"],C);const S=d(e,["modelSelectionConfig"]);S!=null&&f(r,["modelConfig"],S);const N=d(e,["safetySettings"]);if(n!==void 0&&N!=null){let Y=N;Array.isArray(Y)&&(Y=Y.map(se=>se)),f(n,["safetySettings"],Y)}const T=d(e,["tools"]);if(n!==void 0&&T!=null){let Y=jo(T);Array.isArray(Y)&&(Y=Y.map(se=>XS(Wo(se)))),f(n,["tools"],Y)}const k=d(e,["toolConfig"]);n!==void 0&&k!=null&&f(n,["toolConfig"],k);const I=d(e,["labels"]);n!==void 0&&I!=null&&f(n,["labels"],I);const R=d(e,["cachedContent"]);n!==void 0&&R!=null&&f(n,["cachedContent"],ar(t,R));const M=d(e,["responseModalities"]);M!=null&&f(r,["responseModalities"],M);const q=d(e,["mediaResolution"]);q!=null&&f(r,["mediaResolution"],q);const $=d(e,["speechConfig"]);$!=null&&f(r,["speechConfig"],YS(Eh($)));const F=d(e,["audioTimestamp"]);F!=null&&f(r,["audioTimestamp"],F);const z=d(e,["thinkingConfig"]);z!=null&&f(r,["thinkingConfig"],z);const ie=d(e,["imageConfig"]);if(ie!=null&&f(r,["imageConfig"],F4(ie)),d(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return r}function F0(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["contents"]);if(i!=null){let s=sn(i);Array.isArray(s)&&(s=s.map(l=>Ku(l))),f(n,["contents"],s)}const o=d(e,["config"]);return o!=null&&f(n,["generationConfig"],u4(t,o,n)),n}function V0(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["contents"]);if(i!=null){let s=sn(i);Array.isArray(s)&&(s=s.map(l=>l)),f(n,["contents"],s)}const o=d(e,["config"]);return o!=null&&f(n,["generationConfig"],c4(t,o,n)),n}function B0(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>RO(u))),f(e,["candidates"],a)}const i=d(t,["modelVersion"]);i!=null&&f(e,["modelVersion"],i);const o=d(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const s=d(t,["responseId"]);s!=null&&f(e,["responseId"],s);const l=d(t,["usageMetadata"]);return l!=null&&f(e,["usageMetadata"],l),e}function U0(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),f(e,["candidates"],u)}const i=d(t,["createTime"]);i!=null&&f(e,["createTime"],i);const o=d(t,["modelVersion"]);o!=null&&f(e,["modelVersion"],o);const s=d(t,["promptFeedback"]);s!=null&&f(e,["promptFeedback"],s);const l=d(t,["responseId"]);l!=null&&f(e,["responseId"],l);const a=d(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function d4(t,e){const n={};if(d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=d(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const i=d(t,["aspectRatio"]);e!==void 0&&i!=null&&f(e,["parameters","aspectRatio"],i);const o=d(t,["guidanceScale"]);if(e!==void 0&&o!=null&&f(e,["parameters","guidanceScale"],o),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=d(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&f(e,["parameters","safetySetting"],s);const l=d(t,["personGeneration"]);e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l);const a=d(t,["includeSafetyAttributes"]);e!==void 0&&a!=null&&f(e,["parameters","includeSafetyAttributes"],a);const u=d(t,["includeRaiReason"]);e!==void 0&&u!=null&&f(e,["parameters","includeRaiReason"],u);const c=d(t,["language"]);e!==void 0&&c!=null&&f(e,["parameters","language"],c);const p=d(t,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const m=d(t,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&f(e,["parameters","outputOptions","compressionQuality"],m),d(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const g=d(t,["imageSize"]);if(e!==void 0&&g!=null&&f(e,["parameters","sampleImageSize"],g),d(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function f4(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const i=d(t,["negativePrompt"]);e!==void 0&&i!=null&&f(e,["parameters","negativePrompt"],i);const o=d(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const s=d(t,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const l=d(t,["guidanceScale"]);e!==void 0&&l!=null&&f(e,["parameters","guidanceScale"],l);const a=d(t,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const u=d(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const c=d(t,["personGeneration"]);e!==void 0&&c!=null&&f(e,["parameters","personGeneration"],c);const p=d(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const m=d(t,["includeRaiReason"]);e!==void 0&&m!=null&&f(e,["parameters","includeRaiReason"],m);const g=d(t,["language"]);e!==void 0&&g!=null&&f(e,["parameters","language"],g);const y=d(t,["outputMimeType"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","mimeType"],y);const v=d(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&f(e,["parameters","outputOptions","compressionQuality"],v);const w=d(t,["addWatermark"]);e!==void 0&&w!=null&&f(e,["parameters","addWatermark"],w);const x=d(t,["labels"]);e!==void 0&&x!=null&&f(e,["labels"],x);const E=d(t,["imageSize"]);e!==void 0&&E!=null&&f(e,["parameters","sampleImageSize"],E);const C=d(t,["enhancePrompt"]);return e!==void 0&&C!=null&&f(e,["parameters","enhancePrompt"],C),n}function p4(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const o=d(e,["config"]);return o!=null&&d4(o,n),n}function h4(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const o=d(e,["config"]);return o!=null&&f4(o,n),n}function m4(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>A4(s))),f(e,["generatedImages"],o)}const i=d(t,["positivePromptSafetyAttributes"]);return i!=null&&f(e,["positivePromptSafetyAttributes"],JS(i)),e}function g4(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Yu(s))),f(e,["generatedImages"],o)}const i=d(t,["positivePromptSafetyAttributes"]);return i!=null&&f(e,["positivePromptSafetyAttributes"],KS(i)),e}function y4(t,e){const n={},r=d(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r),d(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=d(t,["durationSeconds"]);if(e!==void 0&&i!=null&&f(e,["parameters","durationSeconds"],i),d(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=d(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const s=d(t,["resolution"]);e!==void 0&&s!=null&&f(e,["parameters","resolution"],s);const l=d(t,["personGeneration"]);if(e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l),d(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const a=d(t,["negativePrompt"]);e!==void 0&&a!=null&&f(e,["parameters","negativePrompt"],a);const u=d(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&f(e,["parameters","enhancePrompt"],u),d(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const c=d(t,["lastFrame"]);e!==void 0&&c!=null&&f(e,["instances[0]","lastFrame"],Xu(c));const p=d(t,["referenceImages"]);if(e!==void 0&&p!=null){let m=p;Array.isArray(m)&&(m=m.map(g=>xF(g))),f(e,["instances[0]","referenceImages"],m)}if(d(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function v4(t,e){const n={},r=d(t,["numberOfVideos"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const i=d(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const o=d(t,["fps"]);e!==void 0&&o!=null&&f(e,["parameters","fps"],o);const s=d(t,["durationSeconds"]);e!==void 0&&s!=null&&f(e,["parameters","durationSeconds"],s);const l=d(t,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const a=d(t,["aspectRatio"]);e!==void 0&&a!=null&&f(e,["parameters","aspectRatio"],a);const u=d(t,["resolution"]);e!==void 0&&u!=null&&f(e,["parameters","resolution"],u);const c=d(t,["personGeneration"]);e!==void 0&&c!=null&&f(e,["parameters","personGeneration"],c);const p=d(t,["pubsubTopic"]);e!==void 0&&p!=null&&f(e,["parameters","pubsubTopic"],p);const m=d(t,["negativePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","negativePrompt"],m);const g=d(t,["enhancePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","enhancePrompt"],g);const y=d(t,["generateAudio"]);e!==void 0&&y!=null&&f(e,["parameters","generateAudio"],y);const v=d(t,["lastFrame"]);e!==void 0&&v!=null&&f(e,["instances[0]","lastFrame"],Tn(v));const w=d(t,["referenceImages"]);if(e!==void 0&&w!=null){let C=w;Array.isArray(C)&&(C=C.map(S=>wF(S))),f(e,["instances[0]","referenceImages"],C)}const x=d(t,["mask"]);e!==void 0&&x!=null&&f(e,["instances[0]","mask"],vF(x));const E=d(t,["compressionQuality"]);return e!==void 0&&E!=null&&f(e,["parameters","compressionQuality"],E),n}function x4(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const o=d(t,["error"]);o!=null&&f(e,["error"],o);const s=d(t,["response","generateVideoResponse"]);return s!=null&&f(e,["response"],E4(s)),e}function w4(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const o=d(t,["error"]);o!=null&&f(e,["error"],o);const s=d(t,["response"]);return s!=null&&f(e,["response"],T4(s)),e}function S4(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const o=d(e,["image"]);o!=null&&f(n,["instances[0]","image"],Xu(o));const s=d(e,["video"]);s!=null&&f(n,["instances[0]","video"],QS(s));const l=d(e,["source"]);l!=null&&N4(l,n);const a=d(e,["config"]);return a!=null&&y4(a,n),n}function C4(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const o=d(e,["image"]);o!=null&&f(n,["instances[0]","image"],Tn(o));const s=d(e,["video"]);s!=null&&f(n,["instances[0]","video"],ZS(s));const l=d(e,["source"]);l!=null&&k4(l,n);const a=d(e,["config"]);return a!=null&&v4(a,n),n}function E4(t){const e={},n=d(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>M4(s))),f(e,["generatedVideos"],o)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function T4(t){const e={},n=d(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>b4(s))),f(e,["generatedVideos"],o)}const r=d(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=d(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function N4(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&f(e,["instances[0]","image"],Xu(i));const o=d(t,["video"]);return e!==void 0&&o!=null&&f(e,["instances[0]","video"],QS(o)),n}function k4(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&f(e,["instances[0]","image"],Tn(i));const o=d(t,["video"]);return e!==void 0&&o!=null&&f(e,["instances[0]","video"],ZS(o)),n}function A4(t){const e={},n=d(t,["_self"]);n!=null&&f(e,["image"],V4(n));const r=d(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const i=d(t,["_self"]);return i!=null&&f(e,["safetyAttributes"],JS(i)),e}function Yu(t){const e={},n=d(t,["_self"]);n!=null&&f(e,["image"],jS(n));const r=d(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const i=d(t,["_self"]);i!=null&&f(e,["safetyAttributes"],KS(i));const o=d(t,["prompt"]);return o!=null&&f(e,["enhancedPrompt"],o),e}function I4(t){const e={},n=d(t,["_self"]);n!=null&&f(e,["mask"],jS(n));const r=d(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),f(e,["labels"],i)}return e}function M4(t){const e={},n=d(t,["video"]);return n!=null&&f(e,["video"],gF(n)),e}function b4(t){const e={},n=d(t,["_self"]);return n!=null&&f(e,["video"],yF(n)),e}function _4(t){const e={},n=d(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=d(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const i=d(t,["audioTimestamp"]);i!=null&&f(e,["audioTimestamp"],i);const o=d(t,["candidateCount"]);o!=null&&f(e,["candidateCount"],o);const s=d(t,["enableAffectiveDialog"]);s!=null&&f(e,["enableAffectiveDialog"],s);const l=d(t,["frequencyPenalty"]);l!=null&&f(e,["frequencyPenalty"],l);const a=d(t,["logprobs"]);a!=null&&f(e,["logprobs"],a);const u=d(t,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const c=d(t,["mediaResolution"]);c!=null&&f(e,["mediaResolution"],c);const p=d(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=d(t,["responseLogprobs"]);m!=null&&f(e,["responseLogprobs"],m);const g=d(t,["responseMimeType"]);g!=null&&f(e,["responseMimeType"],g);const y=d(t,["responseModalities"]);y!=null&&f(e,["responseModalities"],y);const v=d(t,["responseSchema"]);v!=null&&f(e,["responseSchema"],v);const w=d(t,["routingConfig"]);w!=null&&f(e,["routingConfig"],w);const x=d(t,["seed"]);x!=null&&f(e,["seed"],x);const E=d(t,["speechConfig"]);E!=null&&f(e,["speechConfig"],YS(E));const C=d(t,["stopSequences"]);C!=null&&f(e,["stopSequences"],C);const S=d(t,["temperature"]);S!=null&&f(e,["temperature"],S);const N=d(t,["thinkingConfig"]);N!=null&&f(e,["thinkingConfig"],N);const T=d(t,["topK"]);T!=null&&f(e,["topK"],T);const k=d(t,["topP"]);if(k!=null&&f(e,["topP"],k),d(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function R4(t,e){const n={},r=d(e,["model"]);return r!=null&&f(n,["_url","name"],we(t,r)),n}function D4(t,e){const n={},r=d(e,["model"]);return r!=null&&f(n,["_url","name"],we(t,r)),n}function P4(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function L4(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function O4(t){const e={},n=d(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=d(t,["imageSize"]);if(r!=null&&f(e,["imageSize"],r),d(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function F4(t){const e={},n=d(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=d(t,["imageSize"]);r!=null&&f(e,["imageSize"],r);const i=d(t,["outputMimeType"]);i!=null&&f(e,["imageOutputOptions","mimeType"],i);const o=d(t,["outputCompressionQuality"]);return o!=null&&f(e,["imageOutputOptions","compressionQuality"],o),e}function V4(t){const e={},n=d(t,["bytesBase64Encoded"]);n!=null&&f(e,["imageBytes"],Xr(n));const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function jS(t){const e={},n=d(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&f(e,["imageBytes"],Xr(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Xu(t){const e={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=d(t,["imageBytes"]);n!=null&&f(e,["bytesBase64Encoded"],Xr(n));const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Tn(t){const e={},n=d(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=d(t,["imageBytes"]);r!=null&&f(e,["bytesBase64Encoded"],Xr(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function B4(t,e,n){const r={},i=d(e,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const o=d(e,["pageToken"]);n!==void 0&&o!=null&&f(n,["_query","pageToken"],o);const s=d(e,["filter"]);n!==void 0&&s!=null&&f(n,["_query","filter"],s);const l=d(e,["queryBase"]);return n!==void 0&&l!=null&&f(n,["_url","models_url"],BS(t,l)),r}function U4(t,e,n){const r={},i=d(e,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const o=d(e,["pageToken"]);n!==void 0&&o!=null&&f(n,["_query","pageToken"],o);const s=d(e,["filter"]);n!==void 0&&s!=null&&f(n,["_query","filter"],s);const l=d(e,["queryBase"]);return n!==void 0&&l!=null&&f(n,["_url","models_url"],BS(t,l)),r}function z4(t,e){const n={},r=d(e,["config"]);return r!=null&&B4(t,r,n),n}function H4(t,e){const n={},r=d(e,["config"]);return r!=null&&U4(t,r,n),n}function $4(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["_self"]);if(i!=null){let o=US(i);Array.isArray(o)&&(o=o.map(s=>If(s))),f(e,["models"],o)}return e}function G4(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["_self"]);if(i!=null){let o=US(i);Array.isArray(o)&&(o=o.map(s=>Mf(s))),f(e,["models"],o)}return e}function q4(t){const e={},n=d(t,["maskMode"]);n!=null&&f(e,["maskMode"],n);const r=d(t,["segmentationClasses"]);r!=null&&f(e,["maskClasses"],r);const i=d(t,["maskDilation"]);return i!=null&&f(e,["dilation"],i),e}function If(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["displayName"]);r!=null&&f(e,["displayName"],r);const i=d(t,["description"]);i!=null&&f(e,["description"],i);const o=d(t,["version"]);o!=null&&f(e,["version"],o);const s=d(t,["_self"]);s!=null&&f(e,["tunedModelInfo"],lF(s));const l=d(t,["inputTokenLimit"]);l!=null&&f(e,["inputTokenLimit"],l);const a=d(t,["outputTokenLimit"]);a!=null&&f(e,["outputTokenLimit"],a);const u=d(t,["supportedGenerationMethods"]);u!=null&&f(e,["supportedActions"],u);const c=d(t,["temperature"]);c!=null&&f(e,["temperature"],c);const p=d(t,["maxTemperature"]);p!=null&&f(e,["maxTemperature"],p);const m=d(t,["topP"]);m!=null&&f(e,["topP"],m);const g=d(t,["topK"]);g!=null&&f(e,["topK"],g);const y=d(t,["thinking"]);return y!=null&&f(e,["thinking"],y),e}function Mf(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["displayName"]);r!=null&&f(e,["displayName"],r);const i=d(t,["description"]);i!=null&&f(e,["description"],i);const o=d(t,["versionId"]);o!=null&&f(e,["version"],o);const s=d(t,["deployedModels"]);if(s!=null){let p=s;Array.isArray(p)&&(p=p.map(m=>i4(m))),f(e,["endpoints"],p)}const l=d(t,["labels"]);l!=null&&f(e,["labels"],l);const a=d(t,["_self"]);a!=null&&f(e,["tunedModelInfo"],aF(a));const u=d(t,["defaultCheckpointId"]);u!=null&&f(e,["defaultCheckpointId"],u);const c=d(t,["checkpoints"]);if(c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>m)),f(e,["checkpoints"],p)}return e}function W4(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const o=d(t,["fileData"]);o!=null&&f(e,["fileData"],o4(o));const s=d(t,["functionCall"]);s!=null&&f(e,["functionCall"],s4(s));const l=d(t,["functionResponse"]);l!=null&&f(e,["functionResponse"],l);const a=d(t,["inlineData"]);a!=null&&f(e,["inlineData"],_O(a));const u=d(t,["text"]);u!=null&&f(e,["text"],u);const c=d(t,["thought"]);c!=null&&f(e,["thought"],c);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function j4(t){const e={},n=d(t,["productImage"]);return n!=null&&f(e,["image"],Tn(n)),e}function J4(t,e){const n={},r=d(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const i=d(t,["baseSteps"]);e!==void 0&&i!=null&&f(e,["parameters","baseSteps"],i);const o=d(t,["outputGcsUri"]);e!==void 0&&o!=null&&f(e,["parameters","storageUri"],o);const s=d(t,["seed"]);e!==void 0&&s!=null&&f(e,["parameters","seed"],s);const l=d(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&f(e,["parameters","safetySetting"],l);const a=d(t,["personGeneration"]);e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a);const u=d(t,["addWatermark"]);e!==void 0&&u!=null&&f(e,["parameters","addWatermark"],u);const c=d(t,["outputMimeType"]);e!==void 0&&c!=null&&f(e,["parameters","outputOptions","mimeType"],c);const p=d(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","compressionQuality"],p);const m=d(t,["enhancePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","enhancePrompt"],m);const g=d(t,["labels"]);return e!==void 0&&g!=null&&f(e,["labels"],g),n}function K4(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["source"]);i!=null&&X4(i,n);const o=d(e,["config"]);return o!=null&&J4(o,n),n}function Y4(t){const e={},n=d(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Yu(i))),f(e,["generatedImages"],r)}return e}function X4(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=d(t,["personImage"]);e!==void 0&&i!=null&&f(e,["instances[0]","personImage","image"],Tn(i));const o=d(t,["productImages"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>j4(l))),f(e,["instances[0]","productImages"],s)}return n}function Q4(t){const e={},n=d(t,["referenceImage"]);n!=null&&f(e,["referenceImage"],Tn(n));const r=d(t,["referenceId"]);r!=null&&f(e,["referenceId"],r);const i=d(t,["referenceType"]);i!=null&&f(e,["referenceType"],i);const o=d(t,["maskImageConfig"]);o!=null&&f(e,["maskImageConfig"],q4(o));const s=d(t,["controlImageConfig"]);s!=null&&f(e,["controlImageConfig"],VO(s));const l=d(t,["styleImageConfig"]);l!=null&&f(e,["styleImageConfig"],l);const a=d(t,["subjectImageConfig"]);return a!=null&&f(e,["subjectImageConfig"],a),e}function JS(t){const e={},n=d(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=d(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const i=d(t,["contentType"]);return i!=null&&f(e,["contentType"],i),e}function KS(t){const e={},n=d(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=d(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const i=d(t,["contentType"]);return i!=null&&f(e,["contentType"],i),e}function Z4(t){const e={},n=d(t,["category"]);if(n!=null&&f(e,["category"],n),d(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function eF(t){const e={},n=d(t,["image"]);return n!=null&&f(e,["image"],Tn(n)),e}function tF(t,e){const n={},r=d(t,["mode"]);e!==void 0&&r!=null&&f(e,["parameters","mode"],r);const i=d(t,["maxPredictions"]);e!==void 0&&i!=null&&f(e,["parameters","maxPredictions"],i);const o=d(t,["confidenceThreshold"]);e!==void 0&&o!=null&&f(e,["parameters","confidenceThreshold"],o);const s=d(t,["maskDilation"]);e!==void 0&&s!=null&&f(e,["parameters","maskDilation"],s);const l=d(t,["binaryColorThreshold"]);e!==void 0&&l!=null&&f(e,["parameters","binaryColorThreshold"],l);const a=d(t,["labels"]);return e!==void 0&&a!=null&&f(e,["labels"],a),n}function nF(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["source"]);i!=null&&iF(i,n);const o=d(e,["config"]);return o!=null&&tF(o,n),n}function rF(t){const e={},n=d(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>I4(i))),f(e,["generatedMasks"],r)}return e}function iF(t,e){const n={},r=d(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=d(t,["image"]);e!==void 0&&i!=null&&f(e,["instances[0]","image"],Tn(i));const o=d(t,["scribbleImage"]);return e!==void 0&&o!=null&&f(e,["instances[0]","scribble"],eF(o)),n}function YS(t){const e={},n=d(t,["voiceConfig"]);n!=null&&f(e,["voiceConfig"],n);const r=d(t,["languageCode"]);if(r!=null&&f(e,["languageCode"],r),d(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function oF(t){const e={},n=d(t,["functionCallingConfig"]);n!=null&&f(e,["functionCallingConfig"],l4(n));const r=d(t,["retrievalConfig"]);return r!=null&&f(e,["retrievalConfig"],r),e}function sF(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(p=>p)),f(e,["functionDeclarations"],c)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=d(t,["computerUse"]);i!=null&&f(e,["computerUse"],i);const o=d(t,["fileSearch"]);o!=null&&f(e,["fileSearch"],o);const s=d(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=d(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],P4(l));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],L4(a));const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function XS(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>a4(m))),f(e,["functionDeclarations"],p)}const r=d(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const i=d(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const o=d(t,["computerUse"]);if(o!=null&&f(e,["computerUse"],o),d(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=d(t,["codeExecution"]);s!=null&&f(e,["codeExecution"],s);const l=d(t,["enterpriseWebSearch"]);l!=null&&f(e,["enterpriseWebSearch"],l);const a=d(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const u=d(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const c=d(t,["urlContext"]);return c!=null&&f(e,["urlContext"],c),e}function lF(t){const e={},n=d(t,["baseModel"]);n!=null&&f(e,["baseModel"],n);const r=d(t,["createTime"]);r!=null&&f(e,["createTime"],r);const i=d(t,["updateTime"]);return i!=null&&f(e,["updateTime"],i),e}function aF(t){const e={},n=d(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&f(e,["baseModel"],n);const r=d(t,["createTime"]);r!=null&&f(e,["createTime"],r);const i=d(t,["updateTime"]);return i!=null&&f(e,["updateTime"],i),e}function uF(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const i=d(t,["description"]);e!==void 0&&i!=null&&f(e,["description"],i);const o=d(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&f(e,["defaultCheckpointId"],o),n}function cF(t,e){const n={},r=d(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const i=d(t,["description"]);e!==void 0&&i!=null&&f(e,["description"],i);const o=d(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&f(e,["defaultCheckpointId"],o),n}function dF(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","name"],we(t,r));const i=d(e,["config"]);return i!=null&&uF(i,n),n}function fF(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["config"]);return i!=null&&cF(i,n),n}function pF(t,e){const n={},r=d(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const i=d(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&f(e,["parameters","safetySetting"],i);const o=d(t,["personGeneration"]);e!==void 0&&o!=null&&f(e,["parameters","personGeneration"],o);const s=d(t,["includeRaiReason"]);e!==void 0&&s!=null&&f(e,["parameters","includeRaiReason"],s);const l=d(t,["outputMimeType"]);e!==void 0&&l!=null&&f(e,["parameters","outputOptions","mimeType"],l);const a=d(t,["outputCompressionQuality"]);e!==void 0&&a!=null&&f(e,["parameters","outputOptions","compressionQuality"],a);const u=d(t,["enhanceInputImage"]);e!==void 0&&u!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],u);const c=d(t,["imagePreservationFactor"]);e!==void 0&&c!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const p=d(t,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const m=d(t,["numberOfImages"]);e!==void 0&&m!=null&&f(e,["parameters","sampleCount"],m);const g=d(t,["mode"]);return e!==void 0&&g!=null&&f(e,["parameters","mode"],g),n}function hF(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const i=d(e,["image"]);i!=null&&f(n,["instances[0]","image"],Tn(i));const o=d(e,["upscaleFactor"]);o!=null&&f(n,["parameters","upscaleConfig","upscaleFactor"],o);const s=d(e,["config"]);return s!=null&&pF(s,n),n}function mF(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Yu(o))),f(e,["generatedImages"],i)}return e}function gF(t){const e={},n=d(t,["uri"]);n!=null&&f(e,["uri"],n);const r=d(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],Xr(r));const i=d(t,["encoding"]);return i!=null&&f(e,["mimeType"],i),e}function yF(t){const e={},n=d(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=d(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],Xr(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function vF(t){const e={},n=d(t,["image"]);n!=null&&f(e,["_self"],Tn(n));const r=d(t,["maskMode"]);return r!=null&&f(e,["maskMode"],r),e}function xF(t){const e={},n=d(t,["image"]);n!=null&&f(e,["image"],Xu(n));const r=d(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function wF(t){const e={},n=d(t,["image"]);n!=null&&f(e,["image"],Tn(n));const r=d(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function QS(t){const e={},n=d(t,["uri"]);n!=null&&f(e,["uri"],n);const r=d(t,["videoBytes"]);r!=null&&f(e,["encodedVideo"],Xr(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["encoding"],i),e}function ZS(t){const e={},n=d(t,["uri"]);n!=null&&f(e,["gcsUri"],n);const r=d(t,["videoBytes"]);r!=null&&f(e,["bytesBase64Encoded"],Xr(r));const i=d(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SF(t,e){const n={},r=d(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["displayName"],r),n}function CF(t){const e={},n=d(t,["config"]);return n!=null&&SF(n,e),e}function EF(t,e){const n={},r=d(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function TF(t){const e={},n=d(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=d(t,["config"]);return r!=null&&EF(r,e),e}function NF(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function kF(t,e){const n={},r=d(t,["customMetadata"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),f(e,["customMetadata"],o)}const i=d(t,["chunkingConfig"]);return e!==void 0&&i!=null&&f(e,["chunkingConfig"],i),n}function AF(t){const e={},n=d(t,["name"]);n!=null&&f(e,["name"],n);const r=d(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=d(t,["done"]);i!=null&&f(e,["done"],i);const o=d(t,["error"]);o!=null&&f(e,["error"],o);const s=d(t,["response"]);return s!=null&&f(e,["response"],MF(s)),e}function IF(t){const e={},n=d(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=d(t,["fileName"]);r!=null&&f(e,["fileName"],r);const i=d(t,["config"]);return i!=null&&kF(i,e),e}function MF(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["parent"]);r!=null&&f(e,["parent"],r);const i=d(t,["documentName"]);return i!=null&&f(e,["documentName"],i),e}function bF(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function _F(t){const e={},n=d(t,["config"]);return n!=null&&bF(n,e),e}function RF(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["fileSearchStores"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),f(e,["fileSearchStores"],o)}return e}function eC(t,e){const n={},r=d(t,["mimeType"]);e!==void 0&&r!=null&&f(e,["mimeType"],r);const i=d(t,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const o=d(t,["customMetadata"]);if(e!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>a)),f(e,["customMetadata"],l)}const s=d(t,["chunkingConfig"]);return e!==void 0&&s!=null&&f(e,["chunkingConfig"],s),n}function DF(t){const e={},n=d(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=d(t,["config"]);return r!=null&&eC(r,e),e}function PF(t){const e={},n=d(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const LF="Content-Type",OF="X-Server-Timeout",FF="User-Agent",bf="x-goog-api-client",VF="1.32.0",BF=`google-genai-sdk/${VF}`,UF="v1beta1",zF="v1beta";class HF{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:UF,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:zF,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[s,l]of Object.entries(e.queryParams))i.searchParams.append(s,String(l));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,i.toString(),e.abortSignal),this.unaryApiCall(i,o,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,o]of Object.entries(n))typeof o=="object"?r[i]=Object.assign(Object.assign({},r[i]),o):o!==void 0&&(r[i]=o);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,i.toString(),e.abortSignal),this.streamApiCall(i,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,i){if(n&&n.timeout||i){const o=new AbortController,s=o.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const l=setTimeout(()=>o.abort(),n.timeout);l&&typeof l.unref=="function"&&l.unref()}i&&i.addEventListener("abort",()=>{o.abort()}),e.signal=s}return n&&n.extraBody!==null&&$F(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await z0(i),new Nf(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await z0(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return Eo(this,arguments,function*(){var r;const i=(r=e==null?void 0:e.body)===null||r===void 0?void 0:r.getReader(),o=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let s="";const l="data:",a=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:u,value:c}=yield Ie(i.read());if(u){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=o.decode(c,{stream:!0});try{const y=JSON.parse(p);if("error"in y){const v=JSON.parse(JSON.stringify(y.error)),w=v.status,x=v.code,E=`got status: ${w}. ${JSON.stringify(y)}`;if(x>=400&&x<600)throw new Ju({message:E,status:x})}}catch(y){if(y.name==="ApiError")throw y}s+=p;let m=-1,g=0;for(;;){m=-1,g=0;for(const w of a){const x=s.indexOf(w);x!==-1&&(m===-1||x<m)&&(m=x,g=w.length)}if(m===-1)break;const y=s.substring(0,m);s=s.substring(m+g);const v=y.trim();if(v.startsWith(l)){const w=v.substring(l.length).trim();try{const x=new Response(w,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Ie(new Nf(x))}catch(x){throw new Error(`exception parsing stream chunk ${w}. ${x}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=BF+" "+this.clientOptions.userAgentExtra;return e[FF]=n,e[bf]=n,e[LF]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[i,o]of Object.entries(e.headers))r.append(i,o);e.timeout&&e.timeout>0&&r.append(OF,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const o=this.clientOptions.uploader,s=await o.stat(e);i.sizeBytes=String(s.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:s.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=l;const a={file:i},u=this.getFileName(e),c=G("upload/v1beta/files",a._url),p=await this.fetchUploadUrl(c,i.sizeBytes,i.mimeType,u,a,n==null?void 0:n.httpOptions);return o.upload(e,p,this)}async uploadFileToFileSearchStore(e,n,r){var i;const o=this.clientOptions.uploader,s=await o.stat(n),l=String(s.size),a=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:s.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${e}:uploadToFileSearchStore`,c=this.getFileName(n),p={};r!=null&&eC(r,p);const m=await this.fetchUploadUrl(u,l,a,c,p,r==null?void 0:r.httpOptions);return o.uploadToFileSearchStore(n,m,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,i,o,s){var l;let a={};s?a=s:a={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const u=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(l=u==null?void 0:u.headers)===null||l===void 0?void 0:l["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function z0(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Ju({message:i,status:n}):new Error(i)}}function $F(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const o=JSON.parse(t.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(o,s){const l=Object.assign({},o);for(const a in s)if(Object.prototype.hasOwnProperty.call(s,a)){const u=s[a],c=l[a];u&&typeof u=="object"&&!Array.isArray(u)&&c&&typeof c=="object"&&!Array.isArray(c)?l[a]=r(c,u):(c&&u&&typeof c!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${a}". Original type: ${typeof c}, New type: ${typeof u}. Overwriting.`),l[a]=u)}return l}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GF="mcp_used/unknown";let qF=!1;function tC(t){for(const e of t)if(WF(e)||typeof e=="object"&&"inputSchema"in e)return!0;return qF}function nC(t){var e;const n=(e=t[bf])!==null&&e!==void 0?e:"";t[bf]=(n+` ${GF}`).trimStart()}function WF(t){return t!==null&&typeof t=="object"&&t instanceof Nh}function jF(t){return Eo(this,arguments,function*(n,r=100){let i,o=0;for(;o<r;){const s=yield Ie(n.listTools({cursor:i}));for(const l of s.tools)yield yield Ie(l),o++;if(!s.nextCursor)break;i=s.nextCursor}})}class Nh{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Nh(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const o={},s=[];for(const c of this.mcpClients)try{for(var l=!0,a=(n=void 0,Rs(jF(c))),u;u=await a.next(),e=u.done,!e;l=!0){i=u.value,l=!1;const p=i;s.push(p);const m=p.name;if(o[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);o[m]=c}}catch(p){n={error:p}}finally{try{!l&&!e&&(r=a.return)&&await r.call(a)}finally{if(n)throw n.error}}this.mcpTools=s,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),N2(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const s=await i.callTool({name:r.name,arguments:r.args},void 0,o);n.push({functionResponse:{name:r.name,response:s.isError?{error:s}:s}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function JF(t,e,n){const r=new y2;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class KF{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),s=QF(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),a=`${i}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${l}`;let u=()=>{};const c=new Promise(C=>{u=C}),p=e.callbacks,m=function(){u({})},g=this.apiClient,y={onopen:m,onmessage:C=>{JF(g,p.onmessage,C)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(C){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(C){}},v=this.webSocketFactory.create(a,XF(s),y);v.connect(),await c;const E={setup:{model:we(this.apiClient,e.model)}};return v.send(JSON.stringify(E)),new YF(v,this.apiClient)}}class YF{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=CO(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=SO(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(co.PLAY)}pause(){this.sendPlaybackControl(co.PAUSE)}stop(){this.sendPlaybackControl(co.STOP)}resetContext(){this.sendPlaybackControl(co.RESET_CONTEXT)}close(){this.conn.close()}}function XF(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function QF(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ZF="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function e5(t,e,n){const r=new g2;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const o=JSON.parse(i);if(t.isVertexAI()){const s=NO(o);Object.assign(r,s)}else Object.assign(r,o);e(r)}class t5{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new KF(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,o,s,l;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const a=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let c;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&tC(e.config.tools)&&nC(p);const m=o5(p);if(this.apiClient.isVertexAI())c=`${a}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m,c);else{const R=this.apiClient.getApiKey();let M="BidiGenerateContent",q="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),M="BidiGenerateContentConstrained",q="access_token"),c=`${a}/ws/google.ai.generativelanguage.${u}.GenerativeService.${M}?${q}=${R}`}let g=()=>{};const y=new Promise(R=>{g=R}),v=e.callbacks,w=function(){var R;(R=v==null?void 0:v.onopen)===null||R===void 0||R.call(v),g({})},x=this.apiClient,E={onopen:w,onmessage:R=>{e5(x,v.onmessage,R)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(R){},onclose:(r=v==null?void 0:v.onclose)!==null&&r!==void 0?r:function(R){}},C=this.webSocketFactory.create(c,i5(m),E);C.connect(),await y;let S=we(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&S.startsWith("publishers/")){const R=this.apiClient.getProject(),M=this.apiClient.getLocation();S=`projects/${R}/locations/${M}/`+S}let N={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[au.AUDIO]}:e.config.responseModalities=[au.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const T=(l=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&l!==void 0?l:[],k=[];for(const R of T)if(this.isCallableTool(R)){const M=R;k.push(await M.tool())}else k.push(R);k.length>0&&(e.config.tools=k);const I={model:S,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?N=wO(this.apiClient,I):N=xO(this.apiClient,I),delete N.config,C.send(JSON.stringify(N)),new r5(C,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const n5={turnComplete:!0};class r5{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=sn(n.turns),e.isVertexAI()||(r=r.map(i=>Ku(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(ZF)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},n5),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:TO(e)}:n={realtimeInput:EO(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function i5(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function o5(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const H0=10;function $0(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const s of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(To(s)){i=!0;break}if(!i)return!0;const o=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function To(t){return"callTool"in t&&typeof t.callTool=="function"}function s5(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>To(i)))!==null&&r!==void 0?r:!1}function G0(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,i)=>{if(To(r))return;const o=r;o.functionDeclarations&&o.functionDeclarations.length>0&&n.push(i)}),n}function q0(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class l5 extends lr{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,o,s,l;const a=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!s5(n)||$0(n.config))return await this.generateContentInternal(a);const u=G0(n);if(u.length>0){const v=u.map(w=>`tools[${w}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${v}.`)}let c,p;const m=sn(a.contents),g=(o=(i=(r=a.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:H0;let y=0;for(;y<g&&(c=await this.generateContentInternal(a),!(!c.functionCalls||c.functionCalls.length===0));){const v=c.candidates[0].content,w=[];for(const x of(l=(s=n.config)===null||s===void 0?void 0:s.tools)!==null&&l!==void 0?l:[])if(To(x)){const C=await x.callTool(c.functionCalls);w.push(...C)}y++,p={role:"user",parts:w},a.contents=sn(a.contents),a.contents.push(v),a.contents.push(p),q0(a.config)&&(m.push(v),m.push(p))}return q0(a.config)&&(c.automaticFunctionCallingHistory=m),c},this.generateContentStream=async n=>{var r,i,o,s,l;if(this.maybeMoveToResponseJsonSchem(n),$0(n.config)){const p=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(p)}const a=G0(n);if(a.length>0){const p=a.map(m=>`tools[${m}]`).join(", ");throw new Error(`Incompatible tools found at ${p}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const u=(o=(i=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,c=(l=(s=n==null?void 0:n.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||l===void 0?void 0:l.disable;if(u&&!c)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let o;const s=[];if(r!=null&&r.generatedImages)for(const a of r.generatedImages)a&&(a!=null&&a.safetyAttributes)&&((i=a==null?void 0:a.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?o=a==null?void 0:a.safetyAttributes:s.push(a);let l;return o?l={generatedImages:s,positivePromptSafetyAttributes:o,sdkHttpResponse:r.sdkHttpResponse}:l={generatedImages:s,sdkHttpResponse:r.sdkHttpResponse},l}),this.list=async n=>{var r;const s={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((r=s.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new Fi(or.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(s),s)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,o,s,l,a;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((s=(o=n.source)===null||o===void 0?void 0:o.video)===null||s===void 0)&&s.uri&&(!((a=(l=n.source)===null||l===void 0?void 0:l.video)===null||a===void 0)&&a.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const o=(n=e.config)===null||n===void 0?void 0:n.tools;if(!o)return e;const s=await Promise.all(o.map(async a=>To(a)?await a.tool():a)),l={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(l.config.tools=s,e.config&&e.config.tools&&tC(e.config.tools)){const a=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},a);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),nC(u),l.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return l}async initAfcToolsMap(e){var n,r,i;const o=new Map;for(const s of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(To(s)){const l=s,a=await l.tool();for(const u of(i=a.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(o.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);o.set(u.name,l)}}return o}async processAfcStream(e){var n,r,i;const o=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:H0;let s=!1,l=0;const a=await this.initAfcToolsMap(e);return function(u,c,p){return Eo(this,arguments,function*(){for(var m,g,y,v,w,x;l<o;){s&&(l++,s=!1);const N=yield Ie(u.processParamsMaybeAddMcpUsage(p)),T=yield Ie(u.generateContentStreamInternal(N)),k=[],I=[];try{for(var E=!0,C=(g=void 0,Rs(T)),S;S=yield Ie(C.next()),m=S.done,!m;E=!0){v=S.value,E=!1;const R=v;if(yield yield Ie(R),R.candidates&&(!((w=R.candidates[0])===null||w===void 0)&&w.content)){I.push(R.candidates[0].content);for(const M of(x=R.candidates[0].content.parts)!==null&&x!==void 0?x:[])if(l<o&&M.functionCall){if(!M.functionCall.name)throw new Error("Function call name was not returned by the model.");if(c.has(M.functionCall.name)){const q=yield Ie(c.get(M.functionCall.name).callTool([M.functionCall]));k.push(...q)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${c.keys()}, mising tool: ${M.functionCall.name}`)}}}}catch(R){g={error:R}}finally{try{!E&&!m&&(y=C.return)&&(yield Ie(y.call(C)))}finally{if(g)throw g.error}}if(k.length>0){s=!0;const R=new ls;R.candidates=[{content:{role:"user",parts:k}}],yield yield Ie(R);const M=[];M.push(...I),M.push({role:"user",parts:k});const q=sn(p.contents).concat(M);p.contents=q}else break}})}(this,a,e)}async generateContentInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=V0(this.apiClient,e);return l=G("{model}:generateContent",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=U0(c),m=new ls;return Object.assign(m,p),m})}else{const u=F0(this.apiClient,e);return l=G("{model}:generateContent",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=B0(c),m=new ls;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=V0(this.apiClient,e);return l=G("{model}:streamGenerateContent?alt=sse",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.requestStream({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),s.then(function(p){return Eo(this,arguments,function*(){var m,g,y,v;try{for(var w=!0,x=Rs(p),E;E=yield Ie(x.next()),m=E.done,!m;w=!0){v=E.value,w=!1;const C=v,S=U0(yield Ie(C.json()));S.sdkHttpResponse={headers:C.headers};const N=new ls;Object.assign(N,S),yield yield Ie(N)}}catch(C){g={error:C}}finally{try{!w&&!m&&(y=x.return)&&(yield Ie(y.call(x)))}finally{if(g)throw g.error}}})})}else{const u=F0(this.apiClient,e);return l=G("{model}:streamGenerateContent?alt=sse",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.requestStream({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),s.then(function(p){return Eo(this,arguments,function*(){var m,g,y,v;try{for(var w=!0,x=Rs(p),E;E=yield Ie(x.next()),m=E.done,!m;w=!0){v=E.value,w=!1;const C=v,S=B0(yield Ie(C.json()));S.sdkHttpResponse={headers:C.headers};const N=new ls;Object.assign(N,S),yield yield Ie(N)}}catch(C){g={error:C}}finally{try{!w&&!m&&(y=x.return)&&(yield Ie(y.call(x)))}finally{if(g)throw g.error}}})})}}async embedContent(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=t4(this.apiClient,e);return l=G("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=r4(c),m=new w0;return Object.assign(m,p),m})}else{const u=e4(this.apiClient,e);return l=G("{model}:batchEmbedContents",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=n4(c),m=new w0;return Object.assign(m,p),m})}}async generateImagesInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=h4(this.apiClient,e);return l=G("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=g4(c),m=new S0;return Object.assign(m,p),m})}else{const u=p4(this.apiClient,e);return l=G("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=m4(c),m=new S0;return Object.assign(m,p),m})}}async editImageInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=YO(this.apiClient,e);return o=G("{model}:predict",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:a.headers},c})),i.then(a=>{const u=XO(a),c=new o2;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=hF(this.apiClient,e);return o=G("{model}:predict",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:a.headers},c})),i.then(a=>{const u=mF(a),c=new s2;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=K4(this.apiClient,e);return o=G("{model}:predict",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>{const u=Y4(a),c=new l2;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=nF(this.apiClient,e);return o=G("{model}:predict",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>{const u=rF(a),c=new a2;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=D4(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>Mf(c))}else{const u=R4(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>If(c))}}async listInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=H4(this.apiClient,e);return l=G("{models_url}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=G4(c),m=new C0;return Object.assign(m,p),m})}else{const u=z4(this.apiClient,e);return l=G("{models_url}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=$4(c),m=new C0;return Object.assign(m,p),m})}}async update(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=fF(this.apiClient,e);return l=G("{model}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>Mf(c))}else{const u=dF(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>If(c))}}async delete(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=WO(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=JO(c),m=new E0;return Object.assign(m,p),m})}else{const u=qO(this.apiClient,e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=jO(c),m=new E0;return Object.assign(m,p),m})}}async countTokens(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=HO(this.apiClient,e);return l=G("{model}:countTokens",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=GO(c),m=new T0;return Object.assign(m,p),m})}else{const u=zO(this.apiClient,e);return l=G("{model}:countTokens",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=$O(c),m=new T0;return Object.assign(m,p),m})}}async computeTokens(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=PO(this.apiClient,e);return o=G("{model}:computeTokens",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:a.headers},c})),i.then(a=>{const u=LO(a),c=new u2;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=C4(this.apiClient,e);return l=G("{model}:predictLongRunning",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const p=w4(c),m=new uu;return Object.assign(m,p),m})}else{const u=S4(this.apiClient,e);return l=G("{model}:predictLongRunning",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const p=x4(c),m=new uu;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class a5 extends lr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=ZP(e);return l=G("{operationName}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s}else{const u=QP(e);return l=G("{operationName}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s}}async fetchPredictVideosOperationInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=qP(e);return o=G("{resourceName}:fetchPredictOperation",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function u5(t){const e={},n=d(t,["data"]);if(n!=null&&f(e,["data"],n),d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function c5(t){const e={},n=d(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>x5(o))),f(e,["parts"],i)}const r=d(t,["role"]);return r!=null&&f(e,["role"],r),e}function d5(t,e,n){const r={},i=d(e,["expireTime"]);n!==void 0&&i!=null&&f(n,["expireTime"],i);const o=d(e,["newSessionExpireTime"]);n!==void 0&&o!=null&&f(n,["newSessionExpireTime"],o);const s=d(e,["uses"]);n!==void 0&&s!=null&&f(n,["uses"],s);const l=d(e,["liveConnectConstraints"]);n!==void 0&&l!=null&&f(n,["bidiGenerateContentSetup"],v5(t,l));const a=d(e,["lockAdditionalFields"]);return n!==void 0&&a!=null&&f(n,["fieldMask"],a),r}function f5(t,e){const n={},r=d(e,["config"]);return r!=null&&f(n,["config"],d5(t,r,n)),n}function p5(t){const e={};if(d(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=d(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function h5(t){const e={},n=d(t,["id"]);n!=null&&f(e,["id"],n);const r=d(t,["args"]);r!=null&&f(e,["args"],r);const i=d(t,["name"]);if(i!=null&&f(e,["name"],i),d(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function m5(t){const e={};if(d(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function g5(t){const e={};if(d(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function y5(t,e){const n={},r=d(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const i=d(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const o=d(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const s=d(t,["topP"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","topP"],s);const l=d(t,["topK"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","topK"],l);const a=d(t,["maxOutputTokens"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","maxOutputTokens"],a);const u=d(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const c=d(t,["seed"]);e!==void 0&&c!=null&&f(e,["setup","generationConfig","seed"],c);const p=d(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],Th(p));const m=d(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=d(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=d(t,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],c5(dt(y)));const v=d(t,["tools"]);if(e!==void 0&&v!=null){let T=jo(v);Array.isArray(T)&&(T=T.map(k=>S5(Wo(k)))),f(e,["setup","tools"],T)}const w=d(t,["sessionResumption"]);e!==void 0&&w!=null&&f(e,["setup","sessionResumption"],w5(w));const x=d(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","inputAudioTranscription"],x);const E=d(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&f(e,["setup","outputAudioTranscription"],E);const C=d(t,["realtimeInputConfig"]);e!==void 0&&C!=null&&f(e,["setup","realtimeInputConfig"],C);const S=d(t,["contextWindowCompression"]);e!==void 0&&S!=null&&f(e,["setup","contextWindowCompression"],S);const N=d(t,["proactivity"]);return e!==void 0&&N!=null&&f(e,["setup","proactivity"],N),n}function v5(t,e){const n={},r=d(e,["model"]);r!=null&&f(n,["setup","model"],we(t,r));const i=d(e,["config"]);return i!=null&&f(n,["config"],y5(i,n)),n}function x5(t){const e={},n=d(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=d(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=d(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const o=d(t,["fileData"]);o!=null&&f(e,["fileData"],p5(o));const s=d(t,["functionCall"]);s!=null&&f(e,["functionCall"],h5(s));const l=d(t,["functionResponse"]);l!=null&&f(e,["functionResponse"],l);const a=d(t,["inlineData"]);a!=null&&f(e,["inlineData"],u5(a));const u=d(t,["text"]);u!=null&&f(e,["text"],u);const c=d(t,["thought"]);c!=null&&f(e,["thought"],c);const p=d(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=d(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function w5(t){const e={},n=d(t,["handle"]);if(n!=null&&f(e,["handle"],n),d(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function S5(t){const e={},n=d(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(p=>p)),f(e,["functionDeclarations"],c)}if(d(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=d(t,["computerUse"]);i!=null&&f(e,["computerUse"],i);const o=d(t,["fileSearch"]);o!=null&&f(e,["fileSearch"],o);const s=d(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),d(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=d(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],m5(l));const a=d(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],g5(a));const u=d(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function C5(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(o=>`${n}.${o}`);e.push(...i)}else e.push(n)}return e.join(",")}function E5(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const o=r.setup;typeof o=="object"&&o!==null?(t.bidiGenerateContentSetup=o,n=o):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const o=C5(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?t.fieldMask=o:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let l=[];i.length>0&&(l=i.map(u=>s.includes(u)?`generationConfig.${u}`:u));const a=[];o&&a.push(o),l.length>0&&a.push(...l),a.length>0?t.fieldMask=a.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class T5 extends lr{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const l=f5(this.apiClient,e);o=G("auth_tokens",l._url),s=l._query,delete l.config,delete l._url,delete l._query;const a=E5(l,e.config);return i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N5(t,e){const n={},r=d(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function k5(t){const e={},n=d(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=d(t,["config"]);return r!=null&&N5(r,e),e}function A5(t){const e={},n=d(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function I5(t,e){const n={},r=d(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=d(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function M5(t){const e={},n=d(t,["parent"]);n!=null&&f(e,["_url","parent"],n);const r=d(t,["config"]);return r!=null&&I5(r,e),e}function b5(t){const e={},n=d(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=d(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=d(t,["documents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),f(e,["documents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _5 extends lr{constructor(e){super(),this.apiClient=e,this.list=async n=>new Fi(or.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=A5(e);return o=G("{name}",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>a)}}async delete(e){var n,r;let i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=k5(e);i=G("{name}",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=M5(e);return o=G("{parent}/documents",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>{const u=b5(a),c=new c2;return Object.assign(c,u),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class R5 extends lr{constructor(e,n=new _5(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new Fi(or.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=CF(e);return o=G("fileSearchStores",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>a)}}async get(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=NF(e);return o=G("{name}",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>a)}}async delete(e){var n,r;let i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=TF(e);i=G("{name}",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=_F(e);return o=G("fileSearchStores",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>{const u=RF(a),c=new d2;return Object.assign(c,u),c})}}async uploadToFileSearchStoreInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=DF(e);return o=G("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>{const u=PF(a),c=new f2;return Object.assign(c,u),c})}}async importFile(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=IF(e);return o=G("{file_search_store_name}:importFile",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json()),i.then(a=>{const u=AF(a),c=new xh;return Object.assign(c,u),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function D5(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function P5(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function L5(t,e){const n={},r=d(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function O5(t,e){const n={},r=d(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function F5(t,e,n){const r={};if(d(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=d(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&f(e,["displayName"],i),d(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=d(t,["epochCount"]);e!==void 0&&o!=null&&f(e,["tuningTask","hyperparameters","epochCount"],o);const s=d(t,["learningRateMultiplier"]);if(s!=null&&f(r,["tuningTask","hyperparameters","learningRateMultiplier"],s),d(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=d(t,["batchSize"]);e!==void 0&&l!=null&&f(e,["tuningTask","hyperparameters","batchSize"],l);const a=d(t,["learningRate"]);if(e!==void 0&&a!=null&&f(e,["tuningTask","hyperparameters","learningRate"],a),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function V5(t,e,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const g=d(t,["validationDataset"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec"],W0(g))}else if(i==="PREFERENCE_TUNING"){const g=d(t,["validationDataset"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec"],W0(g))}const o=d(t,["tunedModelDisplayName"]);e!==void 0&&o!=null&&f(e,["tunedModelDisplayName"],o);const s=d(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);let l=d(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const g=d(t,["epochCount"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],g)}else if(l==="PREFERENCE_TUNING"){const g=d(t,["epochCount"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],g)}let a=d(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const g=d(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g)}else if(a==="PREFERENCE_TUNING"){const g=d(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],g)}let u=d(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const g=d(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g)}else if(u==="PREFERENCE_TUNING"){const g=d(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],g)}let c=d(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const g=d(t,["adapterSize"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],g)}else if(c==="PREFERENCE_TUNING"){const g=d(t,["adapterSize"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],g)}if(d(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const p=d(t,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const m=d(t,["beta"]);return e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],m),r}function B5(t,e){const n={},r=d(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=d(t,["preTunedModel"]);i!=null&&f(n,["preTunedModel"],i);const o=d(t,["trainingDataset"]);o!=null&&Y5(o);const s=d(t,["config"]);return s!=null&&F5(s,n),n}function U5(t,e){const n={},r=d(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=d(t,["preTunedModel"]);i!=null&&f(n,["preTunedModel"],i);const o=d(t,["trainingDataset"]);o!=null&&X5(o,n,e);const s=d(t,["config"]);return s!=null&&V5(s,n,e),n}function z5(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function H5(t,e){const n={},r=d(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function $5(t,e,n){const r={},i=d(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const o=d(t,["pageToken"]);e!==void 0&&o!=null&&f(e,["_query","pageToken"],o);const s=d(t,["filter"]);return e!==void 0&&s!=null&&f(e,["_query","filter"],s),r}function G5(t,e,n){const r={},i=d(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const o=d(t,["pageToken"]);e!==void 0&&o!=null&&f(e,["_query","pageToken"],o);const s=d(t,["filter"]);return e!==void 0&&s!=null&&f(e,["_query","filter"],s),r}function q5(t,e){const n={},r=d(t,["config"]);return r!=null&&$5(r,n),n}function W5(t,e){const n={},r=d(t,["config"]);return r!=null&&G5(r,n),n}function j5(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const o=d(t,["tunedModels"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>rC(l))),f(n,["tuningJobs"],s)}return n}function J5(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const o=d(t,["tuningJobs"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>_f(l))),f(n,["tuningJobs"],s)}return n}function K5(t,e){const n={},r=d(t,["name"]);r!=null&&f(n,["model"],r);const i=d(t,["name"]);return i!=null&&f(n,["endpoint"],i),n}function Y5(t,e){const n={};if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=d(t,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),f(n,["examples","examples"],i)}return n}function X5(t,e,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const s=d(t,["gcsUri"]);e!==void 0&&s!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(i==="PREFERENCE_TUNING"){const s=d(t,["gcsUri"]);e!==void 0&&s!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}let o=d(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const s=d(t,["vertexDatasetResource"]);e!==void 0&&s!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(o==="PREFERENCE_TUNING"){const s=d(t,["vertexDatasetResource"]);e!==void 0&&s!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}if(d(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function rC(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&f(n,["name"],i);const o=d(t,["state"]);o!=null&&f(n,["state"],FS(o));const s=d(t,["createTime"]);s!=null&&f(n,["createTime"],s);const l=d(t,["tuningTask","startTime"]);l!=null&&f(n,["startTime"],l);const a=d(t,["tuningTask","completeTime"]);a!=null&&f(n,["endTime"],a);const u=d(t,["updateTime"]);u!=null&&f(n,["updateTime"],u);const c=d(t,["description"]);c!=null&&f(n,["description"],c);const p=d(t,["baseModel"]);p!=null&&f(n,["baseModel"],p);const m=d(t,["_self"]);return m!=null&&f(n,["tunedModel"],K5(m)),n}function _f(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&f(n,["name"],i);const o=d(t,["state"]);o!=null&&f(n,["state"],FS(o));const s=d(t,["createTime"]);s!=null&&f(n,["createTime"],s);const l=d(t,["startTime"]);l!=null&&f(n,["startTime"],l);const a=d(t,["endTime"]);a!=null&&f(n,["endTime"],a);const u=d(t,["updateTime"]);u!=null&&f(n,["updateTime"],u);const c=d(t,["error"]);c!=null&&f(n,["error"],c);const p=d(t,["description"]);p!=null&&f(n,["description"],p);const m=d(t,["baseModel"]);m!=null&&f(n,["baseModel"],m);const g=d(t,["tunedModel"]);g!=null&&f(n,["tunedModel"],g);const y=d(t,["preTunedModel"]);y!=null&&f(n,["preTunedModel"],y);const v=d(t,["supervisedTuningSpec"]);v!=null&&f(n,["supervisedTuningSpec"],v);const w=d(t,["preferenceOptimizationSpec"]);w!=null&&f(n,["preferenceOptimizationSpec"],w);const x=d(t,["tuningDataStats"]);x!=null&&f(n,["tuningDataStats"],x);const E=d(t,["encryptionSpec"]);E!=null&&f(n,["encryptionSpec"],E);const C=d(t,["partnerModelTuningSpec"]);C!=null&&f(n,["partnerModelTuningSpec"],C);const S=d(t,["customBaseModel"]);S!=null&&f(n,["customBaseModel"],S);const N=d(t,["experiment"]);N!=null&&f(n,["experiment"],N);const T=d(t,["labels"]);T!=null&&f(n,["labels"],T);const k=d(t,["outputUri"]);k!=null&&f(n,["outputUri"],k);const I=d(t,["pipelineJob"]);I!=null&&f(n,["pipelineJob"],I);const R=d(t,["serviceAccount"]);R!=null&&f(n,["serviceAccount"],R);const M=d(t,["tunedModelDisplayName"]);M!=null&&f(n,["tunedModelDisplayName"],M);const q=d(t,["veoTuningSpec"]);return q!=null&&f(n,["veoTuningSpec"],q),n}function Q5(t,e){const n={},r=d(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=d(t,["name"]);i!=null&&f(n,["name"],i);const o=d(t,["metadata"]);o!=null&&f(n,["metadata"],o);const s=d(t,["done"]);s!=null&&f(n,["done"],s);const l=d(t,["error"]);return l!=null&&f(n,["error"],l),n}function W0(t,e){const n={},r=d(t,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const i=d(t,["vertexDatasetResource"]);return i!=null&&f(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Z5 extends lr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Fi(or.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},n),{preTunedModel:i});return o.baseModel=void 0,await this.tuneInternal(o)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),o=await this.tuneMldevInternal(i);let s="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?s=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(s=o.name.split("/operations/")[0]),{name:s,state:Tf.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=H5(e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>_f(c))}else{const u=z5(e);return l=G("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>rC(c))}}async listInternal(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=W5(e);return l=G("tuningJobs",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=J5(c),m=new N0;return Object.assign(m,p),m})}else{const u=q5(e);return l=G("tunedModels",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=j5(c),m=new N0;return Object.assign(m,p),m})}}async cancel(e){var n,r,i,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=P5(e);return l=G("{name}:cancel",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=O5(c),m=new k0;return Object.assign(m,p),m})}else{const u=D5(e);return l=G("{name}:cancel",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),s.then(c=>{const p=L5(c),m=new k0;return Object.assign(m,p),m})}}async tuneInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=U5(e,e);return o=G("tuningJobs",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:a.headers},c})),i.then(a=>_f(a))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=B5(e);return o=G("tunedModels",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(a=>a.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:a.headers},c})),i.then(a=>Q5(a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class e3{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const t3=1024*1024*8,n3=3,r3=1e3,i3=2,du="x-goog-upload-status";async function o3(t,e,n){var r;const i=await iC(t,e,n),o=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[du])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function s3(t,e,n){var r;const i=await iC(t,e,n),o=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[du])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const s=_S(o),l=new wh;return Object.assign(l,s),l}async function iC(t,e,n){var r,i;let o=0,s=0,l=new Nf(new Response),a="upload";for(o=t.size;s<o;){const u=Math.min(t3,o-s),c=t.slice(s,s+u);s+u>=o&&(a+=", finalize");let p=0,m=r3;for(;p<n3&&(l=await n.request({path:"",body:c,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":a,"X-Goog-Upload-Offset":String(s),"Content-Length":String(u)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[du]));)p++,await a3(m),m=m*i3;if(s+=u,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[du])!=="active")break;if(o<=s)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return l}async function l3(t){return{size:t.size,type:t.type}}function a3(t){return new Promise(e=>setTimeout(e,t))}class u3{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await o3(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await s3(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await l3(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class c3{create(e,n,r){return new d3(e,n,r)}}class d3{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const j0="x-goog-api-key";class f3{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(j0)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(j0,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p3="gl-node/";class oC{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=$P(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new f3(this.apiKey);this.apiClient=new HF({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:p3+"web",uploader:new u3,downloader:new e3}),this.models=new l5(this.apiClient),this.live=new t5(this.apiClient,i,new c3),this.batches=new vL(this.apiClient),this.chats=new ZL(this.models,this.apiClient),this.caches=new YL(this.apiClient),this.files=new uO(this.apiClient),this.operations=new a5(this.apiClient),this.authTokens=new T5(this.apiClient),this.tunings=new Z5(this.apiClient),this.fileSearchStores=new R5(this.apiClient)}}const h3=t=>{let e="";return t.includes(D.DOC_WRITER)&&(e+=`
[TOOL: DOCUMENT WRITER ENABLED]
        - You have the capability to draft, write, and format documents. 
        - If the user asks for a report, letter, or file, structure your output clearly with headers, bullet points, and professional formatting. 
        - Explicitly state when you are generating a "Draft Document".
`),t.includes(D.DOC_READER)&&(e+=`
[TOOL: DOCUMENT READER ENABLED]
        - You are optimized to analyze attached documents in depth. 
        - Quote specific sections when answering.
`),t.includes(D.DATA_ANALYSIS)&&(e+=`
[TOOL: DATA ANALYSIS ENABLED]
        - Focus on numbers, trends, and statistics in the provided context.
        - Present data in markdown tables where possible.
`),t.includes(D.EMAIL_SENDER)&&(e+=`
[TOOL: EMAIL SENDER ENABLED]
        - You can draft and simulate sending emails.
        - When asked to send an email, strictly format your response as:
          "To: [Recipient]
Subject: [Subject]

[Body]"
        - Confirm when the email is "Sent" (simulated).
`),t.includes(D.NOTIFICATION)&&(e+=`
[TOOL: NOTIFICATION SYSTEM ENABLED]
        - You can trigger system alerts.
        - Use the format "[NOTIFICATION] <Alert Message>" to trigger an alert.
`),e},m3=(t,e)=>{const r=e.filter(o=>t.allowedAssetIds.includes(o.id)).map(o=>`- [${o.type}] ${o.name} (${o.details})`).join(`
`),i=h3(t.tools||[]);return`${t.systemInstructions}
  
  ${i}
  
  You have access to the following specific knowledge base assets (ignore any previous instructions about other assets):
  ${r||"No documents available for this specific query scope."}
  
  When answering:
  1. Adhere strictly to your persona: ${t.role}.
  2. Use ONLY the provided sources.
  3. If the source is an integration (like Outlook or YouTube), mention that you retrieved it from that specific external app.
  `},g3=async(t,e,n)=>{try{return"Error: API Key is missing. Please check your configuration."}catch(r){return console.error("Gemini API Error:",r),"I encountered an error while processing your request. Please try again."}},y3=async(t,e)=>{try{return"Error: API Key missing"}catch(n){return console.error("AI Error:",n),"Failed to analyze document."}},v3=()=>{const[t,e]=_.useState(!1);return{askAI:async(r,i)=>{e(!0);try{return await y3(r,i)}catch(o){return console.error(o),"Sorry, I couldn't process that request."}finally{e(!1)}},isAnalyzing:t}},x3=({comments:t,onAddComment:e,onResolveComment:n,onClose:r})=>{const[i,o]=_.useState(""),s=l=>{l.preventDefault(),i.trim()&&(e(i),o(""))};return h.jsxs("div",{className:"w-80 h-full bg-white border-l border-slate-200 flex flex-col shadow-xl z-20",children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-100",children:[h.jsx("h3",{className:"font-semibold text-slate-800",children:"Comments"}),h.jsx("button",{onClick:r,className:"text-slate-400 hover:text-slate-600",children:h.jsx(Pp,{size:20})})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t.length===0&&h.jsx("div",{className:"text-center text-slate-400 mt-10",children:h.jsx("p",{className:"text-sm",children:"No comments yet."})}),t.map(l=>h.jsxs("div",{className:`p-3 rounded-xl border ${l.isResolved?"bg-slate-50 border-slate-100 opacity-75":"bg-white border-slate-200 shadow-sm"}`,children:[h.jsxs("div",{className:"flex items-start justify-between mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-bold",children:l.authorName.charAt(0)}),h.jsx("span",{className:"text-xs font-medium text-slate-700",children:l.authorName})]}),h.jsx("span",{className:"text-[10px] text-slate-400",children:new Date(l.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),h.jsx("p",{className:`text-sm text-slate-800 ${l.isResolved?"line-through text-slate-500":""}`,children:l.content}),h.jsx("div",{className:"flex justify-end mt-2",children:h.jsxs("button",{onClick:()=>n(l.id),className:`text-xs flex items-center gap-1 ${l.isResolved?"text-green-600":"text-slate-400 hover:text-green-600"}`,children:[l.isResolved?h.jsx(bp,{size:14}):h.jsx(iN,{size:14}),l.isResolved?"Resolved":"Resolve"]})})]},l.id))]}),h.jsx("form",{onSubmit:s,className:"p-4 border-t border-slate-100 bg-slate-50",children:h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"text",value:i,onChange:l=>o(l.target.value),placeholder:"Add a comment...",className:"w-full pl-4 pr-10 py-2 rounded-lg border border-slate-200 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none text-sm"}),h.jsx("button",{type:"submit",disabled:!i.trim(),className:"absolute right-2 top-1/2 -translate-y-1/2 text-indigo-600 hover:text-indigo-700 disabled:opacity-50",children:h.jsx(g1,{size:16})})]})})]})},w3=_.forwardRef((t,e)=>{const[n,r]=_.useState(0),i=o=>{const s=t.items[o];s&&t.command(s)};return _.useEffect(()=>r(0),[t.items]),_.useImperativeHandle(e,()=>({onKeyDown:({event:o})=>o.key==="ArrowUp"?(r((n+t.items.length-1)%t.items.length),!0):o.key==="ArrowDown"?(r((n+1)%t.items.length),!0):o.key==="Enter"?(i(n),!0):!1})),h.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-slate-200 overflow-hidden min-w-[280px] p-1 animate-in fade-in zoom-in-95 duration-100 flex flex-col gap-1",children:[h.jsx("div",{className:"px-2 py-1.5 text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Basic blocks"}),t.items.map((o,s)=>h.jsxs("button",{onClick:()=>i(s),className:`flex items-center gap-3 px-2 py-2 w-full text-left rounded-lg transition-colors ${s===n?"bg-slate-100 text-slate-900":"text-slate-600 hover:bg-slate-50"}`,children:[h.jsx("div",{className:`w-10 h-10 rounded border border-slate-200 flex items-center justify-center bg-white ${s===n?"border-slate-300 shadow-sm":""}`,children:o.icon}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-sm",children:o.title}),h.jsx("span",{className:"text-xs text-slate-400",children:o.description})]})]},s))]})});function S3(t){var e;const{char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:l}=t,a=r&&!i,u=P_(n),c=new RegExp(`\\s${u}$`),p=s?"^":"",m=i?"":u,g=a?new RegExp(`${p}${u}.*?(?=\\s${m}|$)`,"gm"):new RegExp(`${p}(?:^)?${u}[^\\s${m}]*`,"gm"),y=((e=l.nodeBefore)===null||e===void 0?void 0:e.isText)&&l.nodeBefore.text;if(!y)return null;const v=l.pos-y.length,w=Array.from(y.matchAll(g)).pop();if(!w||w.input===void 0||w.index===void 0)return null;const x=w.input.slice(Math.max(0,w.index-1),w.index),E=new RegExp(`^[${o==null?void 0:o.join("")}\0]?$`).test(x);if(o!==null&&!E)return null;const C=v+w.index;let S=C+w[0].length;return a&&c.test(y.slice(S-1,S+1))&&(w[0]+=" ",S+=1),C<l.pos&&S>=l.pos?{range:{from:C,to:S},query:w[0].slice(n.length),text:w[0]}:null}const C3=new Lt("suggestion");function E3({pluginKey:t=C3,editor:e,char:n="@",allowSpaces:r=!1,allowToIncludeChar:i=!1,allowedPrefixes:o=[" "],startOfLine:s=!1,decorationTag:l="span",decorationClass:a="suggestion",decorationContent:u="",decorationEmptyClass:c="is-empty",command:p=()=>null,items:m=()=>[],render:g=()=>({}),allow:y=()=>!0,findSuggestionMatch:v=S3}){let w;const x=g==null?void 0:g(),E=new Qe({key:t,view(){return{update:async(C,S)=>{var N,T,k,I,R,M,q;const $=(N=this.key)===null||N===void 0?void 0:N.getState(S),F=(T=this.key)===null||T===void 0?void 0:T.getState(C.state),z=$.active&&F.active&&$.range.from!==F.range.from,ie=!$.active&&F.active,Y=$.active&&!F.active,se=!ie&&!Y&&$.query!==F.query,L=ie||z&&se,X=se||z,Z=Y||z&&se;if(!L&&!X&&!Z)return;const oe=Z&&!L?$:F,te=C.dom.querySelector(`[data-decoration-id="${oe.decorationId}"]`);w={editor:e,range:oe.range,query:oe.query,text:oe.text,items:[],command:he=>p({editor:e,range:oe.range,props:he}),decorationNode:te,clientRect:te?()=>{var he;const{decorationId:ce}=(he=this.key)===null||he===void 0?void 0:he.getState(e.state),be=C.dom.querySelector(`[data-decoration-id="${ce}"]`);return(be==null?void 0:be.getBoundingClientRect())||null}:null},L&&((k=x==null?void 0:x.onBeforeStart)===null||k===void 0||k.call(x,w)),X&&((I=x==null?void 0:x.onBeforeUpdate)===null||I===void 0||I.call(x,w)),(X||L)&&(w.items=await m({editor:e,query:oe.query})),Z&&((R=x==null?void 0:x.onExit)===null||R===void 0||R.call(x,w)),X&&((M=x==null?void 0:x.onUpdate)===null||M===void 0||M.call(x,w)),L&&((q=x==null?void 0:x.onStart)===null||q===void 0||q.call(x,w))},destroy:()=>{var C;w&&((C=x==null?void 0:x.onExit)===null||C===void 0||C.call(x,w))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(C,S,N,T){const{isEditable:k}=e,{composing:I}=e.view,{selection:R}=C,{empty:M,from:q}=R,$={...S};if($.composing=I,k&&(M||e.view.composing)){(q<S.range.from||q>S.range.to)&&!I&&!S.composing&&($.active=!1);const F=v({char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:R.$from}),z=`id_${Math.floor(Math.random()*4294967295)}`;F&&y({editor:e,state:T,range:F.range,isActive:S.active})?($.active=!0,$.decorationId=S.decorationId?S.decorationId:z,$.range=F.range,$.query=F.query,$.text=F.text):$.active=!1}else $.active=!1;return $.active||($.decorationId=null,$.range={from:0,to:0},$.query=null,$.text=null),$}},props:{handleKeyDown(C,S){var N;const{active:T,range:k}=E.getState(C.state);return T&&((N=x==null?void 0:x.onKeyDown)===null||N===void 0?void 0:N.call(x,{view:C,event:S,range:k}))||!1},decorations(C){const{active:S,range:N,decorationId:T,query:k}=E.getState(C);if(!S)return null;const I=!(k!=null&&k.length),R=[a];return I&&R.push(c),Ve.create(C.doc,[At.inline(N.from,N.to,{nodeName:l,class:R.join(" "),"data-decoration-id":T,"data-decoration-content":u})])}}});return E}const T3=Ge.create({name:"slashCommand",addOptions(){return{suggestion:{char:"/",command:({editor:t,range:e,props:n})=>{n.command({editor:t,range:e})}},render:()=>{},items:()=>[]}},addProseMirrorPlugins(){return[E3({editor:this.editor,...this.options.suggestion})]}}),N3=({note:t,onSave:e,onBack:n,readOnly:r=!1})=>{const[i,o]=Se.useState((t==null?void 0:t.title)||"Untitled"),[s,l]=Se.useState(t==null?void 0:t.coverImage),[a,u]=Se.useState(t==null?void 0:t.icon),{askAI:c}=v3(),[p,m]=Se.useState(!1),[g,y]=Se.useState((t==null?void 0:t.comments)||[]);T3.configure({suggestion:{items:({query:E})=>[{title:"Heading 1",description:"Big section heading",icon:h.jsx(Bm,{size:18}),command:({editor:C,range:S})=>{C.chain().focus().deleteRange(S).setNode("heading",{level:1}).run()}},{title:"Heading 2",description:"Medium section heading",icon:h.jsx(Um,{size:18}),command:({editor:C,range:S})=>{C.chain().focus().deleteRange(S).setNode("heading",{level:2}).run()}},{title:"Bullet List",description:"Create a simple bullet list",icon:h.jsx(qa,{size:18}),command:({editor:C,range:S})=>{C.chain().focus().deleteRange(S).toggleBulletList().run()}},{title:"AI Assist",description:"Generate or improve content",icon:h.jsx(Yd,{size:18}),command:async({editor:C,range:S})=>{const N=window.prompt("What should AI write?");if(N){const T=await c("",N);C.chain().focus().deleteRange(S).insertContent(T).run()}}}].filter(C=>C.title.toLowerCase().startsWith(E.toLowerCase())),render:()=>{let E,C;return{onStart:S=>{E=new FD(w3,{props:S,editor:S.editor}),S.clientRect&&(C=Oi("body",{getReferenceClientRect:S.clientRect,appendTo:()=>document.body,content:E.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(S){E.updateProps(S),S.clientRect&&C[0].setProps({getReferenceClientRect:S.clientRect})},onKeyDown(S){var N;return S.event.key==="Escape"?(C[0].hide(),!0):(N=E.ref)==null?void 0:N.onKeyDown(S)},onExit(){C[0].destroy(),E.destroy()}}}}});const v=MD({extensions:[FP,VP.configure({placeholder:"Type '/' for commands"}),BP],content:(t==null?void 0:t.content)||"",editable:!r,editorProps:{attributes:{class:"prose prose-lg max-w-none focus:outline-none"}}});_.useEffect(()=>{const E=setTimeout(()=>{v&&(i!==(t==null?void 0:t.title)||v.getHTML()!==(t==null?void 0:t.content))&&e(v.getHTML(),i)},1e3);return()=>clearTimeout(E)},[i,v==null?void 0:v.getHTML()]),_.useEffect(()=>{v&&t&&(t.title!==i&&o(t.title),v.getHTML()!==t.content&&v.commands.setContent(t.content))},[t==null?void 0:t.id,v]);const w=E=>{const C={id:Date.now().toString(),authorName:"You",content:E,createdAt:new Date().toISOString(),isResolved:!1};y([...g,C])},x=E=>{y(g.map(C=>C.id===E?{...C,isResolved:!C.isResolved}:C))};return v?h.jsxs(Pi,{children:[h.jsxs(Cn,{className:"flex flex-col h-[calc(100vh-4rem)] p-0",noPadding:!0,children:[h.jsxs("div",{className:"h-16 flex items-center justify-between px-8 md:px-12 border-b border-white/40 bg-white/30 shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-500 cursor-pointer hover:text-primary-600 transition-colors",onClick:n,children:[h.jsx("span",{className:"opacity-50 hover:underline",children:"Notes"})," ",h.jsx("span",{className:"opacity-30",children:"/"})," ",h.jsx("span",{className:"text-primary-600",children:i})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{className:"text-xs font-bold text-slate-300 uppercase tracking-wider mr-3",children:"Saved"}),h.jsxs("button",{onClick:()=>m(!p),className:"p-2 hover:bg-white/50 rounded-full text-slate-400 hover:text-primary-600 transition-colors relative",children:[h.jsx(qN,{size:18}),g.filter(E=>!E.isResolved).length>0&&h.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-400 rounded-full"})]}),h.jsx("button",{className:"p-2 hover:bg-white/50 rounded-full text-slate-400 hover:text-slate-600 transition-colors",children:h.jsx(dk,{size:18})}),h.jsx("button",{className:"p-2 hover:bg-white/50 rounded-full text-slate-400 hover:text-slate-600 transition-colors",children:h.jsx(pN,{size:18})})]})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-white/40",children:[h.jsx("div",{className:"px-8 md:px-12 pt-12 pb-4 max-w-4xl mx-auto w-full",children:h.jsx("input",{type:"text",value:i,onChange:E=>o(E.target.value),placeholder:"Untitled",className:"text-4xl md:text-5xl font-bold text-slate-900 border-none outline-none placeholder-slate-200 w-full bg-transparent p-0 tracking-tight"})}),h.jsxs("div",{className:"px-8 md:px-12 pb-24 max-w-4xl mx-auto w-full",children:[v&&h.jsxs(bD,{editor:v,tippyOptions:{duration:100},className:"flex items-center gap-1 p-1 bg-slate-900 text-white rounded-lg shadow-xl",children:[h.jsx("button",{onClick:()=>v.chain().focus().toggleBold().run(),className:`p-1.5 rounded hover:bg-slate-700 ${v.isActive("bold")?"bg-slate-700":""}`,children:h.jsx(GT,{size:14})}),h.jsx("button",{onClick:()=>v.chain().focus().toggleItalic().run(),className:`p-1.5 rounded hover:bg-slate-700 ${v.isActive("italic")?"bg-slate-700":""}`,children:h.jsx(_N,{size:14})}),h.jsx("button",{onClick:()=>v.chain().focus().toggleUnderline().run(),className:`p-1.5 rounded hover:bg-slate-700 ${v.isActive("underline")?"bg-slate-700":""}`,children:h.jsx(mk,{size:14})}),h.jsx("div",{className:"w-px h-4 bg-slate-700 mx-1"}),h.jsxs("button",{className:"p-1.5 rounded hover:bg-purple-600 text-purple-300 hover:text-white flex items-center gap-1",onClick:async()=>{const E=v.state.doc.textBetween(v.state.selection.from,v.state.selection.to);if(E){const C=await c(E,"Improve this text");v.chain().focus().deleteSelection().insertContent(C).run()}},children:[h.jsx(Yd,{size:14}),h.jsx("span",{className:"text-xs font-medium",children:"AI Fix"})]})]}),v&&h.jsxs(_D,{editor:v,tippyOptions:{duration:100},className:"flex items-center gap-1 -ml-8 bg-white border border-slate-200 shadow-lg rounded-md p-1",children:[h.jsx("button",{onClick:()=>v.chain().focus().toggleHeading({level:1}).run(),className:`p-1.5 rounded hover:bg-slate-100 ${v.isActive("heading",{level:1})?"bg-slate-100":""}`,children:h.jsx(Bm,{size:16,className:"text-slate-600"})}),h.jsx("button",{onClick:()=>v.chain().focus().toggleHeading({level:2}).run(),className:`p-1.5 rounded hover:bg-slate-100 ${v.isActive("heading",{level:2})?"bg-slate-100":""}`,children:h.jsx(Um,{size:16,className:"text-slate-600"})}),h.jsx("button",{onClick:()=>v.chain().focus().toggleBulletList().run(),className:`p-1.5 rounded hover:bg-slate-100 ${v.isActive("bulletList")?"bg-slate-100":""}`,children:h.jsx(qa,{size:16,className:"text-slate-600"})})]}),h.jsx(xD,{editor:v})]})]})]}),p&&h.jsx("div",{className:"absolute top-0 right-0 h-full shadow-2xl z-30 animate-in slide-in-from-right duration-300 border-l border-slate-200",children:h.jsx(x3,{comments:g,onAddComment:w,onResolveComment:x,onClose:()=>m(!1)})})]}):null},k3=()=>{const[t,e]=_.useState("dashboard"),[n,r]=_.useState("grid"),[i,o]=_.useState([]),[s,l]=_.useState(null),[a,u]=_.useState("");_.useEffect(()=>{c()},[]);const c=async()=>{const w=await Hl.getAll();o(w)},p=async()=>{const w={id:Date.now().toString(),title:"Untitled Note",content:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await Hl.save(w),l(w),e("editor")},m=w=>{l(w),e("editor")},g=async(w,x,E,C)=>{if(s){const S={...s,content:w,title:x,coverImage:E,icon:C,updatedAt:new Date().toISOString()};await Hl.save(S),l(S),c()}},y=async(w,x)=>{w.stopPropagation(),confirm("Are you sure you want to delete this note?")&&(await Hl.delete(x),c())},v=i.filter(w=>w.title.toLowerCase().includes(a.toLowerCase()));return t==="editor"&&s?h.jsx(N3,{note:s,onSave:g,onBack:()=>{e("dashboard"),l(null),c()}}):h.jsx(Pi,{children:h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"flex justify-between items-end",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-4xl font-normal text-slate-900 tracking-tight mb-2",children:"Notes"}),h.jsx("p",{className:"text-slate-500 text-lg",children:"Capture ideas and organize your thoughts."})]}),h.jsxs("button",{onClick:p,className:"bg-primary-200 text-primary-900 px-6 py-4 rounded-[16px] hover:bg-primary-300 transition-all flex items-center gap-3 shadow-sm hover:shadow-md font-medium",children:[h.jsx(nr,{size:24}),h.jsx("span",{className:"text-base",children:"New Note"})]})]}),h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white/60 backdrop-blur-xl p-2 rounded-[24px] border border-white/60 shadow-[0_8px_30px_rgb(0,0,0,0.04)]",children:[h.jsx("div",{className:"flex items-center gap-3 flex-1 w-full pl-2",children:h.jsxs("div",{className:"relative flex-1",children:[h.jsx(Hr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 w-4 h-4"}),h.jsx("input",{type:"text",placeholder:"Search notes...",value:a,onChange:w=>u(w.target.value),className:"w-full pl-9 pr-4 py-2.5 bg-white/50 border border-white/50 rounded-full text-sm focus:ring-2 focus:ring-primary-100 text-slate-700 placeholder:text-slate-400"})]})}),h.jsxs("div",{className:"flex bg-white/50 p-1 rounded-full border border-white/50",children:[h.jsx("button",{onClick:()=>r("grid"),className:`p-2 rounded-full transition-all ${n==="grid"?"bg-white shadow-sm text-primary-600":"text-slate-400 hover:text-slate-600"}`,children:h.jsx(h1,{size:18})}),h.jsx("button",{onClick:()=>r("list"),className:`p-2 rounded-full transition-all ${n==="list"?"bg-white shadow-sm text-primary-600":"text-slate-400 hover:text-slate-600"}`,children:h.jsx(qa,{size:18})})]})]}),h.jsx(Cn,{children:n==="grid"?h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",children:[v.map(w=>h.jsxs("div",{onClick:()=>m(w),className:"group relative bg-white/40 backdrop-blur-xl rounded-[32px] border border-white/60 shadow-sm hover:shadow-[0_20px_40px_rgba(0,0,0,0.05)] hover:bg-white/60 hover:border-white/80 hover:-translate-y-1 transition-all duration-300 cursor-pointer flex flex-col p-6 overflow-hidden h-64",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsx("div",{className:"w-12 h-12 rounded-[16px] bg-amber-100 text-amber-600 flex items-center justify-center",children:h.jsx(tr,{size:24})}),h.jsx("button",{onClick:x=>y(x,w.id),className:"w-8 h-8 rounded-full flex items-center justify-center text-slate-400 hover:bg-red-50 hover:text-red-500 transition-all opacity-0 group-hover:opacity-100",children:h.jsx(ki,{size:16})})]}),h.jsx("h3",{className:"text-xl font-bold text-slate-900 leading-tight mb-2 line-clamp-2 bg-transparent",children:w.title||"Untitled"}),h.jsxs("div",{className:"text-xs text-slate-400 font-medium mb-auto flex items-center gap-1",children:[h.jsx(_p,{size:12})," ",new Date(w.updatedAt).toLocaleDateString()]}),h.jsx("div",{className:"prose prose-sm line-clamp-3 text-slate-500 text-xs pointer-events-none opacity-60",children:h.jsx("span",{dangerouslySetInnerHTML:{__html:w.content}})})]},w.id)),h.jsxs("div",{onClick:p,className:"group relative border-2 border-dashed border-slate-200 rounded-[32px] hover:border-primary-300 hover:bg-primary-50/30 transition-all duration-300 cursor-pointer flex flex-col items-center justify-center p-6 h-64 text-slate-400 hover:text-primary-600",children:[h.jsx(nr,{size:32,className:"mb-2"}),h.jsx("span",{className:"font-bold",children:"Create Note"})]})]}):h.jsx("div",{className:"space-y-3",children:v.map(w=>h.jsxs("div",{onClick:()=>{l(w),e("editor")},className:"flex items-center gap-4 p-4 rounded-xl hover:bg-white/50 border border-transparent hover:border-primary-200 transition-all cursor-pointer group",children:[h.jsx("div",{className:"w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center text-xl shadow-sm",children:w.icon||""}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h3",{className:"font-bold text-slate-800 truncate",children:w.title||"Untitled"}),h.jsx("p",{className:"text-xs text-slate-500 truncate",children:w.content.replace(/<[^>]*>/g,"")||"No additional text"})]}),h.jsx("div",{className:"text-xs text-slate-400 font-medium whitespace-nowrap",children:new Date(w.updatedAt).toLocaleDateString()}),h.jsx("button",{onClick:x=>y(x,w.id),className:"p-2 text-slate-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:h.jsx(ki,{size:16})})]},w.id))})})]})})};at.ADMIN,at.EDITOR,at.VIEWER,at.EDITOR,at.VIEWER,at.ADMIN,at.EDITOR,at.EDITOR,at.VIEWER,at.VIEWER,at.VIEWER,at.ADMIN;const A3=[{id:"1",name:"project_charter_v3.pdf",type:pe.FILE,details:"1.2 MB",dateIndexed:"2023-10-24",status:Ne.INDEXED,isActive:!0},{id:"2",name:"https://docs.stripe.com/api",type:pe.WEBSITE,details:"Crawled 45 pages",dateIndexed:"2023-10-25",status:Ne.INDEXED,isActive:!0},{id:"3",name:"Production_DB_Replica",type:pe.DATABASE,details:"PostgreSQL (Read-Only)",dateIndexed:"2023-10-26",status:Ne.PENDING,isActive:!1},{id:"4",name:"Q3 Town Hall Recording",type:pe.INTEGRATION,details:"YouTube (Video ID: dX839s)",dateIndexed:"2023-10-27",status:Ne.INDEXED,isActive:!0},{id:"5",name:"Marketing_Q4_Plan.docx",type:pe.FILE,details:"4.5 MB",dateIndexed:"2023-10-28",status:Ne.INDEXED,isActive:!0},{id:"6",name:"Employee_Handbook_2024.pdf",type:pe.FILE,details:"2.8 MB",dateIndexed:"2023-10-29",status:Ne.INDEXED,isActive:!0},{id:"7",name:"Competitor_Analysis_Report.pdf",type:pe.FILE,details:"1.5 MB",dateIndexed:"2023-10-30",status:Ne.INDEXED,isActive:!1},{id:"8",name:"https://react.dev",type:pe.WEBSITE,details:"Crawled 120 pages",dateIndexed:"2023-11-01",status:Ne.INDEXED,isActive:!0},{id:"9",name:"Sales_Records_2023",type:pe.DATABASE,details:"MySQL",dateIndexed:"2023-11-02",status:Ne.INDEXED,isActive:!0},{id:"10",name:"Product Demo Video",type:pe.INTEGRATION,details:"YouTube (Video ID: abc123xyz)",dateIndexed:"2023-11-03",status:Ne.INDEXED,isActive:!0},{id:"11",name:"Q4 Financials.xlsx",type:pe.FILE,details:"500 KB",dateIndexed:"2023-11-04",status:Ne.PENDING,isActive:!0},{id:"12",name:"https://tailwindcss.com/docs",type:pe.WEBSITE,details:"Crawled 85 pages",dateIndexed:"2023-11-05",status:Ne.INDEXED,isActive:!0},{id:"13",name:"Legal_Contracts_Archive",type:pe.DATABASE,details:"MongoDB",dateIndexed:"2023-11-06",status:Ne.INDEXED,isActive:!1},{id:"14",name:"CEO Interview 2024",type:pe.INTEGRATION,details:"YouTube (Video ID: interview24)",dateIndexed:"2023-11-07",status:Ne.ERROR,isActive:!1},{id:"15",name:"Design_System_Guidelines.pdf",type:pe.FILE,details:"12 MB",dateIndexed:"2023-11-08",status:Ne.INDEXED,isActive:!0}],I3=[{id:"default",name:"General Assistant",role:"Helpful Assistant",description:"Standard agent with access to all general documents.",systemInstructions:"You are a helpful general assistant. Answer questions based on all available knowledge.",allowedAssetIds:["1","2","3","4","6","8"],tools:[D.RAG_SEARCH],color:"bg-blue-600"},{id:"assignment_agent",name:"Assignment Bot",role:"Workflow Specialist",description:"Reads requirements and writes formal assignment documents.",systemInstructions:"You are an Assignment Specialist. Your workflow is to READ requirements from the knowledge base and WRITE structured assignment documents or reports.",allowedAssetIds:["1","5"],tools:[D.RAG_SEARCH,D.DOC_READER,D.DOC_WRITER],color:"bg-indigo-600"},{id:"hr_bot",name:"HR Onboarding",role:"HR Specialist",description:"Manages onboarding, sends welcome emails, and notifies managers.",systemInstructions:"You are an HR Onboarding Specialist.",allowedAssetIds:["6"],tools:[D.RAG_SEARCH,D.EMAIL_SENDER,D.NOTIFICATION],color:"bg-pink-600"},{id:"tech_support",name:"Tech Support Bot",role:"Technical Expert",description:"Specializes in API docs and database schemas.",systemInstructions:"You are a technical support engineer.",allowedAssetIds:["2","3","8","9","12"],tools:[D.RAG_SEARCH,D.WEB_BROWSER],color:"bg-purple-600"},{id:"legal_advisor",name:"Legal Compliance",role:"Legal Advisor",description:"Reviews contracts and ensures compliance with regulations.",systemInstructions:"You are a Legal Advisor. Review texts for compliance issues.",allowedAssetIds:["13","15"],tools:[D.RAG_SEARCH,D.DOC_READER],color:"bg-slate-700"},{id:"marketing_guru",name:"Marketing Guru",role:"Content Strategist",description:"Generates social media copy and marketing strategies.",systemInstructions:"You are a Creative Content Strategist.",allowedAssetIds:["5","7"],tools:[D.RAG_SEARCH,D.DOC_WRITER],color:"bg-orange-600"},{id:"data_analyst",name:"Data Analyst",role:"Data Scientist",description:"Analyzes datasets and provides insights.",systemInstructions:"You are a Data Analyst.",allowedAssetIds:["9","11"],tools:[D.DATA_ANALYSIS,D.RAG_SEARCH],color:"bg-teal-600"},{id:"code_reviewer",name:"Code Reviewer",role:"Senior Engineer",description:"Reviews code for bugs, style, and security vulnerabilities.",systemInstructions:"You are a Senior Software Engineer conducting code reviews.",allowedAssetIds:["2","8","12"],tools:[D.RAG_SEARCH],color:"bg-zinc-800"},{id:"travel_planner",name:"Travel Planner",role:"Concierge",description:"Plans itineraries and books flights/hotels.",systemInstructions:"You are a Travel Concierge.",allowedAssetIds:[],tools:[D.WEB_BROWSER,D.EMAIL_SENDER],color:"bg-sky-500"},{id:"research_assistant",name:"Research Aide",role:"Academic Researcher",description:"Finds papers, summarizes findings, and drafts abstracts.",systemInstructions:"You are an Academic Research Assistant.",allowedAssetIds:["1","6","7","15"],tools:[D.RAG_SEARCH,D.WEB_BROWSER,D.DOC_WRITER],color:"bg-amber-600"},{id:"sales_rep",name:"Sales Rep",role:"Account Executive",description:"Drafts outreach emails and prepares sales decks.",systemInstructions:"You are an Aggressive Sales Representative.",allowedAssetIds:["5","9"],tools:[D.EMAIL_SENDER,D.RAG_SEARCH],color:"bg-green-600"},{id:"security_audit",name:"SecOps Bot",role:"Security Engineer",description:"Analyzes logs and config files for vulnerabilities.",systemInstructions:"You are a Security Operations Engineer.",allowedAssetIds:["3","9","12"],tools:[D.RAG_SEARCH,D.NOTIFICATION],color:"bg-red-700"},{id:"customer_support",name:"Support Agent",role:"Customer Service",description:"Answers customer tickets and resolves issues.",systemInstructions:"You are a friendly Customer Support Agent.",allowedAssetIds:["6","2"],tools:[D.RAG_SEARCH,D.EMAIL_SENDER],color:"bg-blue-500"},{id:"product_manager",name:"Product PM",role:"Product Manager",description:"Writes PRDs and manages backlog prioritization.",systemInstructions:"You are a Senior Product Manager.",allowedAssetIds:["1","5","8"],tools:[D.DOC_WRITER,D.RAG_SEARCH],color:"bg-indigo-500"},{id:"translator_bot",name:"Polyglot",role:"Translator",description:"Translates documents between languages.",systemInstructions:"You are a professional Translator.",allowedAssetIds:[],tools:[D.DOC_READER,D.DOC_WRITER],color:"bg-violet-600"},{id:"financial_advisor",name:"Finance Bot",role:"Financial Analyst",description:"Reviews spreadsheets and financial reports.",systemInstructions:"You are a Certified Financial Analyst.",allowedAssetIds:["11"],tools:[D.DATA_ANALYSIS,D.DOC_READER],color:"bg-emerald-700"},{id:"social_media",name:"Social Bot",role:"SMM Manager",description:"Drafts tweets, LinkedIn posts, and schedules content.",systemInstructions:"You are a Social Media Manager.",allowedAssetIds:["5","10"],tools:[D.RAG_SEARCH,D.WEB_BROWSER],color:"bg-pink-500"},{id:"executive_coach",name:"Exec Coach",role:"Leadership Coach",description:"Provides advice on leadership and management.",systemInstructions:"You are an Executive Leadership Coach.",allowedAssetIds:["6"],tools:[D.RAG_SEARCH],color:"bg-cyan-600"},{id:"qa_tester",name:"QA Bot",role:"QA Engineer",description:"Generates test cases and bug reports.",systemInstructions:"You are a Quality Assurance Engineer.",allowedAssetIds:["1","2","8"],tools:[D.RAG_SEARCH,D.NOTIFICATION],color:"bg-lime-600"},{id:"event_planner",name:"Event Bot",role:"Coordinator",description:"Coordinates schedules and logistics.",systemInstructions:"You are an Event Coordinator.",allowedAssetIds:["4"],tools:[D.EMAIL_SENDER,D.GOOGLE_DRIVE],color:"bg-fuchsia-600"},{id:"compliance_officer",name:"Compliance Bot",role:"Officer",description:"Checks for regulatory adherence.",systemInstructions:"You are a Compliance Officer.",allowedAssetIds:["13","6"],tools:[D.DOC_READER,D.NOTIFICATION],color:"bg-slate-600"},{id:"recruiter_bot",name:"Recruiter",role:"Talent Acquisition",description:"Screens resumes and schedules interviews.",systemInstructions:"You are a Technical Recruiter.",allowedAssetIds:["6"],tools:[D.EMAIL_SENDER,D.DOC_READER],color:"bg-rose-500"},{id:"scrum_master",name:"Scrum Master",role:"Agile Coach",description:"Facilitates standups and sprint planning.",systemInstructions:"You are a Scrum Master.",allowedAssetIds:["1"],tools:[D.RAG_SEARCH],color:"bg-blue-800"},{id:"inventory_mgr",name:"Inventory Bot",role:"Logistics Manager",description:"Tracks stock levels and orders.",systemInstructions:"You are an Inventory Manager.",allowedAssetIds:["9"],tools:[D.DATA_ANALYSIS,D.NOTIFICATION],color:"bg-stone-600"}],J0=[{id:"s1",agentId:"default",title:"Project Charter Summary",lastModified:new Date(Date.now()-1e7).toISOString(),messages:[{id:"m1",role:"user",content:"Summarize the project charter.",timestamp:new Date(Date.now()-1e7)},{id:"m2",role:"model",content:"The project charter outlines the scope for the Q3 migration...",timestamp:new Date(Date.now()-9999e3),sources:[{id:"1",title:"project_charter_v3.pdf",type:pe.FILE}]}]},{id:"s2",agentId:"hr_bot",title:"Onboarding Checklist",lastModified:new Date(Date.now()-5e6).toISOString(),messages:[{id:"m3",role:"user",content:"What is the checklist for new hires?",timestamp:new Date(Date.now()-5e6)}]},{id:"s3",agentId:"tech_support",title:"API Authentication",lastModified:new Date(Date.now()-2e6).toISOString(),messages:[{id:"m4",role:"user",content:"How do I authenticate with the Stripe API?",timestamp:new Date(Date.now()-2e6)},{id:"m5",role:"model",content:"You authenticate by passing your secret key in the Authorization header...",timestamp:new Date(Date.now()-19e5),sources:[{id:"2",title:"https://docs.stripe.com/api",type:pe.WEBSITE}]}]},{id:"s4",agentId:"default",title:"Meeting Notes",lastModified:new Date(Date.now()-864e5).toISOString(),messages:[{id:"m6",role:"user",content:"Draft notes for the town hall.",timestamp:new Date(Date.now()-864e5)}]},{id:"s5",agentId:"assignment_agent",title:"Q4 Report Draft",lastModified:new Date(Date.now()-12e5).toISOString(),messages:[{id:"m7",role:"user",content:"Help me write the Q4 marketing analysis.",timestamp:new Date(Date.now()-12e5)}]}],Zl=t=>new Promise(e=>setTimeout(e,t)),td={login:async(t,e)=>(await Zl(800),{id:"u-123",name:t.split("@")[0],email:t,role:at.ADMIN,avatarUrl:void 0,status:"Active",lastActive:"Just now",plan:"Pro",joinedDate:new Date().toLocaleDateString()}),logout:async()=>{await Zl(200)},register:async t=>(await Zl(1e3),{id:`u-${Date.now()}`,name:t.split("@")[0],email:t,role:at.VIEWER,status:"Active",lastActive:"Just now",plan:"Free",joinedDate:new Date().toLocaleDateString()}),updateProfile:async(t,e)=>(await Zl(500),{id:t,name:"Updated User",email:"user@example.com",role:at.ADMIN,status:"Active",lastActive:"Now",...e})},M3=()=>{const[t,e]=_.useState(null),[n,r]=_.useState(!1),[i,o]=_.useState(null),s=_.useCallback(async(u,c)=>{r(!0),o(null);try{const p=await td.login(u,c);return e(p),p}catch(p){throw o("Failed to login. Please try again."),p}finally{r(!1)}},[]),l=_.useCallback(async()=>{await td.logout(),e(null)},[]),a=_.useCallback(async u=>{if(t)try{const c=await td.updateProfile(t.id,u);e(c)}catch{o("Failed to update profile")}},[t]);return{user:t,loading:n,error:i,login:s,logout:l,updateUser:a}},ea=t=>new Promise(e=>setTimeout(e,t));let ti=[...I3];const nd={getAll:async()=>(await ea(400),[...ti]),getById:async t=>(await ea(200),ti.find(e=>e.id===t)),save:async t=>{await ea(600);const e=ti.findIndex(n=>n.id===t.id);return e>=0?ti[e]=t:ti.push(t),t},delete:async t=>{await ea(400),ti=ti.filter(e=>e.id!==t)}},b3=()=>{const[t,e]=_.useState([]),[n,r]=_.useState(!1),[i,o]=_.useState(null),s=_.useCallback(async()=>{r(!0);try{const u=await nd.getAll();e(u)}catch{o("Failed to load agents")}finally{r(!1)}},[]);_.useEffect(()=>{s()},[s]);const l=_.useCallback(async u=>{try{const c=await nd.save(u);return e(p=>p.find(g=>g.id===c.id)?p.map(g=>g.id===c.id?c:g):[...p,c]),c}catch(c){throw o("Failed to save agent"),c}},[]),a=_.useCallback(async u=>{try{await nd.delete(u),e(c=>c.filter(p=>p.id!==u))}catch{o("Failed to delete agent")}},[]);return{agents:t,loading:n,error:i,saveAgent:l,deleteAgent:a,refreshAgents:s}},_3=()=>{const{user:t,login:e,logout:n,updateUser:r}=M3(),{agents:i,saveAgent:o,deleteAgent:s}=b3(),[l,a]=_.useState(Ce.CHAT),[u,c]=_.useState(A3),[p,m]=_.useState(J0),[g,y]=_.useState(J0[0].id),[v,w]=_.useState("agent-1"),[x,E]=_.useState(!1);_.useEffect(()=>{i.length>0&&!i.find(z=>z.id===v)&&w(i[0].id)},[i,v]);const C=p.find(z=>z.id===g)||p[0],S=async z=>{try{await e(z.email,"password"),a(Ce.HOME)}catch(ie){console.error("Login failed",ie)}},N=()=>{n()},T=z=>{const ie={id:Date.now().toString(),name:z.name||"Untitled",type:z.type,details:z.details||"",dateIndexed:new Date().toLocaleDateString(),status:Ne.PENDING,isActive:!0};c(Y=>[ie,...Y]),setTimeout(()=>{c(Y=>Y.map(se=>se.id===ie.id?{...se,status:Ne.INDEXED}:se))},2500)},k=z=>{c(ie=>ie.filter(Y=>Y.id!==z))},I=z=>{c(ie=>ie.map(Y=>Y.id===z?{...Y,isActive:!Y.isActive}:Y))},R=z=>{const ie=p.find(Y=>Y.agentId===z&&Y.messages.length===0);ie?y(ie.id):M(z),w(z),a(Ce.CHAT)},M=(z=v)=>{const ie={id:Date.now().toString(),agentId:z,title:"New Conversation",messages:[],lastModified:new Date().toISOString()};m(Y=>[ie,...Y]),y(ie.id),w(z),a(Ce.CHAT)},q=z=>{const ie=p.find(Y=>Y.id===z);ie&&(y(z),w(ie.agentId),a(Ce.CHAT))},$=z=>{const ie=p.filter(Y=>Y.id!==z);m(ie),g===z&&(ie.length>0?(y(ie[0].id),w(ie[0].agentId)):M(i[0].id))},F=async z=>{const ie={id:Date.now().toString(),role:"user",content:z,timestamp:new Date};m(te=>te.map(he=>he.id===g?{...he,messages:[...he.messages,ie],title:he.messages.length===0?z.slice(0,30)+(z.length>30?"...":""):he.title,lastModified:new Date().toISOString()}:he)),E(!0);const Y=i.find(te=>te.id===v)||i[0],se=u.filter(te=>te.isActive),L=await g3(z,se,Y),Z=se.filter(te=>Y.allowedAssetIds.includes(te.id)).filter(te=>te.status===Ne.INDEXED).sort(()=>.5-Math.random()).slice(0,Math.random()>.5?1:2).map(te=>({id:te.id,title:te.name,type:te.type})),oe={id:(Date.now()+1).toString(),role:"model",content:L,timestamp:new Date,sources:Z.length>0?Z:void 0};m(te=>te.map(he=>he.id===g?{...he,messages:[...he.messages,oe],lastModified:new Date().toISOString()}:he)),E(!1)};return t?h.jsxs("div",{className:"flex h-screen w-screen overflow-hidden bg-slate-25 text-slate-900 font-sans",children:[h.jsx(kk,{activeView:l,onChangeView:a,onLogout:N,user:t,sessions:p,agents:i,activeSessionId:g,onSelectSession:q,onDeleteSession:$}),h.jsxs("main",{className:"flex-1 flex flex-col h-full overflow-hidden relative bg-slate-25 z-0",children:[h.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0",children:[h.jsx("div",{className:"absolute top-[-10%] right-[-5%] w-[600px] h-[600px] bg-primary-100/40 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-pulse"}),h.jsx("div",{className:"absolute bottom-[-10%] left-[-5%] w-[500px] h-[500px] bg-indigo-100/40 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-pulse",style:{animationDelay:"2s"}})]}),h.jsxs("div",{className:"relative z-10 flex-1 flex flex-col h-full overflow-hidden",children:[l===Ce.HOME&&h.jsx(Vk,{user:t,agents:i,assets:u,sessions:p,onNavigate:a,onSelectSession:q,onNewChat:()=>M(i[0].id)}),l===Ce.KNOWLEDGE&&h.jsx(Mk,{assets:u,onAddAsset:T,onRemoveAsset:k,onToggleAssetStatus:I}),l===Ce.NOTES&&h.jsx(k3,{}),l===Ce.SETTINGS&&h.jsx(Rk,{user:t,onUpdateUser:r}),l===Ce.AGENTS&&h.jsx(Fk,{agents:i,assets:u,onSaveAgent:o,onDeleteAgent:s,onChatWithAgent:R}),l===Ce.CHAT&&h.jsx(bk,{messages:(C==null?void 0:C.messages)||[],onSendMessage:F,isThinking:x,agents:i,activeAgentId:v,onAgentChange:z=>M(z),onNewChat:()=>M(v),sessionTitle:C==null?void 0:C.title})]})]})]}):h.jsx(Ak,{onLogin:S})},sC=document.getElementById("root");if(!sC)throw new Error("Could not find root element to mount to");const R3=rd.createRoot(sC);R3.render(h.jsx(Se.StrictMode,{children:h.jsx(_3,{})}));
